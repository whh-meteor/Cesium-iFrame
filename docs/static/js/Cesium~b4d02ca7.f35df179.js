(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Cesium~b4d02ca7"],{"059a":function(t,e,o){"use strict";var i=o("be18"),a=o("bef8"),n=o("2f63"),s=o("7d62"),r=o("55f9"),c=o("93da"),l=o("52f0"),m=o("713f"),u=o("c34a"),d=o("4e1a"),p=o("2ac3"),h=o("1863"),_=o("2f48"),f=o("f806"),g=o("9dbf"),w=o("a307");function T(t){this._scene=t,this._currentTweens=[],this._morphHandler=void 0,this._morphCancelled=!1,this._completeMorph=void 0,this._morphToOrthographic=!1}T.prototype.completeMorph=function(){Object(n["a"])(this._completeMorph)&&this._completeMorph()},T.prototype.morphTo2D=function(t,e){Object(n["a"])(this._completeMorph)&&this._completeMorph();const o=this._scene;this._previousMode=o.mode,this._morphToOrthographic=o.camera.frustum instanceof m["a"],this._previousMode!==w["a"].SCENE2D&&this._previousMode!==w["a"].MORPHING&&(this._scene.morphStart.raiseEvent(this,this._previousMode,w["a"].SCENE2D,!0),o._mode=w["a"].MORPHING,o.camera._setTransform(l["a"].IDENTITY),this._previousMode===w["a"].COLUMBUS_VIEW?pt(this,t):Pt(this,t,e),0===t&&Object(n["a"])(this._completeMorph)&&this._completeMorph())};const y=new i["a"],P=new i["a"],b=new i["a"],E=new i["a"],M=new i["a"],O=new i["a"],R=new i["a"],C=new a["a"],v=new l["a"],x=new d["a"],I=new m["a"],S={position:void 0,direction:void 0,up:void 0,position2D:void 0,direction2D:void 0,up2D:void 0,frustum:void 0};T.prototype.morphToColumbusView=function(t,e){Object(n["a"])(this._completeMorph)&&this._completeMorph();const o=this._scene;if(this._previousMode=o.mode,this._previousMode===w["a"].COLUMBUS_VIEW||this._previousMode===w["a"].MORPHING)return;this._scene.morphStart.raiseEvent(this,this._previousMode,w["a"].COLUMBUS_VIEW,!0),o.camera._setTransform(l["a"].IDENTITY);let a=y;const s=P,r=b;if(t>0)a.x=0,a.y=-1,a.z=1,a=i["a"].multiplyByScalar(i["a"].normalize(a,a),5*e.maximumRadius,a),i["a"].negate(i["a"].normalize(a,s),s),i["a"].cross(i["a"].UNIT_X,s,r);else{const t=o.camera;if(this._previousMode===w["a"].SCENE2D)i["a"].clone(t.position,a),a.z=t.frustum.right-t.frustum.left,i["a"].negate(i["a"].UNIT_Z,s),i["a"].clone(i["a"].UNIT_Y,r);else{i["a"].clone(t.positionWC,a),i["a"].clone(t.directionWC,s),i["a"].clone(t.upWC,r);const n=e.scaleToGeodeticSurface(a,R),c=f["a"].eastNorthUpToFixedFrame(n,e,v);l["a"].inverseTransformation(c,c),o.mapProjection.project(e.cartesianToCartographic(a,C),a),l["a"].multiplyByPointAsVector(c,s,s),l["a"].multiplyByPointAsVector(c,r,r)}}let m;this._morphToOrthographic?(m=I,m.width=o.camera.frustum.right-o.camera.frustum.left,m.aspectRatio=o.drawingBufferWidth/o.drawingBufferHeight):(m=x,m.aspectRatio=o.drawingBufferWidth/o.drawingBufferHeight,m.fov=c["a"].toRadians(60));const u=S;u.position=a,u.direction=s,u.up=r,u.frustum=m;const d=vt(u);z(this,d),this._previousMode===w["a"].SCENE2D?Et(this,t,u,d):(u.position2D=l["a"].multiplyByPoint(g["a"].TRANSFORM_2D,a,E),u.direction2D=l["a"].multiplyByPointAsVector(g["a"].TRANSFORM_2D,s,M),u.up2D=l["a"].multiplyByPointAsVector(g["a"].TRANSFORM_2D,r,O),o._mode=w["a"].MORPHING,Mt(this,t,u,d)),0===t&&Object(n["a"])(this._completeMorph)&&this._completeMorph()};const N={position:new i["a"],direction:new i["a"],up:new i["a"],frustum:void 0},j=new d["a"];function z(t,e){if(t._scene.completeMorphOnUserInput){t._morphHandler=new h["a"](t._scene.canvas);const o=function(){t._morphCancelled=!0,t._scene.camera.cancelFlight(),e(t)};t._completeMorph=o,t._morphHandler.setInputAction(o,_["a"].LEFT_DOWN),t._morphHandler.setInputAction(o,_["a"].MIDDLE_DOWN),t._morphHandler.setInputAction(o,_["a"].RIGHT_DOWN),t._morphHandler.setInputAction(o,_["a"].WHEEL)}}function D(t){const e=t._currentTweens;for(let o=0;o<e.length;++o)e[o].cancelTween();t._currentTweens.length=0,t._morphHandler=t._morphHandler&&t._morphHandler.destroy()}T.prototype.morphTo3D=function(t,e){Object(n["a"])(this._completeMorph)&&this._completeMorph();const o=this._scene;if(this._previousMode=o.mode,this._previousMode!==w["a"].SCENE3D&&this._previousMode!==w["a"].MORPHING){if(this._scene.morphStart.raiseEvent(this,this._previousMode,w["a"].SCENE3D,!0),o._mode=w["a"].MORPHING,o.camera._setTransform(l["a"].IDENTITY),this._previousMode===w["a"].SCENE2D)tt(this,t,e);else{let a,n;t>0?(a=N,i["a"].fromDegrees(0,0,5*e.maximumRadius,e,a.position),i["a"].negate(a.position,a.direction),i["a"].normalize(a.direction,a.direction),i["a"].clone(i["a"].UNIT_Z,a.up)):a=B(this,e);const s=o.camera;s.frustum instanceof m["a"]?n=s.frustum.clone():(n=j,n.aspectRatio=o.drawingBufferWidth/o.drawingBufferHeight,n.fov=c["a"].toRadians(60)),a.frustum=n;const r=Rt(a);z(this,r),G(this,t,a,r)}0===t&&Object(n["a"])(this._completeMorph)&&this._completeMorph()}},T.prototype.isDestroyed=function(){return!1},T.prototype.destroy=function(){return D(this),Object(s["a"])(this)};const U=new a["a"],W=new i["a"],A=new l["a"];function B(t,e){const o=t._scene,i=o.camera,a=N,n=a.position,s=a.direction,r=a.up,c=o.mapProjection.unproject(i.position,U);e.cartographicToCartesian(c,n);const m=e.scaleToGeodeticSurface(n,W),u=f["a"].eastNorthUpToFixedFrame(m,e,A);return l["a"].multiplyByPointAsVector(u,i.direction,s),l["a"].multiplyByPointAsVector(u,i.up,r),a}const F=new i["a"],H=new i["a"],k=new i["a"],V=new i["a"],Z=new i["a"],L=new i["a"];function G(t,e,o,a){e*=.5;const n=t._scene,s=n.camera,c=i["a"].clone(s.position,F),m=i["a"].clone(s.direction,H),u=i["a"].clone(s.up,k),d=l["a"].multiplyByPoint(g["a"].TRANSFORM_2D_INVERSE,o.position,V),p=l["a"].multiplyByPointAsVector(g["a"].TRANSFORM_2D_INVERSE,o.direction,Z),h=l["a"].multiplyByPointAsVector(g["a"].TRANSFORM_2D_INVERSE,o.up,L);function _(t){et(c,d,t.time,s.position),et(m,p,t.time,s.direction),et(u,h,t.time,s.up),i["a"].cross(s.direction,s.up,s.right),i["a"].normalize(s.right,s.right)}const f=n.tweens.add({duration:e,easingFunction:r["a"].QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:_,complete:function(){Ot(t,n,0,1,e,a)}});t._currentTweens.push(f)}const q=new m["a"],Y=new i["a"],Q=new i["a"],X=new i["a"],J=new i["a"],K=new i["a"],$=new i["a"];function tt(t,e,o){e/=3;const a=t._scene,n=a.camera;let s,r;e>0?(s=N,i["a"].fromDegrees(0,0,5*o.maximumRadius,o,s.position),i["a"].negate(s.position,s.direction),i["a"].normalize(s.direction,s.direction),i["a"].clone(i["a"].UNIT_Z,s.up)):(n.position.z=n.frustum.right-n.frustum.left,s=B(t,o)),t._morphToOrthographic?(r=q,r.aspectRatio=a.drawingBufferWidth/a.drawingBufferHeight,r.width=n.frustum.right-n.frustum.left):(r=j,r.aspectRatio=a.drawingBufferWidth/a.drawingBufferHeight,r.fov=c["a"].toRadians(60)),s.frustum=r;const l=Rt(s);let m;z(t,l),m=t._morphToOrthographic?function(){G(t,e,s,l)}:function(){bt(t,e,s,(function(){G(t,e,s,l)}))},e>0?(a._mode=w["a"].SCENE2D,n.flyTo({duration:e,destination:i["a"].fromDegrees(0,0,5*o.maximumRadius,o,J),complete:function(){a._mode=w["a"].MORPHING,m()}})):m()}function et(t,e,o,a){return i["a"].lerp(t,e,o,a)}function ot(t,e,o,i,a){const n=t._scene,s=n.camera;if(s.frustum instanceof m["a"])return;const l=s.frustum.fov,u=.5*c["a"].RADIANS_PER_DEGREE,d=o.position.z*Math.tan(.5*l);function p(t){s.frustum.fov=c["a"].lerp(l,u,t.time);const e=d/Math.tan(.5*s.frustum.fov);i(s,e)}s.frustum.far=d/Math.tan(.5*u)+1e7;const h=n.tweens.add({duration:e,easingFunction:r["a"].QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:p,complete:function(){s.frustum=o.frustum.clone(),a(t)}});t._currentTweens.push(h)}const it=new i["a"],at=new i["a"],nt=new i["a"],st=new i["a"],rt=new i["a"],ct=new i["a"],lt=new u["a"],mt=new p["a"],ut=new i["a"],dt={position:void 0,direction:void 0,up:void 0,frustum:void 0};function pt(t,e){e*=.5;const o=t._scene,a=o.camera,s=i["a"].clone(a.position,it),c=i["a"].clone(a.direction,at),m=i["a"].clone(a.up,nt),u=i["a"].negate(i["a"].UNIT_Z,rt),d=i["a"].clone(i["a"].UNIT_Y,ct),p=st;if(e>0)i["a"].clone(i["a"].ZERO,st),p.z=5*o.mapProjection.ellipsoid.maximumRadius;else{i["a"].clone(s,st);const t=mt;l["a"].multiplyByPoint(g["a"].TRANSFORM_2D,s,t.origin),l["a"].multiplyByPointAsVector(g["a"].TRANSFORM_2D,c,t.direction);const e=o.globe;if(Object(n["a"])(e)){const a=e.pickWorldCoordinates(t,o,!0,ut);Object(n["a"])(a)&&(l["a"].multiplyByPoint(g["a"].TRANSFORM_2D_INVERSE,a,p),p.z+=i["a"].distance(s,p))}}const h=lt;h.right=.5*p.z,h.left=-h.right,h.top=h.right*(o.drawingBufferHeight/o.drawingBufferWidth),h.bottom=-h.top;const _=dt;_.position=p,_.direction=u,_.up=d,_.frustum=h;const f=Ct(_);function w(t){et(s,p,t.time,a.position),et(c,u,t.time,a.direction),et(m,d,t.time,a.up),i["a"].cross(a.direction,a.up,a.right),i["a"].normalize(a.right,a.right),a._adjustOrthographicFrustum(!0)}function T(t,e){t.position.z=e}z(t,f);const y=o.tweens.add({duration:e,easingFunction:r["a"].QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:w,complete:function(){ot(t,e,_,T,f)}});t._currentTweens.push(y)}const ht=new a["a"],_t={position:new i["a"],direction:new i["a"],up:new i["a"],position2D:new i["a"],direction2D:new i["a"],up2D:new i["a"],frustum:new u["a"]},ft={position:new i["a"],direction:new i["a"],up:new i["a"],frustum:void 0},gt=new i["a"],wt=new p["a"],Tt=new l["a"],yt=new i["a"];function Pt(t,e,o){e*=.5;const a=t._scene,s=a.camera,r=_t;if(e>0)i["a"].clone(i["a"].ZERO,r.position),r.position.z=5*o.maximumRadius,i["a"].negate(i["a"].UNIT_Z,r.direction),i["a"].clone(i["a"].UNIT_Y,r.up);else{o.cartesianToCartographic(s.positionWC,ht),a.mapProjection.project(ht,r.position),i["a"].negate(i["a"].UNIT_Z,r.direction),i["a"].clone(i["a"].UNIT_Y,r.up);const t=wt;i["a"].clone(r.position2D,t.origin);const e=i["a"].clone(s.directionWC,t.direction),c=o.scaleToGeodeticSurface(s.positionWC,yt),m=f["a"].eastNorthUpToFixedFrame(c,o,Tt);l["a"].inverseTransformation(m,m),l["a"].multiplyByPointAsVector(m,e,e),l["a"].multiplyByPointAsVector(g["a"].TRANSFORM_2D,e,e);const u=a.globe;if(Object(n["a"])(u)){const e=u.pickWorldCoordinates(t,a,!0,gt);if(Object(n["a"])(e)){const t=i["a"].distance(r.position2D,e);e.x+=t,i["a"].clone(e,r.position2D)}}}function c(t,e){t.position.x=e}l["a"].multiplyByPoint(g["a"].TRANSFORM_2D,r.position,r.position2D),l["a"].multiplyByPointAsVector(g["a"].TRANSFORM_2D,r.direction,r.direction2D),l["a"].multiplyByPointAsVector(g["a"].TRANSFORM_2D,r.up,r.up2D);const m=r.frustum;m.right=.5*r.position.z,m.left=-m.right,m.top=m.right*(a.drawingBufferHeight/a.drawingBufferWidth),m.bottom=-m.top;const u=ft;l["a"].multiplyByPoint(g["a"].TRANSFORM_2D_INVERSE,r.position2D,u.position),i["a"].clone(r.direction,u.direction),i["a"].clone(r.up,u.up),u.frustum=m;const d=Ct(u);function p(){ot(t,e,r,c,d)}z(t,d),Mt(t,e,r,p)}function bt(t,e,o,i){const a=t._scene,n=a.camera,s=n.frustum.right-n.frustum.left;n.frustum=o.frustum.clone();const l=n.frustum.fov,m=.5*c["a"].RADIANS_PER_DEGREE,u=s*Math.tan(.5*l);function d(t){n.frustum.fov=c["a"].lerp(m,l,t.time),n.position.z=u/Math.tan(.5*n.frustum.fov)}n.frustum.far=u/Math.tan(.5*m)+1e7,n.frustum.fov=m;const p=a.tweens.add({duration:e,easingFunction:r["a"].QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:d,complete:function(){i(t)}});t._currentTweens.push(p)}function Et(t,e,o,a){e*=.5;const n=t._scene,s=n.camera,c=i["a"].clone(o.position,J),l=i["a"].clone(o.direction,K),m=i["a"].clone(o.up,$);function u(){s.frustum=o.frustum.clone();const u=i["a"].clone(s.position,Y),d=i["a"].clone(s.direction,Q),p=i["a"].clone(s.up,X);function h(t){et(u,c,t.time,s.position),et(d,l,t.time,s.direction),et(p,m,t.time,s.up),i["a"].cross(s.direction,s.up,s.right),i["a"].normalize(s.right,s.right)}u.z=c.z;const _=n.tweens.add({duration:e,easingFunction:r["a"].QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:h,complete:function(){a(t)}});t._currentTweens.push(_)}n._mode=w["a"].MORPHING,t._morphToOrthographic?u():bt(t,0,o,u)}function Mt(t,e,o,a){const n=t._scene,s=n.camera,c=i["a"].clone(s.position,Y),l=i["a"].clone(s.direction,Q),m=i["a"].clone(s.up,X),u=i["a"].clone(o.position2D,J),d=i["a"].clone(o.direction2D,K),p=i["a"].clone(o.up2D,$);function h(t){et(c,u,t.time,s.position),et(l,d,t.time,s.direction),et(m,p,t.time,s.up),i["a"].cross(s.direction,s.up,s.right),i["a"].normalize(s.right,s.right),s._adjustOrthographicFrustum(!0)}const _=n.tweens.add({duration:e,easingFunction:r["a"].QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:h,complete:function(){Ot(t,n,1,0,e,a)}});t._currentTweens.push(_)}function Ot(t,e,o,i,a,s){const c={object:e,property:"morphTime",startValue:o,stopValue:i,duration:a,easingFunction:r["a"].QUARTIC_OUT};Object(n["a"])(s)&&(c.complete=function(){s(t)});const l=e.tweens.addProperty(c);t._currentTweens.push(l)}function Rt(t){return function(e){const o=e._scene;o._mode=w["a"].SCENE3D,o.morphTime=w["a"].getMorphTime(w["a"].SCENE3D),D(e);const a=o.camera;(e._previousMode!==w["a"].MORPHING||e._morphCancelled)&&(e._morphCancelled=!1,i["a"].clone(t.position,a.position),i["a"].clone(t.direction,a.direction),i["a"].clone(t.up,a.up),i["a"].cross(a.direction,a.up,a.right),i["a"].normalize(a.right,a.right),a.frustum=t.frustum.clone());const s=a.frustum;o.frameState.useLogDepth&&(s.near=.1,s.far=1e10);const r=Object(n["a"])(e._completeMorph);e._completeMorph=void 0,o.camera.update(o.mode),e._scene.morphComplete.raiseEvent(e,e._previousMode,w["a"].SCENE3D,r)}}function Ct(t){return function(e){const o=e._scene;o._mode=w["a"].SCENE2D,o.morphTime=w["a"].getMorphTime(w["a"].SCENE2D),D(e);const a=o.camera;i["a"].clone(t.position,a.position),a.position.z=2*o.mapProjection.ellipsoid.maximumRadius,i["a"].clone(t.direction,a.direction),i["a"].clone(t.up,a.up),i["a"].cross(a.direction,a.up,a.right),i["a"].normalize(a.right,a.right),a.frustum=t.frustum.clone();const s=Object(n["a"])(e._completeMorph);e._completeMorph=void 0,o.camera.update(o.mode),e._scene.morphComplete.raiseEvent(e,e._previousMode,w["a"].SCENE2D,s)}}function vt(t){return function(e){const o=e._scene;o._mode=w["a"].COLUMBUS_VIEW,o.morphTime=w["a"].getMorphTime(w["a"].COLUMBUS_VIEW),D(e);const a=o.camera;(e._previousModeMode!==w["a"].MORPHING||e._morphCancelled)&&(e._morphCancelled=!1,i["a"].clone(t.position,a.position),i["a"].clone(t.direction,a.direction),i["a"].clone(t.up,a.up),i["a"].cross(a.direction,a.up,a.right),i["a"].normalize(a.right,a.right));const s=a.frustum;o.frameState.useLogDepth&&(s.near=.1,s.far=1e10);const r=Object(n["a"])(e._completeMorph);e._completeMorph=void 0,o.camera.update(o.mode),e._scene.morphComplete.raiseEvent(e,e._previousMode,w["a"].COLUMBUS_VIEW,r)}}e["a"]=T},"0c80":function(t,e,o){"use strict";var i=o("77af"),a=o("670c"),n=o("be18"),s=o("a561"),r=o("bef8"),c=o("2f63"),l=o("93da"),m=o("52f0"),u=o("713f"),d=o("c34a"),p=o("f806"),h=o("a307");const _={},f=new s["a"](0,0,0,1);let g=new s["a"];const w=new i["a"],T=new a["a"],y=new a["a"];_.wgs84ToWindowCoordinates=function(t,e,o){return _.wgs84WithEyeOffsetToWindowCoordinates(t,e,n["a"].ZERO,o)};const P=new s["a"],b=new n["a"];function E(t,e,o,i){const a=o.viewMatrix,r=m["a"].multiplyByVector(a,s["a"].fromElements(t.x,t.y,t.z,1,P),P),c=n["a"].multiplyComponents(e,n["a"].normalize(r,b),b);return r.x+=e.x+c.x,r.y+=e.y+c.y,r.z+=c.z,m["a"].multiplyByVector(o.frustum.projectionMatrix,r,i)}const M=new r["a"](Math.PI,l["a"].PI_OVER_TWO),O=new n["a"],R=new n["a"];_.wgs84WithEyeOffsetToWindowCoordinates=function(t,e,o,i){const s=t.frameState,r=_.computeActualWgs84Position(s,e,f);if(!Object(c["a"])(r))return;const P=t.canvas,b=w;b.x=0,b.y=0,b.width=P.clientWidth,b.height=P.clientHeight;const C=t.camera;let v=!1;if(s.mode===h["a"].SCENE2D){const e=t.mapProjection,s=M,c=e.project(s,O),u=n["a"].clone(C.position,R),d=C.frustum.clone(),h=m["a"].computeViewportTransformation(b,0,1,new m["a"]),f=C.frustum.projectionMatrix,w=C.positionWC.y,x=n["a"].fromElements(l["a"].sign(w)*c.x-w,0,-C.positionWC.x),I=p["a"].pointToGLWindowCoordinates(f,h,x);if(0===w||I.x<=0||I.x>=P.clientWidth)v=!0;else{if(I.x>.5*P.clientWidth){b.width=I.x,C.frustum.right=c.x-w,g=E(r,o,C,g),_.clipToGLWindowCoordinates(b,g,T),b.x+=I.x,C.position.x=-C.position.x;const t=C.frustum.right;C.frustum.right=-C.frustum.left,C.frustum.left=-t,g=E(r,o,C,g),_.clipToGLWindowCoordinates(b,g,y)}else{b.x+=I.x,b.width-=I.x,C.frustum.left=-c.x-w,g=E(r,o,C,g),_.clipToGLWindowCoordinates(b,g,T),b.x=b.x-b.width,C.position.x=-C.position.x;const t=C.frustum.left;C.frustum.left=-C.frustum.right,C.frustum.right=-t,g=E(r,o,C,g),_.clipToGLWindowCoordinates(b,g,y)}n["a"].clone(u,C.position),C.frustum=d.clone(),i=a["a"].clone(T,i),(i.x<0||i.x>P.clientWidth)&&(i.x=y.x)}}if(s.mode!==h["a"].SCENE2D||v){if(g=E(r,o,C,g),g.z<0&&!(C.frustum instanceof u["a"])&&!(C.frustum instanceof d["a"]))return;i=_.clipToGLWindowCoordinates(b,g,i)}return i.y=P.clientHeight-i.y,i},_.wgs84ToDrawingBufferCoordinates=function(t,e,o){if(o=_.wgs84ToWindowCoordinates(t,e,o),Object(c["a"])(o))return _.transformWindowToDrawingBuffer(t,o,o)};const C=new n["a"],v=new r["a"];_.computeActualWgs84Position=function(t,e,o){const i=t.mode;if(i===h["a"].SCENE3D)return n["a"].clone(e,o);const a=t.mapProjection,s=a.ellipsoid.cartesianToCartographic(e,v);if(!Object(c["a"])(s))return;if(a.project(s,C),i===h["a"].COLUMBUS_VIEW)return n["a"].fromElements(C.z,C.x,C.y,o);if(i===h["a"].SCENE2D)return n["a"].fromElements(0,C.x,C.y,o);const r=t.morphTime;return n["a"].fromElements(l["a"].lerp(C.z,e.x,r),l["a"].lerp(C.x,e.y,r),l["a"].lerp(C.y,e.z,r),o)};const x=new n["a"],I=new n["a"],S=new m["a"];_.clipToGLWindowCoordinates=function(t,e,o){return n["a"].divideByScalar(e,e.w,x),m["a"].computeViewportTransformation(t,0,1,S),m["a"].multiplyByPoint(S,x,I),a["a"].fromCartesian3(I,o)},_.transformWindowToDrawingBuffer=function(t,e,o){const i=t.canvas,n=t.drawingBufferWidth/i.clientWidth,s=t.drawingBufferHeight/i.clientHeight;return a["a"].fromElements(e.x*n,e.y*s,o)};const N=new s["a"],j=new s["a"];_.drawingBufferToWgs84Coordinates=function(t,e,o,i){const a=t.context,r=a.uniformState,l=r.currentFrustum,u=l.x,d=l.y;if(t.frameState.useLogDepth){const t=o*r.log2FarDepthFromNearPlusOne,e=Math.pow(2,t)-1;o=d*(1-u/(e+u))/(d-u)}const p=t.view.passState.viewport,h=s["a"].clone(s["a"].UNIT_W,N);let _;h.x=(e.x-p.x)/p.width*2-1,h.y=(e.y-p.y)/p.height*2-1,h.z=2*o-1,h.w=1;let f=t.camera.frustum;if(Object(c["a"])(f.fovy)){_=m["a"].multiplyByVector(r.inverseViewProjection,h,j);const t=1/_.w;n["a"].multiplyByScalar(_,t,_)}else Object(c["a"])(f._offCenterFrustum)&&(f=f._offCenterFrustum),_=j,_.x=.5*(h.x*(f.right-f.left)+f.left+f.right),_.y=.5*(h.y*(f.top-f.bottom)+f.bottom+f.top),_.z=.5*(h.z*(u-d)-u-d),_.w=1,_=m["a"].multiplyByVector(r.inverseView,_,_);return n["a"].fromCartesian4(_,i)},e["a"]=_},"59d5":function(t,e,o){"use strict";var i=o("670c"),a=o("be18"),n=o("a561"),s=o("bef8"),r=o("535a"),c=o("2f63"),l=o("7d62"),m=o("c52f"),u=o("8dd9"),d=o("5410"),p=o("c8ed"),h=o("93da"),_=o("df07"),f=o("52f0"),g=o("713f"),w=o("188e"),T=o("0260"),y=o("2ac3"),P=o("c698"),b=o("f806"),E=o("691b"),M=o("8909"),O=o("482f"),R=o("a307"),C=o("0c80"),v=o("619f");function x(t){this.enableInputs=!0,this.enableTranslate=!0,this.enableZoom=!0,this.enableRotate=!0,this.enableTilt=!0,this.enableLook=!0,this.inertiaSpin=.9,this.inertiaTranslate=.9,this.inertiaZoom=.8,this.maximumMovementRatio=.1,this.bounceAnimationTime=3,this.minimumZoomDistance=1,this.maximumZoomDistance=Number.POSITIVE_INFINITY,this.translateEventTypes=M["a"].LEFT_DRAG,this.zoomEventTypes=[M["a"].RIGHT_DRAG,M["a"].WHEEL,M["a"].PINCH],this.rotateEventTypes=M["a"].LEFT_DRAG,this.tiltEventTypes=[M["a"].MIDDLE_DRAG,M["a"].PINCH,{eventType:M["a"].LEFT_DRAG,modifier:p["a"].CTRL},{eventType:M["a"].RIGHT_DRAG,modifier:p["a"].CTRL}],this.lookEventTypes={eventType:M["a"].LEFT_DRAG,modifier:p["a"].SHIFT},this.minimumPickingTerrainHeight=15e4,this._minimumPickingTerrainHeight=this.minimumPickingTerrainHeight,this.minimumCollisionTerrainHeight=15e3,this._minimumCollisionTerrainHeight=this.minimumCollisionTerrainHeight,this.minimumTrackBallHeight=75e5,this._minimumTrackBallHeight=this.minimumTrackBallHeight,this.enableCollisionDetection=!0,this._scene=t,this._globe=void 0,this._ellipsoid=void 0,this._aggregator=new E["a"](t.canvas),this._lastInertiaSpinMovement=void 0,this._lastInertiaZoomMovement=void 0,this._lastInertiaTranslateMovement=void 0,this._lastInertiaTiltMovement=void 0,this._inertiaDisablers={_lastInertiaZoomMovement:["_lastInertiaSpinMovement","_lastInertiaTranslateMovement","_lastInertiaTiltMovement"],_lastInertiaTiltMovement:["_lastInertiaSpinMovement","_lastInertiaTranslateMovement"]},this._tweens=new v["a"],this._tween=void 0,this._horizontalRotationAxis=void 0,this._tiltCenterMousePosition=new i["a"](-1,-1),this._tiltCenter=new a["a"],this._rotateMousePosition=new i["a"](-1,-1),this._rotateStartPosition=new a["a"],this._strafeStartPosition=new a["a"],this._strafeMousePosition=new i["a"],this._strafeEndMousePosition=new i["a"],this._zoomMouseStart=new i["a"](-1,-1),this._zoomWorldPosition=new a["a"],this._useZoomWorldPosition=!1,this._tiltCVOffMap=!1,this._looking=!1,this._rotating=!1,this._strafing=!1,this._zoomingOnVector=!1,this._zoomingUnderground=!1,this._rotatingZoom=!1,this._adjustedHeightForTerrain=!1,this._cameraUnderground=!1;const e=t.mapProjection;this._maxCoord=e.project(new s["a"](Math.PI,h["a"].PI_OVER_TWO)),this._zoomFactor=5,this._rotateFactor=void 0,this._rotateRateRangeAdjustment=void 0,this._maximumRotateRate=1.77,this._minimumRotateRate=2e-4,this._minimumZoomRate=20,this._maximumZoomRate=5906376272e3,this._minimumUndergroundPickDistance=2e3,this._maximumUndergroundPickDistance=1e4}function I(t,e){if(t<0)return 0;const o=25*(1-e);return Math.exp(-o*t)}function S(t){return i["a"].equalsEpsilon(t.startPosition,t.endPosition,h["a"].EPSILON14)}const N=.4;function j(t,e,o,a,n,s,r){let l=s[r];Object(c["a"])(l)||(l=s[r]={startPosition:new i["a"],endPosition:new i["a"],motion:new i["a"],inertiaEnabled:!0});const m=t.getButtonPressTime(e,o),u=t.getButtonReleaseTime(e,o),d=m&&u&&(u.getTime()-m.getTime())/1e3,p=new Date,h=u&&(p.getTime()-u.getTime())/1e3;if(m&&u&&d<N){const r=I(h,a),m=t.getLastMovement(e,o);if(!Object(c["a"])(m)||S(m)||!l.inertiaEnabled)return;if(l.motion.x=.5*(m.endPosition.x-m.startPosition.x),l.motion.y=.5*(m.endPosition.y-m.startPosition.y),l.startPosition=i["a"].clone(m.startPosition,l.startPosition),l.endPosition=i["a"].multiplyByScalar(l.motion,r,l.endPosition),l.endPosition=i["a"].add(l.startPosition,l.endPosition,l.endPosition),isNaN(l.endPosition.x)||isNaN(l.endPosition.y)||i["a"].distance(l.startPosition,l.endPosition)<.5)return;if(!t.isButtonDown(e,o)){const i=t.getStartMousePosition(e,o);n(s,i,l)}}}function z(t,e){if(Object(c["a"])(e)){let o=t[e];Object(c["a"])(o)&&(o.inertiaEnabled=!0);const i=t._inertiaDisablers[e];if(Object(c["a"])(i)){const e=i.length;for(let a=0;a<e;++a)o=t[i[a]],Object(c["a"])(o)&&(o.inertiaEnabled=!1)}}}const D=[];function U(t,e,o,i,a,n){if(!Object(c["a"])(o))return;const s=t._aggregator;Array.isArray(o)||(D[0]=o,o=D);const r=o.length;for(let l=0;l<r;++l){const r=o[l],m=Object(c["a"])(r.eventType)?r.eventType:r,u=r.modifier,d=s.isMoving(m,u)&&s.getMovement(m,u),p=s.getStartMousePosition(m,u);t.enableInputs&&e&&(d?(i(t,p,d),z(t,n)):a<1&&j(s,m,u,a,i,t,n))}}const W=new y["a"],A=new a["a"],B=new i["a"],F=new a["a"],H=new i["a"],k=new a["a"],V=new a["a"],Z=new a["a"],L=new a["a"],G=new a["a"],q=new a["a"],Y=new a["a"],Q=new a["a"],X=new a["a"],J=new a["a"],K=new a["a"],$=new a["a"],tt=new a["a"],et=new a["a"],ot=new a["a"],it=new a["a"],at=new a["a"],nt=new a["a"],st={orientation:new u["a"]};function rt(t,e,o,n,s,r){let l=1;Object(c["a"])(r)&&(l=h["a"].clamp(Math.abs(r),.25,1));const m=o.endPosition.y-o.startPosition.y,u=m>0,d=u?t.minimumZoomDistance*l:0,p=t.maximumZoomDistance,_=s-d;let f=n*_;f=h["a"].clamp(f,t._minimumZoomRate,t._maximumZoomRate);let w=m/t._scene.canvas.clientHeight;w=Math.min(w,t.maximumMovementRatio);let T=f*w;if(t.enableCollisionDetection||0===t.minimumZoomDistance||!Object(c["a"])(t._globe)){if(T>0&&Math.abs(s-d)<1)return;if(T<0&&Math.abs(s-p)<1)return;s-T<d?T=s-d-1:s-T>p&&(T=s-p)}const y=t._scene,P=y.camera,b=y.mode,E=st.orientation;if(E.heading=P.heading,E.pitch=P.pitch,E.roll=P.roll,P.frustum instanceof g["a"])return void(Math.abs(T)>0&&(P.zoomIn(T),P._adjustOrthographicFrustum()));const M=i["a"].equals(e,t._zoomMouseStart);let O,v=t._zoomingOnVector,x=t._rotatingZoom;if(M||(t._zoomMouseStart=i["a"].clone(e,t._zoomMouseStart),Object(c["a"])(t._globe)&&(b===R["a"].SCENE2D?(O=P.getPickRay(e,W).origin,O=a["a"].fromElements(O.y,O.z,O.x)):O=Pt(t,e,A)),Object(c["a"])(O)?(t._useZoomWorldPosition=!0,t._zoomWorldPosition=a["a"].clone(O,t._zoomWorldPosition)):t._useZoomWorldPosition=!1,v=t._zoomingOnVector=!1,x=t._rotatingZoom=!1,t._zoomingUnderground=t._cameraUnderground),!t._useZoomWorldPosition)return void P.zoomIn(T);let I=b===R["a"].COLUMBUS_VIEW;if(P.positionCartographic.height<2e6&&(x=!0),!M||x){if(b===R["a"].SCENE2D){const o=t._zoomWorldPosition,i=P.position;if(!a["a"].equals(o,i)&&P.positionCartographic.height<2*t._maxCoord.x){const n=P.position.x,s=a["a"].subtract(o,i,F);a["a"].normalize(s,s);const r=a["a"].distance(o,i)*T/(.5*P.getMagnitude());P.move(s,.5*r),(P.position.x<0&&n>0||P.position.x>0&&n<0)&&(O=P.getPickRay(e,W).origin,O=a["a"].fromElements(O.y,O.z,O.x),t._zoomWorldPosition=a["a"].clone(O,t._zoomWorldPosition))}}else if(b===R["a"].SCENE3D){const e=a["a"].normalize(P.position,G);if(t._cameraUnderground||t._zoomingUnderground||P.positionCartographic.height<3e3&&Math.abs(a["a"].dot(P.direction,e))<.6)I=!0;else{const o=y.canvas,i=H;i.x=o.clientWidth/2,i.y=o.clientHeight/2;const n=Pt(t,i,k);if(Object(c["a"])(n))if(P.positionCartographic.height<1e6){if(!(a["a"].dot(P.direction,e)>=-.5)){const o=Y;a["a"].clone(P.position,o);const i=t._zoomWorldPosition;let n=q;if(n=a["a"].normalize(i,n),a["a"].dot(n,e)<0)return;const s=ot,r=J;a["a"].clone(P.direction,r),a["a"].add(o,a["a"].multiplyByScalar(r,1e3,it),s);const c=K,l=$;a["a"].subtract(i,o,c),a["a"].normalize(c,l);const m=a["a"].dot(e,l);if(m>=0)return void(t._zoomMouseStart.x=-1);const u=Math.acos(-m),d=a["a"].magnitude(o),p=a["a"].magnitude(i),_=d-T,f=a["a"].magnitude(c),g=Math.asin(h["a"].clamp(f/p*Math.sin(u),-1,1)),w=Math.asin(h["a"].clamp(_/p*Math.sin(u),-1,1)),y=g-w+u,b=Q;a["a"].normalize(o,b);let E=X;E=a["a"].cross(l,b,E),E=a["a"].normalize(E,E),a["a"].normalize(a["a"].cross(b,E,it),r),a["a"].multiplyByScalar(a["a"].normalize(s,it),a["a"].magnitude(s)-T,s),a["a"].normalize(o,o),a["a"].multiplyByScalar(o,_,o);const M=tt;a["a"].multiplyByScalar(a["a"].add(a["a"].multiplyByScalar(b,Math.cos(y)-1,at),a["a"].multiplyByScalar(r,Math.sin(y),nt),it),_,M),a["a"].add(o,M,o),a["a"].normalize(s,b),a["a"].normalize(a["a"].cross(b,E,it),r);const O=et;return a["a"].multiplyByScalar(a["a"].add(a["a"].multiplyByScalar(b,Math.cos(y)-1,at),a["a"].multiplyByScalar(r,Math.sin(y),nt),it),a["a"].magnitude(s),O),a["a"].add(s,O,s),a["a"].clone(o,P.position),a["a"].normalize(a["a"].subtract(s,o,it),P.direction),a["a"].clone(P.direction,P.direction),a["a"].cross(P.direction,P.up,P.right),a["a"].cross(P.right,P.direction,P.up),void P.setView(st)}I=!0}else{const e=a["a"].normalize(n,V),o=a["a"].normalize(t._zoomWorldPosition,Z),i=a["a"].dot(o,e);if(i>0&&i<1){const t=h["a"].acosClamped(i),n=a["a"].cross(o,e,L),s=Math.abs(t)>h["a"].toRadians(20)?.75*P.positionCartographic.height:P.positionCartographic.height-T,r=T/s;P.rotate(n,t*r)}}else I=!0}}t._rotatingZoom=!I}if(!M&&I||v){let o;const n=C["a"].wgs84ToWindowCoordinates(y,t._zoomWorldPosition,B);o=b!==R["a"].COLUMBUS_VIEW&&i["a"].equals(e,t._zoomMouseStart)&&Object(c["a"])(n)?P.getPickRay(n,W):P.getPickRay(e,W);const s=o.direction;b!==R["a"].COLUMBUS_VIEW&&b!==R["a"].SCENE2D||a["a"].fromElements(s.y,s.z,s.x,s),P.move(s,T),t._zoomingOnVector=!0}else P.zoomIn(T);t._cameraUnderground||P.setView(st)}const ct=new y["a"],lt=new y["a"],mt=new a["a"];function ut(t,e,o){const i=t._scene,n=i.camera;let s=n.getPickRay(o.startPosition,ct).origin,r=n.getPickRay(o.endPosition,lt).origin;s=a["a"].fromElements(s.y,s.z,s.x,s),r=a["a"].fromElements(r.y,r.z,r.x,r);const c=a["a"].subtract(s,r,mt),l=a["a"].magnitude(c);l>0&&(a["a"].normalize(c,c),n.move(c,l))}function dt(t,e,o){Object(c["a"])(o.distance)&&(o=o.distance);const i=t._scene,a=i.camera;rt(t,e,o,t._zoomFactor,a.getMagnitude())}const pt=new i["a"],ht=new i["a"];function _t(t,e,o){if(Object(c["a"])(o.angleAndHeight))return void ft(t,e,o.angleAndHeight);const a=t._scene,n=a.camera,s=a.canvas,r=s.clientWidth,l=s.clientHeight;let m=pt;m.x=2/r*o.startPosition.x-1,m.y=2/l*(l-o.startPosition.y)-1,m=i["a"].normalize(m,m);let u=ht;u.x=2/r*o.endPosition.x-1,u.y=2/l*(l-o.endPosition.y)-1,u=i["a"].normalize(u,u);let d=h["a"].acosClamped(m.x);m.y<0&&(d=h["a"].TWO_PI-d);let p=h["a"].acosClamped(u.x);u.y<0&&(p=h["a"].TWO_PI-p);const _=p-d;n.twistRight(_)}function ft(t,e,o){let i=t._rotateFactor*t._rotateRateRangeAdjustment;i>t._maximumRotateRate&&(i=t._maximumRotateRate),i<t._minimumRotateRate&&(i=t._minimumRotateRate);const a=t._scene,n=a.camera,s=a.canvas;let r=(o.endPosition.x-o.startPosition.x)/s.clientWidth;r=Math.min(r,t.maximumMovementRatio);const c=i*r*Math.PI*4;n.twistRight(c)}function gt(t){const e=t._scene.mapMode2D===O["a"].ROTATE;f["a"].equals(f["a"].IDENTITY,t._scene.camera.transform)?(U(t,t.enableTranslate,t.translateEventTypes,ut,t.inertiaTranslate,"_lastInertiaTranslateMovement"),U(t,t.enableZoom,t.zoomEventTypes,dt,t.inertiaZoom,"_lastInertiaZoomMovement"),e&&U(t,t.enableRotate,t.tiltEventTypes,_t,t.inertiaSpin,"_lastInertiaTiltMovement")):(U(t,t.enableZoom,t.zoomEventTypes,dt,t.inertiaZoom,"_lastInertiaZoomMovement"),e&&U(t,t.enableRotate,t.translateEventTypes,_t,t.inertiaSpin,"_lastInertiaSpinMovement"))}const wt=new y["a"],Tt=new a["a"],yt=new a["a"];function Pt(t,e,o){const i=t._scene,n=t._globe,s=i.camera;if(!Object(c["a"])(n))return;const r=!t._cameraUnderground;let l;i.pickPositionSupported&&(l=i.pickPositionWorldCoordinates(e,Tt));const m=s.getPickRay(e,wt),u=n.pickWorldCoordinates(m,i,r,yt),d=Object(c["a"])(l)?a["a"].distance(l,s.positionWC):Number.POSITIVE_INFINITY,p=Object(c["a"])(u)?a["a"].distance(u,s.positionWC):Number.POSITIVE_INFINITY;return d<p?a["a"].clone(l,o):a["a"].clone(u,o)}const bt=new s["a"];function Et(t){const e=t._ellipsoid,o=t._scene,i=o.camera,a=o.mode;let n=0;if(a===R["a"].SCENE3D){const t=e.cartesianToCartographic(i.position,bt);Object(c["a"])(t)&&(n=t.height)}else n=i.position.z;const s=Object(r["a"])(t._scene.globeHeight,0),l=Math.abs(s-n);return l}const Mt=new a["a"];function Ot(t,e){const o=e.origin,i=e.direction,n=Et(t),s=a["a"].normalize(o,Mt);let r=Math.abs(a["a"].dot(s,i));return r=2*Math.max(r,.5),n*r}function Rt(t,e,o,i){let n=a["a"].distance(e.origin,o);const s=Et(t),r=h["a"].clamp(5*s,t._minimumUndergroundPickDistance,t._maximumUndergroundPickDistance);return n>r&&(n=Math.min(n,s/5),n=Math.max(n,100)),y["a"].getPoint(e,n,i)}function Ct(t,e,o,i){let n;return Object(c["a"])(o)?(n=a["a"].distance(e.origin,o),n>t._maximumUndergroundPickDistance&&(n=Et(t))):n=Et(t),y["a"].getPoint(e,n,i)}const vt=new i["a"];function xt(t,e){const o=e.endPosition,a=i["a"].subtract(e.endPosition,e.startPosition,vt),n=t._strafeEndMousePosition;i["a"].add(n,a,n),e.endPosition=n,pe(t,e,t._strafeStartPosition),e.endPosition=o}const It=new y["a"],St=new y["a"],Nt=new a["a"],jt=new a["a"],zt=new a["a"],Dt=new a["a"],Ut=new w["a"](a["a"].UNIT_X,0),Wt=new i["a"],At=new i["a"];function Bt(t,e,o){if(a["a"].equals(e,t._translateMousePosition)||(t._looking=!1),a["a"].equals(e,t._strafeMousePosition)||(t._strafing=!1),t._looking)return void eo(t,e,o);if(t._strafing)return void xt(t,o);const n=t._scene,s=n.camera,r=t._cameraUnderground,l=i["a"].clone(o.startPosition,Wt),m=i["a"].clone(o.endPosition,At);let u=s.getPickRay(l,It);const p=a["a"].clone(a["a"].ZERO,Dt),_=a["a"].UNIT_X;let f;if(s.position.z<t._minimumPickingTerrainHeight&&(f=Pt(t,l,Nt),Object(c["a"])(f)&&(p.x=f.x)),r||p.x>s.position.z&&Object(c["a"])(f)){let n=f;return r&&(n=Ct(t,u,f,Nt)),i["a"].clone(e,t._strafeMousePosition),i["a"].clone(e,t._strafeEndMousePosition),a["a"].clone(n,t._strafeStartPosition),t._strafing=!0,void pe(t,o,t._strafeStartPosition)}const g=w["a"].fromPointNormal(p,_,Ut);u=s.getPickRay(l,It);const T=d["a"].rayPlane(u,g,Nt),y=s.getPickRay(m,St),P=d["a"].rayPlane(y,g,jt);if(!Object(c["a"])(T)||!Object(c["a"])(P))return t._looking=!0,eo(t,e,o),void i["a"].clone(e,t._translateMousePosition);const b=a["a"].subtract(T,P,zt),E=b.x;b.x=b.y,b.y=b.z,b.z=E;const M=a["a"].magnitude(b);M>h["a"].EPSILON6&&(a["a"].normalize(b,b),s.move(b,M))}const Ft=new i["a"],Ht=new y["a"],kt=new a["a"],Vt=new a["a"],Zt=new f["a"],Lt=new f["a"],Gt=new a["a"],qt=new w["a"](a["a"].UNIT_X,0),Yt=new a["a"],Qt=new s["a"],Xt=new f["a"],Jt=new T["a"],Kt=new _["a"],$t=new a["a"];function te(t,e,o){if(Object(c["a"])(o.angleAndHeight)&&(o=o.angleAndHeight),i["a"].equals(e,t._tiltCenterMousePosition)||(t._tiltCVOffMap=!1,t._looking=!1),t._looking)return void eo(t,e,o);const a=t._scene,n=a.camera;t._tiltCVOffMap||!t.onMap()||Math.abs(n.position.z)>t._minimumPickingTerrainHeight?(t._tiltCVOffMap=!0,ee(t,e,o)):oe(t,e,o)}function ee(t,e,o){const n=t._scene,s=n.camera,r=n.canvas,l=Ft;l.x=r.clientWidth/2,l.y=r.clientHeight/2;const u=s.getPickRay(l,Ht),d=a["a"].UNIT_X,p=u.origin,_=u.direction;let g;const w=a["a"].dot(d,_);if(Math.abs(w)>h["a"].EPSILON6&&(g=-a["a"].dot(d,p)/w),!Object(c["a"])(g)||g<=0)return t._looking=!0,eo(t,e,o),void i["a"].clone(e,t._tiltCenterMousePosition);const T=a["a"].multiplyByScalar(_,g,kt);a["a"].add(p,T,T);const y=n.mapProjection,P=y.ellipsoid;a["a"].fromElements(T.y,T.z,T.x,T);const E=y.unproject(T,Qt);P.cartographicToCartesian(E,T);const M=b["a"].eastNorthUpToFixedFrame(T,P,Zt),O=t._globe,R=t._ellipsoid;t._globe=void 0,t._ellipsoid=m["a"].UNIT_SPHERE,t._rotateFactor=1,t._rotateRateRangeAdjustment=1;const C=f["a"].clone(s.transform,Xt);s._setTransform(M),Pe(t,e,o,a["a"].UNIT_Z),s._setTransform(C),t._globe=O,t._ellipsoid=R;const v=R.maximumRadius;t._rotateFactor=1/v,t._rotateRateRangeAdjustment=v}function oe(t,e,o){const n=t._scene,s=n.camera,r=t._cameraUnderground;let l,u;const p=a["a"].UNIT_X;if(i["a"].equals(e,t._tiltCenterMousePosition))l=a["a"].clone(t._tiltCenter,kt);else{if(s.position.z<t._minimumPickingTerrainHeight&&(l=Pt(t,e,kt)),!Object(c["a"])(l)){u=s.getPickRay(e,Ht);const n=u.origin,r=u.direction;let m;const d=a["a"].dot(p,r);if(Math.abs(d)>h["a"].EPSILON6&&(m=-a["a"].dot(p,n)/d),!Object(c["a"])(m)||m<=0)return t._looking=!0,eo(t,e,o),void i["a"].clone(e,t._tiltCenterMousePosition);l=a["a"].multiplyByScalar(r,m,kt),a["a"].add(n,l,l)}r&&(Object(c["a"])(u)||(u=s.getPickRay(e,Ht)),Rt(t,u,l,l)),i["a"].clone(e,t._tiltCenterMousePosition),a["a"].clone(l,t._tiltCenter)}const g=n.canvas,y=Ft;y.x=g.clientWidth/2,y.y=t._tiltCenterMousePosition.y,u=s.getPickRay(y,Ht);const P=a["a"].clone(a["a"].ZERO,Gt);P.x=l.x;const E=w["a"].fromPointNormal(P,p,qt),M=d["a"].rayPlane(u,E,Vt),O=s._projection,R=O.ellipsoid;a["a"].fromElements(l.y,l.z,l.x,l);let C=O.unproject(l,Qt);R.cartographicToCartesian(C,l);const v=b["a"].eastNorthUpToFixedFrame(l,R,Zt);let x;Object(c["a"])(M)?(a["a"].fromElements(M.y,M.z,M.x,M),C=O.unproject(M,Qt),R.cartographicToCartesian(C,M),x=b["a"].eastNorthUpToFixedFrame(M,R,Lt)):x=v;const I=t._globe,S=t._ellipsoid;t._globe=void 0,t._ellipsoid=m["a"].UNIT_SPHERE,t._rotateFactor=1,t._rotateRateRangeAdjustment=1;let N=a["a"].UNIT_Z;const j=f["a"].clone(s.transform,Xt);s._setTransform(v);const z=a["a"].cross(a["a"].UNIT_Z,a["a"].normalize(s.position,Yt),Yt),D=a["a"].dot(s.right,z);if(Pe(t,e,o,N,!1,!0),s._setTransform(x),D<0){const i=o.startPosition.y-o.endPosition.y;(r&&i<0||!r&&i>0)&&(N=void 0);const a=s.constrainedAxis;s.constrainedAxis=void 0,Pe(t,e,o,N,!0,!1),s.constrainedAxis=a}else Pe(t,e,o,N,!0,!1);if(Object(c["a"])(s.constrainedAxis)){const t=a["a"].cross(s.direction,s.constrainedAxis,$t);a["a"].equalsEpsilon(t,a["a"].ZERO,h["a"].EPSILON6)||(a["a"].dot(t,s.right)<0&&a["a"].negate(t,t),a["a"].cross(t,s.direction,s.up),a["a"].cross(s.direction,s.up,s.right),a["a"].normalize(s.up,s.up),a["a"].normalize(s.right,s.right))}s._setTransform(j),t._globe=I,t._ellipsoid=S;const U=S.maximumRadius;t._rotateFactor=1/U,t._rotateRateRangeAdjustment=U;const W=a["a"].clone(s.positionWC,Yt);if(t.enableCollisionDetection&&no(t),!a["a"].equals(s.positionWC,W)){s._setTransform(x),s.worldToCameraCoordinatesPoint(W,W);const t=a["a"].magnitudeSquared(W);a["a"].magnitudeSquared(s.position)>t&&(a["a"].normalize(s.position,s.position),a["a"].multiplyByScalar(s.position,Math.sqrt(t),s.position));const e=a["a"].angleBetween(W,s.position),o=a["a"].cross(W,s.position,W);a["a"].normalize(o,o);const i=T["a"].fromAxisAngle(o,e,Jt),n=_["a"].fromQuaternion(i,Kt);_["a"].multiplyByVector(n,s.direction,s.direction),_["a"].multiplyByVector(n,s.up,s.up),a["a"].cross(s.direction,s.up,s.right),a["a"].cross(s.right,s.direction,s.up),s._setTransform(j)}}const ie=new i["a"],ae=new y["a"],ne=new a["a"];function se(t,e,o){Object(c["a"])(o.distance)&&(o=o.distance);const i=t._scene,n=i.camera,s=i.canvas,r=t._cameraUnderground;let l;r?l=e:(l=ie,l.x=s.clientWidth/2,l.y=s.clientHeight/2);const m=n.getPickRay(l,ae),u=m.origin,d=m.direction,p=n.position.z;let h,_;if(p<t._minimumPickingTerrainHeight&&(h=Pt(t,l,ne)),Object(c["a"])(h)&&(_=a["a"].distance(u,h)),r){const e=Ot(t,m,p);_=Object(c["a"])(_)?Math.min(_,e):e}if(!Object(c["a"])(_)){const t=a["a"].UNIT_X;_=-a["a"].dot(t,u)/a["a"].dot(t,d)}rt(t,e,o,t._zoomFactor,_)}function re(t){const e=t._scene,o=e.camera;if(f["a"].equals(f["a"].IDENTITY,o.transform)){const e=t._tweens;if(t._aggregator.anyButtonDown&&e.removeAll(),U(t,t.enableTilt,t.tiltEventTypes,te,t.inertiaSpin,"_lastInertiaTiltMovement"),U(t,t.enableTranslate,t.translateEventTypes,Bt,t.inertiaTranslate,"_lastInertiaTranslateMovement"),U(t,t.enableZoom,t.zoomEventTypes,se,t.inertiaZoom,"_lastInertiaZoomMovement"),U(t,t.enableLook,t.lookEventTypes,eo),!t._aggregator.anyButtonDown&&!e.contains(t._tween)){const i=o.createCorrectPositionTween(t.bounceAnimationTime);Object(c["a"])(i)&&(t._tween=e.add(i))}e.update()}else U(t,t.enableRotate,t.rotateEventTypes,Pe,t.inertiaSpin,"_lastInertiaSpinMovement"),U(t,t.enableZoom,t.zoomEventTypes,je,t.inertiaZoom,"_lastInertiaZoomMovement")}const ce=new y["a"],le=new w["a"](a["a"].UNIT_X,0),me=new a["a"],ue=new a["a"],de=new a["a"];function pe(t,e,o){const i=t._scene,n=i.camera,s=n.getPickRay(e.endPosition,ce);let r=a["a"].clone(n.direction,ue);i.mode===R["a"].COLUMBUS_VIEW&&a["a"].fromElements(r.z,r.x,r.y,r);const l=w["a"].fromPointNormal(o,r,le),m=d["a"].rayPlane(s,l,me);Object(c["a"])(m)&&(r=a["a"].subtract(o,m,r),i.mode===R["a"].COLUMBUS_VIEW&&a["a"].fromElements(r.y,r.z,r.x,r),a["a"].add(n.position,r,n.position))}const he=new a["a"],_e=new s["a"],fe=new a["a"],ge=new m["a"],we=new a["a"],Te=new a["a"];function ye(t,e,o){const n=t._scene,s=n.camera,r=t._cameraUnderground;let l,u,d=t._ellipsoid;if(!f["a"].equals(s.transform,f["a"].IDENTITY))return void Pe(t,e,o);const p=d.geodeticSurfaceNormal(s.position,we);if(i["a"].equals(e,t._rotateMousePosition)){if(t._looking)eo(t,e,o,p);else if(t._rotating)Pe(t,e,o);else if(t._strafing)xt(t,o);else{if(a["a"].magnitude(s.position)<a["a"].magnitude(t._rotateStartPosition))return;l=a["a"].magnitude(t._rotateStartPosition),u=fe,u.x=u.y=u.z=l,d=m["a"].fromCartesian3(u,ge),Ie(t,e,o,d)}return}t._looking=!1,t._rotating=!1,t._strafing=!1;const h=d.cartesianToCartographic(s.positionWC,_e).height,_=t._globe;if(Object(c["a"])(_)&&h<t._minimumPickingTerrainHeight){const n=Pt(t,o.startPosition,de);if(Object(c["a"])(n)){let c=!1;const p=s.getPickRay(o.startPosition,wt);if(r)c=!0,Ct(t,p,n,n);else{const t=d.geodeticSurfaceNormal(n,Te),e=Math.abs(a["a"].dot(p.direction,t))<.05;c=!!e||a["a"].magnitude(s.position)<a["a"].magnitude(n)}c?(i["a"].clone(e,t._strafeEndMousePosition),a["a"].clone(n,t._strafeStartPosition),t._strafing=!0,pe(t,o,t._strafeStartPosition)):(l=a["a"].magnitude(n),u=fe,u.x=u.y=u.z=l,d=m["a"].fromCartesian3(u,ge),Ie(t,e,o,d),a["a"].clone(n,t._rotateStartPosition))}else t._looking=!0,eo(t,e,o,p)}else Object(c["a"])(s.pickEllipsoid(o.startPosition,t._ellipsoid,he))?(Ie(t,e,o,t._ellipsoid),a["a"].clone(he,t._rotateStartPosition)):h>t._minimumTrackBallHeight?(t._rotating=!0,Pe(t,e,o)):(t._looking=!0,eo(t,e,o,p));i["a"].clone(e,t._rotateMousePosition)}function Pe(t,e,o,i,n,s){n=Object(r["a"])(n,!1),s=Object(r["a"])(s,!1);const l=t._scene,m=l.camera,u=l.canvas,d=m.constrainedAxis;Object(c["a"])(i)&&(m.constrainedAxis=i);const p=a["a"].magnitude(m.position);let h=t._rotateFactor*(p-t._rotateRateRangeAdjustment);h>t._maximumRotateRate&&(h=t._maximumRotateRate),h<t._minimumRotateRate&&(h=t._minimumRotateRate);let _=(o.startPosition.x-o.endPosition.x)/u.clientWidth,f=(o.startPosition.y-o.endPosition.y)/u.clientHeight;_=Math.min(_,t.maximumMovementRatio),f=Math.min(f,t.maximumMovementRatio);const g=h*_*Math.PI*2,w=h*f*Math.PI;n||m.rotateRight(g),s||m.rotateUp(w),m.constrainedAxis=d}const be=n["a"].clone(n["a"].UNIT_W),Ee=n["a"].clone(n["a"].UNIT_W),Me=new a["a"],Oe=new a["a"],Re=new a["a"],Ce=new a["a"],ve=new i["a"],xe=new i["a"];function Ie(t,e,o,n){const s=t._scene,r=s.camera,l=i["a"].clone(o.startPosition,ve),m=i["a"].clone(o.endPosition,xe);let u=r.pickEllipsoid(l,n,be),d=r.pickEllipsoid(m,n,Ee);if(!Object(c["a"])(u)||!Object(c["a"])(d))return t._rotating=!0,void Pe(t,e,o);if(u=r.worldToCameraCoordinates(u,u),d=r.worldToCameraCoordinates(d,d),Object(c["a"])(r.constrainedAxis)){const t=r.constrainedAxis,e=a["a"].mostOrthogonalAxis(t,Me);a["a"].cross(e,t,e),a["a"].normalize(e,e);const o=a["a"].cross(t,e,Oe),i=a["a"].magnitude(u),n=a["a"].dot(t,u),s=Math.acos(n/i),c=a["a"].multiplyByScalar(t,n,Re);a["a"].subtract(u,c,c),a["a"].normalize(c,c);const l=a["a"].magnitude(d),m=a["a"].dot(t,d),p=Math.acos(m/l),_=a["a"].multiplyByScalar(t,m,Ce);a["a"].subtract(d,_,_),a["a"].normalize(_,_);let f=Math.acos(a["a"].dot(c,e));a["a"].dot(c,o)<0&&(f=h["a"].TWO_PI-f);let g=Math.acos(a["a"].dot(_,e));a["a"].dot(_,o)<0&&(g=h["a"].TWO_PI-g);const w=f-g;let T;T=a["a"].equalsEpsilon(t,r.position,h["a"].EPSILON2)?r.right:a["a"].cross(t,r.position,Me);const y=a["a"].cross(t,T,Me),P=a["a"].dot(y,a["a"].subtract(u,t,Oe)),b=a["a"].dot(y,a["a"].subtract(d,t,Oe));let E;E=P>0&&b>0?p-s:P>0&&b<=0?a["a"].dot(r.position,t)>0?-s-p:s+p:s-p,r.rotateRight(w),r.rotateUp(E)}else{a["a"].normalize(u,u),a["a"].normalize(d,d);const t=a["a"].dot(u,d),e=a["a"].cross(u,d,Me);if(t<1&&!a["a"].equalsEpsilon(e,a["a"].ZERO,h["a"].EPSILON14)){const o=Math.acos(t);r.rotate(e,o)}}}const Se=new a["a"],Ne=new s["a"];function je(t,e,o){Object(c["a"])(o.distance)&&(o=o.distance);const i=t._ellipsoid,n=t._scene,s=n.camera,r=n.canvas,l=t._cameraUnderground;let m;l?m=e:(m=ie,m.x=r.clientWidth/2,m.y=r.clientHeight/2);const u=s.getPickRay(m,ae);let d;const p=i.cartesianToCartographic(s.position,Ne).height;let h;if(p<t._minimumPickingTerrainHeight&&(d=Pt(t,m,ne)),Object(c["a"])(d)&&(h=a["a"].distance(u.origin,d)),l){const e=Ot(t,u,p);h=Object(c["a"])(h)?Math.min(h,e):e}Object(c["a"])(h)||(h=p);const _=a["a"].normalize(s.position,Se);rt(t,e,o,t._zoomFactor,h,a["a"].dot(_,s.direction))}const ze=new i["a"],De=new y["a"],Ue=new a["a"],We=new a["a"],Ae=new f["a"],Be=new f["a"],Fe=new f["a"],He=new T["a"],ke=new _["a"],Ve=new s["a"],Ze=new a["a"];function Le(t,e,o){const a=t._scene,n=a.camera;if(!f["a"].equals(n.transform,f["a"].IDENTITY))return;if(Object(c["a"])(o.angleAndHeight)&&(o=o.angleAndHeight),i["a"].equals(e,t._tiltCenterMousePosition)||(t._tiltOnEllipsoid=!1,t._looking=!1),t._looking){const i=t._ellipsoid.geodeticSurfaceNormal(n.position,Ze);return void eo(t,e,o,i)}const s=t._ellipsoid,r=s.cartesianToCartographic(n.position,Ve);t._tiltOnEllipsoid||r.height>t._minimumCollisionTerrainHeight?(t._tiltOnEllipsoid=!0,qe(t,e,o)):Ye(t,e,o)}const Ge=new s["a"];function qe(t,e,o){const n=t._ellipsoid,s=t._scene,r=s.camera,l=.25*t.minimumZoomDistance,u=n.cartesianToCartographic(r.positionWC,Ge).height;if(u-l-1<h["a"].EPSILON3&&o.endPosition.y-o.startPosition.y<0)return;const p=s.canvas,_=ze;_.x=p.clientWidth/2,_.y=p.clientHeight/2;const g=r.getPickRay(_,De);let w;const T=d["a"].rayEllipsoid(g,n);if(Object(c["a"])(T))w=y["a"].getPoint(g,T.start,Ue);else{if(!(u>t._minimumTrackBallHeight)){t._looking=!0;const a=t._ellipsoid.geodeticSurfaceNormal(r.position,Ze);return eo(t,e,o,a),void i["a"].clone(e,t._tiltCenterMousePosition)}{const t=d["a"].grazingAltitudeLocation(g,n);if(!Object(c["a"])(t))return;const e=n.cartesianToCartographic(t,Ve);e.height=0,w=n.cartographicToCartesian(e,Ue)}}const P=b["a"].eastNorthUpToFixedFrame(w,n,Ae),E=t._globe,M=t._ellipsoid;t._globe=void 0,t._ellipsoid=m["a"].UNIT_SPHERE,t._rotateFactor=1,t._rotateRateRangeAdjustment=1;const O=f["a"].clone(r.transform,Fe);r._setTransform(P),Pe(t,e,o,a["a"].UNIT_Z),r._setTransform(O),t._globe=E,t._ellipsoid=M;const R=M.maximumRadius;t._rotateFactor=1/R,t._rotateRateRangeAdjustment=R}function Ye(t,e,o){const n=t._ellipsoid,s=t._scene,r=s.camera,l=t._cameraUnderground;let u,p,g;if(i["a"].equals(e,t._tiltCenterMousePosition))u=a["a"].clone(t._tiltCenter,Ue);else{if(u=Pt(t,e,Ue),!Object(c["a"])(u)){if(p=r.getPickRay(e,De),g=d["a"].rayEllipsoid(p,n),!Object(c["a"])(g)){const a=n.cartesianToCartographic(r.position,Ve);if(a.height<=t._minimumTrackBallHeight){t._looking=!0;const a=t._ellipsoid.geodeticSurfaceNormal(r.position,Ze);eo(t,e,o,a),i["a"].clone(e,t._tiltCenterMousePosition)}return}u=y["a"].getPoint(p,g.start,Ue)}l&&(Object(c["a"])(p)||(p=r.getPickRay(e,De)),Rt(t,p,u,u)),i["a"].clone(e,t._tiltCenterMousePosition),a["a"].clone(u,t._tiltCenter)}const w=s.canvas,P=ze;P.x=w.clientWidth/2,P.y=t._tiltCenterMousePosition.y,p=r.getPickRay(P,De);const E=a["a"].magnitude(u),M=a["a"].fromElements(E,E,E,fe),O=m["a"].fromCartesian3(M,ge);if(g=d["a"].rayEllipsoid(p,O),!Object(c["a"])(g))return;const R=a["a"].magnitude(p.origin)>E?g.start:g.stop,C=y["a"].getPoint(p,R,We),v=b["a"].eastNorthUpToFixedFrame(u,n,Ae),x=b["a"].eastNorthUpToFixedFrame(C,O,Be),I=t._globe,S=t._ellipsoid;t._globe=void 0,t._ellipsoid=m["a"].UNIT_SPHERE,t._rotateFactor=1,t._rotateRateRangeAdjustment=1;let N=a["a"].UNIT_Z;const j=f["a"].clone(r.transform,Fe);r._setTransform(x);const z=a["a"].cross(C,r.positionWC,$t),D=a["a"].dot(r.rightWC,z);if(D<0){const i=o.startPosition.y-o.endPosition.y;(l&&i<0||!l&&i>0)&&(N=void 0);const a=r.constrainedAxis;r.constrainedAxis=void 0,Pe(t,e,o,N,!0,!1),r.constrainedAxis=a}else Pe(t,e,o,N,!0,!1);if(r._setTransform(v),Pe(t,e,o,N,!1,!0),Object(c["a"])(r.constrainedAxis)){const t=a["a"].cross(r.direction,r.constrainedAxis,$t);a["a"].equalsEpsilon(t,a["a"].ZERO,h["a"].EPSILON6)||(a["a"].dot(t,r.right)<0&&a["a"].negate(t,t),a["a"].cross(t,r.direction,r.up),a["a"].cross(r.direction,r.up,r.right),a["a"].normalize(r.up,r.up),a["a"].normalize(r.right,r.right))}r._setTransform(j),t._globe=I,t._ellipsoid=S;const U=S.maximumRadius;t._rotateFactor=1/U,t._rotateRateRangeAdjustment=U;const W=a["a"].clone(r.positionWC,$t);if(t.enableCollisionDetection&&no(t),!a["a"].equals(r.positionWC,W)){r._setTransform(x),r.worldToCameraCoordinatesPoint(W,W);const t=a["a"].magnitudeSquared(W);a["a"].magnitudeSquared(r.position)>t&&(a["a"].normalize(r.position,r.position),a["a"].multiplyByScalar(r.position,Math.sqrt(t),r.position));const e=a["a"].angleBetween(W,r.position),o=a["a"].cross(W,r.position,W);a["a"].normalize(o,o);const i=T["a"].fromAxisAngle(o,e,He),n=_["a"].fromQuaternion(i,ke);_["a"].multiplyByVector(n,r.direction,r.direction),_["a"].multiplyByVector(n,r.up,r.up),a["a"].cross(r.direction,r.up,r.right),a["a"].cross(r.right,r.direction,r.up),r._setTransform(j)}}const Qe=new i["a"],Xe=new i["a"],Je=new y["a"],Ke=new y["a"],$e=new a["a"],to=new a["a"];function eo(t,e,o,i){const n=t._scene,s=n.camera,l=Qe;l.x=o.startPosition.x,l.y=0;const m=Xe;m.x=o.endPosition.x,m.y=0;let u,d,p=s.getPickRay(l,Je),_=s.getPickRay(m,Ke),f=0;s.frustum instanceof g["a"]?(u=p.origin,d=_.origin,a["a"].add(s.direction,u,u),a["a"].add(s.direction,d,d),a["a"].subtract(u,s.position,u),a["a"].subtract(d,s.position,d),a["a"].normalize(u,u),a["a"].normalize(d,d)):(u=p.direction,d=_.direction);let w=a["a"].dot(u,d);w<1&&(f=Math.acos(w)),f=o.startPosition.x>o.endPosition.x?-f:f;const T=t._horizontalRotationAxis;if(Object(c["a"])(i)?s.look(i,-f):Object(c["a"])(T)?s.look(T,-f):s.lookLeft(f),l.x=0,l.y=o.startPosition.y,m.x=0,m.y=o.endPosition.y,p=s.getPickRay(l,Je),_=s.getPickRay(m,Ke),f=0,s.frustum instanceof g["a"]?(u=p.origin,d=_.origin,a["a"].add(s.direction,u,u),a["a"].add(s.direction,d,d),a["a"].subtract(u,s.position,u),a["a"].subtract(d,s.position,d),a["a"].normalize(u,u),a["a"].normalize(d,d)):(u=p.direction,d=_.direction),w=a["a"].dot(u,d),w<1&&(f=Math.acos(w)),f=o.startPosition.y>o.endPosition.y?-f:f,i=Object(r["a"])(i,T),Object(c["a"])(i)){const t=s.direction,e=a["a"].negate(i,$e),o=a["a"].equalsEpsilon(t,i,h["a"].EPSILON2),n=a["a"].equalsEpsilon(t,e,h["a"].EPSILON2);if(o||n)(o&&f<0||n&&f>0)&&s.look(s.right,-f);else{w=a["a"].dot(t,i);let o=h["a"].acosClamped(w);f>0&&f>o&&(f=o-h["a"].EPSILON4),w=a["a"].dot(t,e),o=h["a"].acosClamped(w),f<0&&-f>o&&(f=-o+h["a"].EPSILON4);const n=a["a"].cross(i,t,to);s.look(n,f)}}else s.lookUp(f)}function oo(t){U(t,t.enableRotate,t.rotateEventTypes,ye,t.inertiaSpin,"_lastInertiaSpinMovement"),U(t,t.enableZoom,t.zoomEventTypes,je,t.inertiaZoom,"_lastInertiaZoomMovement"),U(t,t.enableTilt,t.tiltEventTypes,Le,t.inertiaSpin,"_lastInertiaTiltMovement"),U(t,t.enableLook,t.lookEventTypes,eo)}const io=new f["a"],ao=new s["a"];function no(t){t._adjustedHeightForTerrain=!0;const e=t._scene,o=e.mode,i=e.globe;if(!Object(c["a"])(i)||o===R["a"].SCENE2D||o===R["a"].MORPHING)return;const n=e.camera,s=i.ellipsoid,r=e.mapProjection;let l,m;f["a"].equals(n.transform,f["a"].IDENTITY)||(l=f["a"].clone(n.transform,io),m=a["a"].magnitude(n.position),n._setTransform(f["a"].IDENTITY));const u=ao;o===R["a"].SCENE3D?s.cartesianToCartographic(n.position,u):r.unproject(n.position,u);let d=!1;if(u.height<t._minimumCollisionTerrainHeight){const e=t._scene.globeHeight;if(Object(c["a"])(e)){const i=e+t.minimumZoomDistance;u.height<i&&(u.height=i,o===R["a"].SCENE3D?s.cartographicToCartesian(u,n.position):r.project(u,n.position),d=!0)}}Object(c["a"])(l)&&(n._setTransform(l),d&&(a["a"].normalize(n.position,n.position),a["a"].negate(n.position,n.direction),a["a"].multiplyByScalar(n.position,Math.max(m,t.minimumZoomDistance),n.position),a["a"].normalize(n.direction,n.direction),a["a"].cross(n.direction,n.up,n.right),a["a"].cross(n.right,n.direction,n.up)))}x.prototype.onMap=function(){const t=this._scene,e=t.mode,o=t.camera;return e!==R["a"].COLUMBUS_VIEW||Math.abs(o.position.x)-this._maxCoord.x<0&&Math.abs(o.position.y)-this._maxCoord.y<0};const so=new a["a"],ro=new a["a"];x.prototype.update=function(){const t=this._scene,e=t.camera,o=t.globe,i=t.mode;f["a"].equals(e.transform,f["a"].IDENTITY)?(this._globe=o,this._ellipsoid=Object(c["a"])(this._globe)?this._globe.ellipsoid:t.mapProjection.ellipsoid):(this._globe=void 0,this._ellipsoid=m["a"].UNIT_SPHERE);const n=Object(c["a"])(this._globe)?this._globe.terrainExaggeration:1,s=Object(c["a"])(this._globe)?this._globe.terrainExaggerationRelativeHeight:0;this._minimumCollisionTerrainHeight=P["a"].getHeight(this.minimumCollisionTerrainHeight,n,s),this._minimumPickingTerrainHeight=P["a"].getHeight(this.minimumPickingTerrainHeight,n,s),this._minimumTrackBallHeight=P["a"].getHeight(this.minimumTrackBallHeight,n,s),this._cameraUnderground=t.cameraUnderground&&Object(c["a"])(this._globe);const r=this._ellipsoid.maximumRadius;this._rotateFactor=1/r,this._rotateRateRangeAdjustment=r,this._adjustedHeightForTerrain=!1;const l=a["a"].clone(e.positionWC,so),u=a["a"].clone(e.directionWC,ro);if(i===R["a"].SCENE2D?gt(this):i===R["a"].COLUMBUS_VIEW?(this._horizontalRotationAxis=a["a"].UNIT_Z,re(this)):i===R["a"].SCENE3D&&(this._horizontalRotationAxis=void 0,oo(this)),this.enableCollisionDetection&&!this._adjustedHeightForTerrain){const t=!a["a"].equals(l,e.positionWC)||!a["a"].equals(u,e.directionWC);t&&no(this)}this._aggregator.reset()},x.prototype.isDestroyed=function(){return!1},x.prototype.destroy=function(){return this._tweens.removeAll(),this._aggregator=this._aggregator&&this._aggregator.destroy(),Object(l["a"])(this)},e["a"]=x},"7fe1":function(t,e,o){"use strict";var i=o("bd8d"),a=o("7d62"),n=o("f845"),s=o("f630"),r=o("6ef5");function c(){this._numSamples=1,this._colorFramebuffer=new s["a"]({depthStencil:!0,supportsDepthTexture:!0}),this._idFramebuffer=new s["a"]({depthStencil:!0,supportsDepthTexture:!0}),this._idClearColor=new i["a"](0,0,0,0),this._clearCommand=new n["a"]({color:new i["a"](0,0,0,0),depth:1,owner:this})}function l(t){t._colorFramebuffer.destroy(),t._idFramebuffer.destroy()}Object.defineProperties(c.prototype,{framebuffer:{get:function(){return this._colorFramebuffer.framebuffer}},idFramebuffer:{get:function(){return this._idFramebuffer.framebuffer}},depthStencilTexture:{get:function(){return this._colorFramebuffer.getDepthStencilTexture()}}}),c.prototype.update=function(t,e,o,i){const a=e.width,n=e.height,s=o?t.halfFloatingPointTexture?r["a"].HALF_FLOAT:r["a"].FLOAT:r["a"].UNSIGNED_BYTE;this._numSamples=i,this._colorFramebuffer.update(t,a,n,i,s),this._idFramebuffer.update(t,a,n)},c.prototype.clear=function(t,e,o){i["a"].clone(o,this._clearCommand.color),i["a"].clone(this._idClearColor,this._clearCommand.color),this._colorFramebuffer.clear(t,this._clearCommand,e),this._idFramebuffer.clear(t,this._clearCommand,e)},c.prototype.getFramebuffer=function(){return this._colorFramebuffer.framebuffer},c.prototype.getIdFramebuffer=function(){return this._idFramebuffer.framebuffer},c.prototype.prepareColorTextures=function(t){this._numSamples>1&&this._colorFramebuffer.prepareTextures(t)},c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){return l(this),Object(a["a"])(this)},e["a"]=c},a307:function(t,e,o){"use strict";const i={MORPHING:0,COLUMBUS_VIEW:1,SCENE2D:2,SCENE3D:3,getMorphTime:function(t){return t===i.SCENE3D?1:t!==i.MORPHING?0:void 0}};e["a"]=Object.freeze(i)}}]);