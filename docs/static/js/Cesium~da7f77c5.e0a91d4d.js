(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Cesium~da7f77c5"],{"2ab8":function(t,e,i){"use strict";var n=i("670c"),a=i("bd8d"),o=i("2f63"),s=i("7d62"),r=i("1b8d"),c=i("f845"),l=i("a894"),d=i("f630"),h=i("d289"),u=i("6dc0"),_=i("5770"),p=i("b7c8"),m=i("3626"),f=i("bfce");function b(){this._framebuffer=new d["a"]({colorAttachmentsLength:2,depth:!0,supportsDepthTexture:!0}),this._drawCommand=void 0,this._clearCommand=void 0,this._strength=1,this._radius=1}function y(t){t._framebuffer.destroy(),t._drawCommand=void 0,t._clearCommand=void 0}Object.defineProperties(b.prototype,{framebuffer:{get:function(){return this._framebuffer.framebuffer}},colorGBuffer:{get:function(){return this._framebuffer.getColorTexture(0)}},depthGBuffer:{get:function(){return this._framebuffer.getColorTexture(1)}}});const g=new n["a"];function O(t,e){const i=new _["a"]({defines:["LOG_DEPTH_WRITE"],sources:[f["a"]]}),n={u_pointCloud_colorGBuffer:function(){return t.colorGBuffer},u_pointCloud_depthGBuffer:function(){return t.depthGBuffer},u_distanceAndEdlStrength:function(){return g.x=t._radius,g.y=t._strength,g}},o=u["a"].fromCache({blending:p["a"].ALPHA_BLEND,depthMask:!0,depthTest:{enabled:!0},stencilTest:m["a"].setCesium3DTileBit(),stencilMask:m["a"].CESIUM_3D_TILE_MASK});t._drawCommand=e.createViewportQuadCommand(i,{uniformMap:n,renderState:o,pass:h["a"].CESIUM_3D_TILE,owner:t}),t._clearCommand=new c["a"]({framebuffer:t.framebuffer,color:new a["a"](0,0,0,0),depth:1,renderState:u["a"].fromCache(),pass:h["a"].CESIUM_3D_TILE,owner:t})}function S(t,e){const i=e.drawingBufferWidth,n=e.drawingBufferHeight;t._framebuffer.update(e,i,n),O(t,e)}function T(t){return t.drawBuffers&&t.fragmentDepth}function D(t,e){let i=t.shaderCache.getDerivedShaderProgram(e,"EC");if(!Object(o["a"])(i)){const n=e._attributeLocations,a=e.fragmentShaderSource.clone();a.sources=a.sources.map((function(t){return t=_["a"].replaceMain(t,"czm_point_cloud_post_process_main"),t=t.replace(/gl_FragColor/g,"gl_FragData[0]"),t})),a.sources.unshift("#extension GL_EXT_draw_buffers : enable \n"),a.sources.push("void main() \n{ \n    czm_point_cloud_post_process_main(); \n#ifdef LOG_DEPTH\n    czm_writeLogDepth();\n    gl_FragData[1] = czm_packDepth(gl_FragDepthEXT); \n#else\n    gl_FragData[1] = czm_packDepth(gl_FragCoord.z);\n#endif\n}"),i=t.shaderCache.createDerivedShaderProgram(e,"EC",{vertexShaderSource:e.vertexShaderSource,fragmentShaderSource:a,attributeLocations:n})}return i}b.isSupported=T,b.prototype.update=function(t,e,i,n){if(!T(t.context))return;let a;this._strength=i.eyeDomeLightingStrength,this._radius=i.eyeDomeLightingRadius*t.pixelRatio,S(this,t.context);const s=t.commandList,c=s.length;for(a=e;a<c;++a){const e=s[a];if(e.primitiveType!==r["a"].POINTS||e.pass===h["a"].TRANSLUCENT)continue;let i,n,c=e.derivedCommands.pointCloudProcessor;Object(o["a"])(c)&&(i=c.command,n=c.originalShaderProgram),Object(o["a"])(i)&&!e.dirty&&n===e.shaderProgram&&i.framebuffer===this.framebuffer||(i=l["a"].shallowClone(e,i),i.framebuffer=this.framebuffer,i.shaderProgram=D(t.context,e.shaderProgram),i.castShadows=!1,i.receiveShadows=!1,Object(o["a"])(c)||(c={command:i,originalShaderProgram:e.shaderProgram},e.derivedCommands.pointCloudProcessor=c),c.originalShaderProgram=e.shaderProgram),s[a]=i}const d=this._clearCommand,u=this._drawCommand;u.boundingVolume=n,s.push(u),s.push(d)},b.prototype.isDestroyed=function(){return!1},b.prototype.destroy=function(){return y(this),Object(s["a"])(this)},e["a"]=b},3443:function(t,e,i){"use strict";var n=i("cef5"),a=i("be18"),o=i("a561"),s=i("dc1c"),r=i("bd8d"),c=i("2bb9"),l=i("abab"),d=i("535a"),h=i("2f63"),u=i("7d62"),_=i("93da"),p=i("52f0"),m=i("b639"),f=i("713f"),b=i("1b8d"),y=i("283e"),g=i("f806"),O=i("f20a"),S=i("8b68"),T=i("a894"),D=i("d289"),C=i("6dc0"),E=i("e90c"),A=i("7c5e"),I=i("d34e"),P=i.n(I),N=i("b7c8"),v=i("6596"),L=i("08b8"),B=i("d663"),x=i("0249"),w=i("b005"),j=i("a307"),R=i("c86b"),z=i("3de6"),U=i("b85c"),M=i("3626");const V={NEEDS_DECODE:0,DECODING:1,READY:2,FAILED:3};function G(t){this._parsedContent=void 0,this._drawCommand=void 0,this._isTranslucent=!1,this._styleTranslucent=!1,this._constantColor=r["a"].clone(r["a"].DARKGRAY),this._highlightColor=r["a"].clone(r["a"].WHITE),this._pointSize=1,this._rtcCenter=void 0,this._quantizedVolumeScale=void 0,this._quantizedVolumeOffset=void 0,this._styleableShaderAttributes=void 0,this._isQuantized=!1,this._isOctEncoded16P=!1,this._isRGB565=!1,this._hasColors=!1,this._hasNormals=!1,this._hasBatchIds=!1,this._decodingState=V.READY,this._dequantizeInShader=!0,this._isQuantizedDraco=!1,this._isOctEncodedDraco=!1,this._quantizedRange=0,this._octEncodedRange=0,this.backFaceCulling=!1,this._backFaceCulling=!1,this.normalShading=!0,this._normalShading=!0,this._opaqueRenderState=void 0,this._translucentRenderState=void 0,this._mode=void 0,this._ready=!1,this._pointsLength=0,this._geometryByteLength=0,this._vertexShaderLoaded=t.vertexShaderLoaded,this._fragmentShaderLoaded=t.fragmentShaderLoaded,this._uniformMapLoaded=t.uniformMapLoaded,this._batchTableLoaded=t.batchTableLoaded,this._pickIdLoaded=t.pickIdLoaded,this._opaquePass=Object(d["a"])(t.opaquePass,D["a"].OPAQUE),this._cull=Object(d["a"])(t.cull,!0),this.style=void 0,this._style=void 0,this.styleDirty=!1,this.modelMatrix=p["a"].clone(p["a"].IDENTITY),this._modelMatrix=p["a"].clone(p["a"].IDENTITY),this.time=0,this.shadows=R["a"].ENABLED,this._boundingSphere=void 0,this.clippingPlanes=void 0,this.isClipped=!1,this.clippingPlanesDirty=!1,this.clippingPlanesOriginMatrix=void 0,this.attenuation=!1,this._attenuation=!1,this.geometricError=0,this.geometricErrorScale=1,this.maximumAttenuation=this._pointSize,this.splitDirection=Object(d["a"])(t.splitDirection,z["a"].NONE),this._splittingEnabled=!1,this._resolveReadyPromise=void 0,this._rejectReadyPromise=void 0,this._readyPromise=F(this,t)}function F(t,e){const i=w["a"].parse(e.arrayBuffer,e.byteOffset);if(t._parsedContent=i,t._rtcCenter=i.rtcCenter,t._hasNormals=i.hasNormals,t._hasColors=i.hasColors,t._hasBatchIds=i.hasBatchIds,t._isTranslucent=i.isTranslucent,!i.hasBatchIds&&Object(h["a"])(i.batchTableBinary)&&(i.styleableProperties=v["a"].getBinaryProperties(i.pointsLength,i.batchTableJson,i.batchTableBinary)),Object(h["a"])(i.draco)){const e=i.draco;t._decodingState=V.NEEDS_DECODE,e.dequantizeInShader=t._dequantizeInShader}const n=i.positions;Object(h["a"])(n)&&(t._isQuantized=n.isQuantized,t._quantizedVolumeScale=n.quantizedVolumeScale,t._quantizedVolumeOffset=n.quantizedVolumeOffset,t._quantizedRange=n.quantizedRange);const a=i.normals;Object(h["a"])(a)&&(t._isOctEncoded16P=a.octEncoded);const o=i.colors;Object(h["a"])(o)&&(Object(h["a"])(o.constantColor)&&(t._constantColor=r["a"].clone(o.constantColor,t._constantColor),t._hasColors=!1),t._isRGB565=o.isRGB565);const s=i.batchIds;return Object(h["a"])(i.batchIds)&&(s.name="BATCH_ID",s.semantic="BATCH_ID",s.setIndex=void 0),i.hasBatchIds&&t._batchTableLoaded(i.batchLength,i.batchTableJson,i.batchTableBinary),t._pointsLength=i.pointsLength,new Promise((function(e,i){t._resolveReadyPromise=function(){t._ready=!0,e(t)},t._rejectReadyPromise=i}))}Object.defineProperties(G.prototype,{pointsLength:{get:function(){return this._pointsLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},color:{get:function(){return r["a"].clone(this._highlightColor)},set:function(t){this._highlightColor=r["a"].clone(t,this._highlightColor)}},boundingSphere:{get:function(){if(Object(h["a"])(this._drawCommand))return this._drawCommand.boundingVolume},set:function(t){this._boundingSphere=n["a"].clone(t,this._boundingSphere)}}});const q=new a["a"],k=new a["a"],H=new a["a"];let W,Y;function Q(t){if(!Object(h["a"])(Y)){W=new P.a(0),Y=new Array(t);for(let e=0;e<t;++e)Y[e]=W.random()}return Y}function X(t){const e=20,i=t.length/3,o=Math.min(i,e),s=Q(e),r=Number.MAX_VALUE,c=-Number.MAX_VALUE,l=a["a"].fromElements(r,r,r,q),d=a["a"].fromElements(c,c,c,k);for(let n=0;n<o;++n){const e=Math.floor(s[n]*i),o=a["a"].unpack(t,3*e,H);a["a"].minimumByComponent(l,o,l),a["a"].maximumByComponent(d,o,d)}const h=n["a"].fromCornerPoints(l,d);return h.radius+=_["a"].EPSILON2,h}function Z(t,e){const i=l["a"].fromTypedArray(t);return i===l["a"].INT||i===l["a"].UNSIGNED_INT||i===l["a"].DOUBLE?(Object(m["a"])("Cast pnts property to floats",`Point cloud property "${e}" will be casted to a float array because INT, UNSIGNED_INT, and DOUBLE are not valid WebGL vertex attribute types. Some precision may be lost.`),new Float32Array(t)):t}const J=new o["a"],K=new o["a"],$=new r["a"],tt=0,et=1,it=2,nt=3,at=4,ot=new p["a"],st=new p["a"];function rt(t,e){const i=e.context,o=t._parsedContent,s=t._pointsLength,r=o.positions,c=o.colors,d=o.normals,u=o.batchIds,_=o.styleableProperties,m=Object(h["a"])(_),f=t._isQuantized,y=t._isQuantizedDraco,g=t._isOctEncoded16P,E=t._isOctEncodedDraco,I=t._quantizedRange,P=t._octEncodedRange,v=t._isRGB565,L=t._isTranslucent,B=t._hasColors,x=t._hasNormals,w=t._hasBatchIds;let j,R;const z=[],U={};if(t._styleableShaderAttributes=U,m){let e=at;for(const n in _)if(_.hasOwnProperty(n)){const a=_[n],o=Z(a.typedArray,n);j=a.componentCount,R=l["a"].fromTypedArray(o);const s=O["a"].createVertexBuffer({context:i,typedArray:o,usage:S["a"].STATIC_DRAW});t._geometryByteLength+=s.sizeInBytes;const r={index:e,vertexBuffer:s,componentsPerAttribute:j,componentDatatype:R,normalize:!1,offsetInBytes:0,strideInBytes:0};z.push(r),U[n]={location:e,componentCount:j},++e}}const V=O["a"].createVertexBuffer({context:i,typedArray:r.typedArray,usage:S["a"].STATIC_DRAW});let G,F,q;t._geometryByteLength+=V.sizeInBytes,B&&(G=O["a"].createVertexBuffer({context:i,typedArray:c.typedArray,usage:S["a"].STATIC_DRAW}),t._geometryByteLength+=G.sizeInBytes),x&&(F=O["a"].createVertexBuffer({context:i,typedArray:d.typedArray,usage:S["a"].STATIC_DRAW}),t._geometryByteLength+=F.sizeInBytes),w&&(u.typedArray=Z(u.typedArray,"batchIds"),q=O["a"].createVertexBuffer({context:i,typedArray:u.typedArray,usage:S["a"].STATIC_DRAW}),t._geometryByteLength+=q.sizeInBytes);let k=[];if(R=f?l["a"].UNSIGNED_SHORT:y?I<=255?l["a"].UNSIGNED_BYTE:l["a"].UNSIGNED_SHORT:l["a"].FLOAT,k.push({index:tt,vertexBuffer:V,componentsPerAttribute:3,componentDatatype:R,normalize:!1,offsetInBytes:0,strideInBytes:0}),t._cull&&(t._boundingSphere=f||y?n["a"].fromCornerPoints(a["a"].ZERO,t._quantizedVolumeScale):X(r.typedArray)),B)if(v)k.push({index:et,vertexBuffer:G,componentsPerAttribute:1,componentDatatype:l["a"].UNSIGNED_SHORT,normalize:!1,offsetInBytes:0,strideInBytes:0});else{const t=L?4:3;k.push({index:et,vertexBuffer:G,componentsPerAttribute:t,componentDatatype:l["a"].UNSIGNED_BYTE,normalize:!0,offsetInBytes:0,strideInBytes:0})}x&&(g?(j=2,R=l["a"].UNSIGNED_BYTE):E?(j=2,R=P<=255?l["a"].UNSIGNED_BYTE:l["a"].UNSIGNED_SHORT):(j=3,R=l["a"].FLOAT),k.push({index:it,vertexBuffer:F,componentsPerAttribute:j,componentDatatype:R,normalize:!1,offsetInBytes:0,strideInBytes:0})),w&&k.push({index:nt,vertexBuffer:q,componentsPerAttribute:1,componentDatatype:l["a"].fromTypedArray(u.typedArray),normalize:!1,offsetInBytes:0,strideInBytes:0}),m&&(k=k.concat(z));const H=new A["a"]({context:i,attributes:k}),W={depthTest:{enabled:!0}},Y={depthTest:{enabled:!0},depthMask:!1,blending:N["a"].ALPHA_BLEND};t._opaquePass===D["a"].CESIUM_3D_TILE&&(W.stencilTest=M["a"].setCesium3DTileBit(),W.stencilMask=M["a"].CESIUM_3D_TILE_MASK,Y.stencilTest=M["a"].setCesium3DTileBit(),Y.stencilMask=M["a"].CESIUM_3D_TILE_MASK),t._opaqueRenderState=C["a"].fromCache(W),t._translucentRenderState=C["a"].fromCache(Y),t._drawCommand=new T["a"]({boundingVolume:new n["a"],cull:t._cull,modelMatrix:new p["a"],primitiveType:b["a"].POINTS,vertexArray:H,count:s,shaderProgram:void 0,uniformMap:void 0,renderState:L?t._translucentRenderState:t._opaqueRenderState,pass:L?D["a"].TRANSLUCENT:t._opaquePass,owner:t,castShadows:!1,receiveShadows:!1,pickId:t._pickIdLoaded()})}function ct(t,e){const i=e.context,n=t._isQuantized,o=t._isQuantizedDraco,s=t._isOctEncodedDraco;let l={u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier:function(){const n=J;if(n.x=t._attenuation?t.maximumAttenuation:t._pointSize,n.x*=e.pixelRatio,n.y=t.time,t._attenuation){const a=e.camera.frustum;let o;o=e.mode===j["a"].SCENE2D||a instanceof f["a"]?Number.POSITIVE_INFINITY:i.drawingBufferHeight/e.camera.frustum.sseDenominator,n.z=t.geometricError*t.geometricErrorScale,n.w=o}return n},u_highlightColor:function(){return t._highlightColor},u_constantColor:function(){return t._constantColor},u_clippingPlanes:function(){const e=t.clippingPlanes,n=t.isClipped;return n?e.texture:i.defaultTexture},u_clippingPlanesEdgeStyle:function(){const e=t.clippingPlanes;if(!Object(h["a"])(e))return r["a"].TRANSPARENT;const i=r["a"].clone(e.edgeColor,$);return i.alpha=e.edgeWidth,i},u_clippingPlanesMatrix:function(){const e=t.clippingPlanes;if(!Object(h["a"])(e))return p["a"].IDENTITY;const n=Object(d["a"])(t.clippingPlanesOriginMatrix,t._modelMatrix);p["a"].multiply(i.uniformState.view3D,n,ot);const a=p["a"].multiply(ot,e.modelMatrix,ot);return p["a"].inverseTranspose(a,st)}};U["a"].addUniforms(t,l),(n||o||s)&&(l=Object(c["a"])(l,{u_quantizedVolumeScaleAndOctEncodedRange:function(){const e=K;if(Object(h["a"])(t._quantizedVolumeScale)){const i=a["a"].clone(t._quantizedVolumeScale,e);a["a"].divideByScalar(i,t._quantizedRange,e)}return e.w=t._octEncodedRange,e}})),Object(h["a"])(t._uniformMapLoaded)&&(l=t._uniformMapLoaded(l)),t._drawCommand.uniformMap=l}function lt(t,e){const i=/czm_3dtiles_property_(\d+)/g;let n=i.exec(t);while(null!==n){const a=parseInt(n[1]);-1===e.indexOf(a)&&e.push(a),n=i.exec(t)}}function dt(t,e){t=t.slice(t.indexOf("\n"));const i=/czm_3dtiles_builtin_property_(\w+)/g;let n=i.exec(t);while(null!==n){const a=n[1];-1===e.indexOf(a)&&e.push(a),n=i.exec(t)}}function ht(t,e){const i=t.numberOfAttributes;for(let n=0;n<i;++n){const i=t.getAttribute(n);if(i.index===e)return i}}const ut={POSITION:"czm_3dtiles_builtin_property_POSITION",POSITION_ABSOLUTE:"czm_3dtiles_builtin_property_POSITION_ABSOLUTE",COLOR:"czm_3dtiles_builtin_property_COLOR",NORMAL:"czm_3dtiles_builtin_property_NORMAL"};function _t(t,e,i){let n,a,o;const r=e.context,c=Object(h["a"])(i),l=t._isQuantized,d=t._isQuantizedDraco,u=t._isOctEncoded16P,_=t._isOctEncodedDraco,p=t._isRGB565,m=t._isTranslucent,f=t._hasColors,b=t._hasNormals,g=t._hasBatchIds,O=t._backFaceCulling,S=t._normalShading,T=t._drawCommand.vertexArray,D=t.clippingPlanes,C=t._attenuation;let A,I,P,N=m;const v=Object(s["a"])(ut),L={},w=t._styleableShaderAttributes;for(a in w)w.hasOwnProperty(a)&&(o=w[a],v[a]="czm_3dtiles_property_"+o.location,L[o.location]=o);if(c){const t={translucent:!1},e="(vec3 czm_3dtiles_builtin_property_POSITION, vec3 czm_3dtiles_builtin_property_POSITION_ABSOLUTE, vec4 czm_3dtiles_builtin_property_COLOR, vec3 czm_3dtiles_builtin_property_NORMAL)";A=i.getColorShaderFunction("getColorFromStyle"+e,v,t),I=i.getShowShaderFunction("getShowFromStyle"+e,v,t),P=i.getPointSizeShaderFunction("getPointSizeFromStyle"+e,v,t),Object(h["a"])(A)&&t.translucent&&(N=!0)}t._styleTranslucent=N;const j=Object(h["a"])(A),R=Object(h["a"])(I),M=Object(h["a"])(P),V=t.isClipped,G=[],F=[];j&&(lt(A,G),dt(A,F)),R&&(lt(I,G),dt(I,F)),M&&(lt(P,G),dt(P,F));const q=F.indexOf("COLOR")>=0,k=F.indexOf("NORMAL")>=0;if(k&&!b)throw new y["a"]("Style references the NORMAL semantic but the point cloud does not have normals");for(a in w)if(w.hasOwnProperty(a)){o=w[a];const t=G.indexOf(o.location)>=0,e=ht(T,o.location);e.enabled=t}const H=f&&(!j||q);if(f){const t=ht(T,et);t.enabled=H}const W=b&&(S||O||k);if(b){const t=ht(T,it);t.enabled=W}const Y={a_position:tt};H&&(Y.a_color=et),W&&(Y.a_normal=it),g&&(Y.a_batchId=nt);let Q="";const X=G.length;for(n=0;n<X;++n){const t=G[n];o=L[t];const e=o.componentCount,i="czm_3dtiles_property_"+t;let a;a=1===e?"float":"vec"+e,Q+=`attribute ${a} ${i}; \n`,Y[i]=o.location}ct(t,e);let Z="attribute vec3 a_position; \nvarying vec4 v_color; \nuniform vec4 u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier; \nuniform vec4 u_constantColor; \nuniform vec4 u_highlightColor; \n";Z+="float u_pointSize; \nfloat tiles3d_tileset_time; \n",C&&(Z+="float u_geometricError; \nfloat u_depthMultiplier; \n"),Z+=Q,H&&(Z+=m?"attribute vec4 a_color; \n":p?"attribute float a_color; \nconst float SHIFT_RIGHT_11 = 1.0 / 2048.0; \nconst float SHIFT_RIGHT_5 = 1.0 / 32.0; \nconst float SHIFT_LEFT_11 = 2048.0; \nconst float SHIFT_LEFT_5 = 32.0; \nconst float NORMALIZE_6 = 1.0 / 64.0; \nconst float NORMALIZE_5 = 1.0 / 32.0; \n":"attribute vec3 a_color; \n"),W&&(Z+=u||_?"attribute vec2 a_normal; \n":"attribute vec3 a_normal; \n"),g&&(Z+="attribute float a_batchId; \n"),(l||d||_)&&(Z+="uniform vec4 u_quantizedVolumeScaleAndOctEncodedRange; \n"),j&&(Z+=A),R&&(Z+=I),M&&(Z+=P),Z+="void main() \n{ \n    u_pointSize = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.x; \n    tiles3d_tileset_time = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.y; \n",C&&(Z+="    u_geometricError = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.z; \n    u_depthMultiplier = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.w; \n"),Z+=H?m?"    vec4 color = a_color; \n":p?"    float compressed = a_color; \n    float r = floor(compressed * SHIFT_RIGHT_11); \n    compressed -= r * SHIFT_LEFT_11; \n    float g = floor(compressed * SHIFT_RIGHT_5); \n    compressed -= g * SHIFT_LEFT_5; \n    float b = compressed; \n    vec3 rgb = vec3(r * NORMALIZE_5, g * NORMALIZE_6, b * NORMALIZE_5); \n    vec4 color = vec4(rgb, 1.0); \n":"    vec4 color = vec4(a_color, 1.0); \n":"    vec4 color = u_constantColor; \n",Z+=l||d?"    vec3 position = a_position * u_quantizedVolumeScaleAndOctEncodedRange.xyz; \n":"    vec3 position = a_position; \n",Z+="    vec3 position_absolute = vec3(czm_model * vec4(position, 1.0)); \n",W?(Z+=u?"    vec3 normal = czm_octDecode(a_normal); \n":_?"    vec3 normal = czm_octDecode(a_normal, u_quantizedVolumeScaleAndOctEncodedRange.w).zxy; \n":"    vec3 normal = a_normal; \n",Z+="    vec3 normalEC = czm_normal * normal; \n"):Z+="    vec3 normal = vec3(1.0); \n",j&&(Z+="    color = getColorFromStyle(position, position_absolute, color, normal); \n"),R&&(Z+="    float show = float(getShowFromStyle(position, position_absolute, color, normal)); \n"),Z+=M?"    gl_PointSize = getPointSizeFromStyle(position, position_absolute, color, normal) * czm_pixelRatio; \n":C?"    vec4 positionEC = czm_modelView * vec4(position, 1.0); \n    float depth = -positionEC.z; \n    gl_PointSize = min((u_geometricError / depth) * u_depthMultiplier, u_pointSize); \n":"    gl_PointSize = u_pointSize; \n",Z+="    color = color * u_highlightColor; \n",W&&S&&(Z+="    float diffuseStrength = czm_getLambertDiffuse(czm_lightDirectionEC, normalEC); \n    diffuseStrength = max(diffuseStrength, 0.4); \n    color.xyz *= diffuseStrength * czm_lightColor; \n"),Z+="    v_color = color; \n    gl_Position = czm_modelViewProjection * vec4(position, 1.0); \n",W&&O&&(Z+="    float visible = step(-normalEC.z, 0.0); \n    gl_Position *= visible; \n    gl_PointSize *= visible; \n"),R&&(Z+="    gl_Position.w *= float(show); \n    gl_PointSize *= float(show); \n"),Z+="} \n";let J="varying vec4 v_color; \n";V&&(J+="uniform highp sampler2D u_clippingPlanes; \nuniform mat4 u_clippingPlanesMatrix; \nuniform vec4 u_clippingPlanesEdgeStyle; \n",J+="\n",J+=Object(x["a"])(D,r),J+="\n"),J+="void main() \n{ \n    gl_FragColor = czm_gammaCorrect(v_color); \n",V&&(J+=Object(B["a"])("u_clippingPlanes","u_clippingPlanesMatrix","u_clippingPlanesEdgeStyle")),J+="} \n",t.splitDirection!==z["a"].NONE&&(J=U["a"].modifyFragmentShader(J)),Object(h["a"])(t._vertexShaderLoaded)&&(Z=t._vertexShaderLoaded(Z)),Object(h["a"])(t._fragmentShaderLoaded)&&(J=t._fragmentShaderLoaded(J));const K=t._drawCommand;Object(h["a"])(K.shaderProgram)&&K.shaderProgram.destroy(),K.shaderProgram=E["a"].fromCache({context:r,vertexShaderSource:Z,fragmentShaderSource:J,attributeLocations:Y});try{K.shaderProgram._bind()}catch($){throw new y["a"]("Error generating style shader: this may be caused by a type mismatch, index out-of-bounds, or other syntax error.")}}function pt(t,e){if(t._decodingState===V.READY)return!1;if(t._decodingState===V.NEEDS_DECODE){const i=t._parsedContent,n=i.draco,o=L["a"].decodePointCloud(n,e);Object(h["a"])(o)&&(t._decodingState=V.DECODING,o.then((function(e){t._decodingState=V.READY;const o=Object(h["a"])(e.POSITION)?e.POSITION.array:void 0,s=Object(h["a"])(e.RGB)?e.RGB.array:void 0,r=Object(h["a"])(e.RGBA)?e.RGBA.array:void 0,c=Object(h["a"])(e.NORMAL)?e.NORMAL.array:void 0,l=Object(h["a"])(e.BATCH_ID)?e.BATCH_ID.array:void 0,u=Object(h["a"])(o)&&Object(h["a"])(e.POSITION.data.quantization),_=Object(h["a"])(c)&&Object(h["a"])(e.NORMAL.data.quantization);if(u){const i=e.POSITION.data.quantization,n=i.range;t._quantizedVolumeScale=a["a"].fromElements(n,n,n),t._quantizedVolumeOffset=a["a"].unpack(i.minValues),t._quantizedRange=(1<<i.quantizationBits)-1,t._isQuantizedDraco=!0}_&&(t._octEncodedRange=(1<<e.NORMAL.data.quantization.quantizationBits)-1,t._isOctEncodedDraco=!0);let p=i.styleableProperties;const m=n.batchTableProperties;for(const t in m)if(m.hasOwnProperty(t)){const i=e[t];Object(h["a"])(p)||(p={}),p[t]={typedArray:i.array,componentCount:i.data.componentsPerAttribute}}Object(h["a"])(o)&&(i.positions={typedArray:o});const f=Object(d["a"])(r,s);Object(h["a"])(f)&&(i.colors={typedArray:f}),Object(h["a"])(c)&&(i.normals={typedArray:c}),Object(h["a"])(l)&&(i.batchIds={typedArray:l}),i.styleableProperties=p})).catch((function(e){t._decodingState=V.FAILED,t._rejectReadyPromise(e)})))}return!0}const mt=new o["a"],ft=new a["a"];G.prototype.update=function(t){const e=t.context,i=pt(this,e);if(i)return;let s=!1,r=!p["a"].equals(this._modelMatrix,this.modelMatrix);if(this._mode!==t.mode&&(this._mode=t.mode,r=!0),Object(h["a"])(this._drawCommand)||(rt(this,t),r=!0,s=!0,this._resolveReadyPromise(),this._parsedContent=void 0),r){p["a"].clone(this.modelMatrix,this._modelMatrix);const e=this._drawCommand.modelMatrix;if(p["a"].clone(this._modelMatrix,e),Object(h["a"])(this._rtcCenter)&&p["a"].multiplyByTranslation(e,this._rtcCenter,e),Object(h["a"])(this._quantizedVolumeOffset)&&p["a"].multiplyByTranslation(e,this._quantizedVolumeOffset,e),t.mode!==j["a"].SCENE3D){const i=t.mapProjection,n=p["a"].getColumn(e,3,mt);o["a"].equals(n,o["a"].UNIT_W)||g["a"].basisTo2D(i,e,e)}const i=this._drawCommand.boundingVolume;if(n["a"].clone(this._boundingSphere,i),this._cull){const t=i.center;p["a"].multiplyByPoint(e,t,t);const n=p["a"].getScale(e,ft);i.radius*=a["a"].maximumComponent(n)}}this.clippingPlanesDirty&&(this.clippingPlanesDirty=!1,s=!0),this._attenuation!==this.attenuation&&(this._attenuation=this.attenuation,s=!0),this.backFaceCulling!==this._backFaceCulling&&(this._backFaceCulling=this.backFaceCulling,s=!0),this.normalShading!==this._normalShading&&(this._normalShading=this.normalShading,s=!0),(this._style!==this.style||this.styleDirty)&&(this._style=this.style,this.styleDirty=!1,s=!0);const c=this.splitDirection!==z["a"].NONE;this._splittingEnabled!==c&&(this._splittingEnabled=c,s=!0),s&&_t(this,t,this._style),this._drawCommand.castShadows=R["a"].castShadows(this.shadows),this._drawCommand.receiveShadows=R["a"].receiveShadows(this.shadows);const l=this._highlightColor.alpha<1||this._constantColor.alpha<1||this._styleTranslucent;this._drawCommand.renderState=l?this._translucentRenderState:this._opaqueRenderState,this._drawCommand.pass=l?D["a"].TRANSLUCENT:this._opaquePass;const d=t.commandList,u=t.passes;(u.render||u.pick)&&d.push(this._drawCommand)},G.prototype.isDestroyed=function(){return!1},G.prototype.destroy=function(){const t=this._drawCommand;return Object(h["a"])(t)&&(t.vertexArray=t.vertexArray&&t.vertexArray.destroy(),t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy()),Object(u["a"])(this)},e["a"]=G},"44bf":function(t,e,i){"use strict";var n=i("cef5"),a=i("bd8d"),o=i("abab"),s=i("535a"),r=i("2f63"),c=i("7d62"),l=i("6cbd"),d=i("93da"),h=i("52f0"),u=i("1b8d"),_=i("daa2"),p=i("8b68"),m=i("b997"),f=i("a894"),b=i("d289"),y=i("6dc0"),g=i("e90c"),O=i("5770"),S=i("9d80"),T=i("609e"),D=i("a48a"),C=i("b7c8"),E=i("141c"),A=i("bdd0"),I=i("a307");const P=A["a"].SHOW_INDEX,N=A["a"].POSITION_INDEX,v=A["a"].COLOR_INDEX,L=A["a"].OUTLINE_COLOR_INDEX,B=A["a"].OUTLINE_WIDTH_INDEX,x=A["a"].PIXEL_SIZE_INDEX,w=A["a"].SCALE_BY_DISTANCE_INDEX,j=A["a"].TRANSLUCENCY_BY_DISTANCE_INDEX,R=A["a"].DISTANCE_DISPLAY_CONDITION_INDEX,z=A["a"].DISABLE_DEPTH_DISTANCE_INDEX,U=A["a"].NUMBER_OF_PROPERTIES,M={positionHighAndSize:0,positionLowAndOutline:1,compressedAttribute0:2,compressedAttribute1:3,scaleByDistance:4,distanceDisplayConditionAndDisableDepth:5};function V(t){t=Object(s["a"])(t,s["a"].EMPTY_OBJECT),this._sp=void 0,this._spTranslucent=void 0,this._rsOpaque=void 0,this._rsTranslucent=void 0,this._vaf=void 0,this._pointPrimitives=[],this._pointPrimitivesToUpdate=[],this._pointPrimitivesToUpdateIndex=0,this._pointPrimitivesRemoved=!1,this._createVertexArray=!1,this._shaderScaleByDistance=!1,this._compiledShaderScaleByDistance=!1,this._shaderTranslucencyByDistance=!1,this._compiledShaderTranslucencyByDistance=!1,this._shaderDistanceDisplayCondition=!1,this._compiledShaderDistanceDisplayCondition=!1,this._shaderDisableDepthDistance=!1,this._compiledShaderDisableDepthDistance=!1,this._propertiesChanged=new Uint32Array(U),this._maxPixelSize=1,this._baseVolume=new n["a"],this._baseVolumeWC=new n["a"],this._baseVolume2D=new n["a"],this._boundingVolume=new n["a"],this._boundingVolumeDirty=!1,this._colorCommands=[],this.show=Object(s["a"])(t.show,!0),this.modelMatrix=h["a"].clone(Object(s["a"])(t.modelMatrix,h["a"].IDENTITY)),this._modelMatrix=h["a"].clone(h["a"].IDENTITY),this.debugShowBoundingVolume=Object(s["a"])(t.debugShowBoundingVolume,!1),this.blendOption=Object(s["a"])(t.blendOption,E["a"].OPAQUE_AND_TRANSLUCENT),this._blendOption=void 0,this._mode=I["a"].SCENE3D,this._maxTotalPointSize=1,this._buffersUsage=[p["a"].STATIC_DRAW,p["a"].STATIC_DRAW,p["a"].STATIC_DRAW,p["a"].STATIC_DRAW,p["a"].STATIC_DRAW,p["a"].STATIC_DRAW,p["a"].STATIC_DRAW,p["a"].STATIC_DRAW,p["a"].STATIC_DRAW];const e=this;this._uniforms={u_maxTotalPointSize:function(){return e._maxTotalPointSize}}}function G(t){const e=t.length;for(let i=0;i<e;++i)t[i]&&t[i]._destroy()}function F(t){if(t._pointPrimitivesRemoved){t._pointPrimitivesRemoved=!1;const e=[],i=t._pointPrimitives,n=i.length;for(let t=0,a=0;t<n;++t){const n=i[t];n&&(n._index=a++,e.push(n))}t._pointPrimitives=e}}function q(t,e,i){return new S["a"](t,[{index:M.positionHighAndSize,componentsPerAttribute:4,componentDatatype:o["a"].FLOAT,usage:i[N]},{index:M.positionLowAndShow,componentsPerAttribute:4,componentDatatype:o["a"].FLOAT,usage:i[N]},{index:M.compressedAttribute0,componentsPerAttribute:4,componentDatatype:o["a"].FLOAT,usage:i[v]},{index:M.compressedAttribute1,componentsPerAttribute:4,componentDatatype:o["a"].FLOAT,usage:i[j]},{index:M.scaleByDistance,componentsPerAttribute:4,componentDatatype:o["a"].FLOAT,usage:i[w]},{index:M.distanceDisplayConditionAndDisableDepth,componentsPerAttribute:3,componentDatatype:o["a"].FLOAT,usage:i[R]}],e)}Object.defineProperties(V.prototype,{length:{get:function(){return F(this),this._pointPrimitives.length}}}),V.prototype.add=function(t){const e=new A["a"](t,this);return e._index=this._pointPrimitives.length,this._pointPrimitives.push(e),this._createVertexArray=!0,e},V.prototype.remove=function(t){return!!this.contains(t)&&(this._pointPrimitives[t._index]=null,this._pointPrimitivesRemoved=!0,this._createVertexArray=!0,t._destroy(),!0)},V.prototype.removeAll=function(){G(this._pointPrimitives),this._pointPrimitives=[],this._pointPrimitivesToUpdate=[],this._pointPrimitivesToUpdateIndex=0,this._pointPrimitivesRemoved=!1,this._createVertexArray=!0},V.prototype._updatePointPrimitive=function(t,e){t._dirty||(this._pointPrimitivesToUpdate[this._pointPrimitivesToUpdateIndex++]=t),++this._propertiesChanged[e]},V.prototype.contains=function(t){return Object(r["a"])(t)&&t._pointPrimitiveCollection===this},V.prototype.get=function(t){return F(this),this._pointPrimitives[t]},V.prototype.computeNewBuffersUsage=function(){const t=this._buffersUsage;let e=!1;const i=this._propertiesChanged;for(let n=0;n<U;++n){const a=0===i[n]?p["a"].STATIC_DRAW:p["a"].STREAM_DRAW;e=e||t[n]!==a,t[n]=a}return e};const k=new l["a"];function H(t,e,i,a){const o=a._index,s=a._getActualPosition();t._mode===I["a"].SCENE3D&&(n["a"].expand(t._baseVolume,s,t._baseVolume),t._boundingVolumeDirty=!0),l["a"].fromCartesian(s,k);const r=a.pixelSize,c=a.outlineWidth;t._maxPixelSize=Math.max(t._maxPixelSize,r+c);const d=i[M.positionHighAndSize],h=k.high;d(o,h.x,h.y,h.z,r);const u=i[M.positionLowAndOutline],_=k.low;u(o,_.x,_.y,_.z,c)}const W=65536,Y=256;function Q(t,e,i,n){const o=n._index,s=n.color,r=n.getPickId(e).color,c=n.outlineColor;let l=a["a"].floatToByte(s.red),d=a["a"].floatToByte(s.green),h=a["a"].floatToByte(s.blue);const u=l*W+d*Y+h;l=a["a"].floatToByte(c.red),d=a["a"].floatToByte(c.green),h=a["a"].floatToByte(c.blue);const _=l*W+d*Y+h;l=a["a"].floatToByte(r.red),d=a["a"].floatToByte(r.green),h=a["a"].floatToByte(r.blue);const p=l*W+d*Y+h,m=a["a"].floatToByte(s.alpha)*W+a["a"].floatToByte(c.alpha)*Y+a["a"].floatToByte(r.alpha),f=i[M.compressedAttribute0];f(o,u,_,p,m)}function X(t,e,i,n){const a=n._index;let o=0,s=1,c=1,l=1;const h=n.translucencyByDistance;Object(r["a"])(h)&&(o=h.near,s=h.nearValue,c=h.far,l=h.farValue,1===s&&1===l||(t._shaderTranslucencyByDistance=!0));let u=n.show&&n.clusterShow;0===n.color.alpha&&0===n.outlineColor.alpha&&(u=!1),s=d["a"].clamp(s,0,1),s=1===s?255:255*s|0;const _=(u?1:0)*Y+s;l=d["a"].clamp(l,0,1),l=1===l?255:255*l|0;const p=l,m=i[M.compressedAttribute1];m(a,_,p,o,c)}function Z(t,e,i,n){const a=n._index,o=i[M.scaleByDistance];let s=0,c=1,l=1,d=1;const h=n.scaleByDistance;Object(r["a"])(h)&&(s=h.near,c=h.nearValue,l=h.far,d=h.farValue,1===c&&1===d||(t._shaderScaleByDistance=!0)),o(a,s,c,l,d)}function J(t,e,i,n){const a=n._index,o=i[M.distanceDisplayConditionAndDisableDepth];let s=0,c=Number.MAX_VALUE;const l=n.distanceDisplayCondition;Object(r["a"])(l)&&(s=l.near,c=l.far,s*=s,c*=c,t._shaderDistanceDisplayCondition=!0);let d=n.disableDepthTestDistance;d*=d,d>0&&(t._shaderDisableDepthDistance=!0,d===Number.POSITIVE_INFINITY&&(d=-1)),o(a,s,c,d)}function K(t,e,i,n){H(t,e,i,n),Q(t,e,i,n),X(t,e,i,n),Z(t,e,i,n),J(t,e,i,n)}function $(t,e,i,a,o,s){let c;a.mode===I["a"].SCENE3D?(c=t._baseVolume,t._boundingVolumeDirty=!0):c=t._baseVolume2D;const l=[];for(let d=0;d<i;++d){const t=e[d],i=t.position,h=A["a"]._computeActualPosition(i,a,o);Object(r["a"])(h)&&(t._setActualPosition(h),s?l.push(h):n["a"].expand(c,h,c))}s&&n["a"].fromPoints(l,c)}function tt(t,e){const i=e.mode,n=t._pointPrimitives,a=t._pointPrimitivesToUpdate,o=t._modelMatrix;t._createVertexArray||t._mode!==i||i!==I["a"].SCENE3D&&!h["a"].equals(o,t.modelMatrix)?(t._mode=i,h["a"].clone(t.modelMatrix,o),t._createVertexArray=!0,i!==I["a"].SCENE3D&&i!==I["a"].SCENE2D&&i!==I["a"].COLUMBUS_VIEW||$(t,n,n.length,e,o,!0)):i===I["a"].MORPHING?$(t,n,n.length,e,o,!0):i!==I["a"].SCENE2D&&i!==I["a"].COLUMBUS_VIEW||$(t,a,t._pointPrimitivesToUpdateIndex,e,o,!1)}function et(t,e,i){const n=e.camera.getPixelSize(i,e.context.drawingBufferWidth,e.context.drawingBufferHeight),a=n*t._maxPixelSize;i.radius+=a}const it=[];V.prototype.update=function(t){if(F(this),!this.show)return;this._maxTotalPointSize=m["a"].maximumAliasedPointSize,tt(this,t);const e=this._pointPrimitives,i=e.length,a=this._pointPrimitivesToUpdate,o=this._pointPrimitivesToUpdateIndex,s=this._propertiesChanged,c=this._createVertexArray;let l;const d=t.context,p=t.passes,S=p.pick;if(c||!S&&this.computeNewBuffersUsage()){this._createVertexArray=!1;for(let t=0;t<U;++t)s[t]=0;if(this._vaf=this._vaf&&this._vaf.destroy(),i>0){this._vaf=q(d,i,this._buffersUsage),l=this._vaf.writers;for(let t=0;t<i;++t){const e=this._pointPrimitives[t];e._dirty=!1,K(this,d,l,e)}this._vaf.commit()}this._pointPrimitivesToUpdateIndex=0}else if(o>0){const t=it;t.length=0,(s[N]||s[B]||s[x])&&t.push(H),(s[v]||s[L])&&t.push(Q),(s[P]||s[j])&&t.push(X),s[w]&&t.push(Z),(s[R]||s[z])&&t.push(J);const e=t.length;if(l=this._vaf.writers,o/i>.1){for(let i=0;i<o;++i){const n=a[i];n._dirty=!1;for(let i=0;i<e;++i)t[i](this,d,l,n)}this._vaf.commit()}else{for(let i=0;i<o;++i){const n=a[i];n._dirty=!1;for(let i=0;i<e;++i)t[i](this,d,l,n);this._vaf.subCommit(n._index,1)}this._vaf.endSubCommits()}this._pointPrimitivesToUpdateIndex=0}if(o>1.5*i&&(a.length=i),!Object(r["a"])(this._vaf)||!Object(r["a"])(this._vaf.va))return;let A;this._boundingVolumeDirty&&(this._boundingVolumeDirty=!1,n["a"].transform(this._baseVolume,this.modelMatrix,this._baseVolumeWC));let V=h["a"].IDENTITY;t.mode===I["a"].SCENE3D?(V=this.modelMatrix,A=n["a"].clone(this._baseVolumeWC,this._boundingVolume)):A=n["a"].clone(this._baseVolume2D,this._boundingVolume),et(this,t,A);const G=this._blendOption!==this.blendOption;let k,W,Y,$,nt,at;this._blendOption=this.blendOption,G&&(this._blendOption===E["a"].OPAQUE||this._blendOption===E["a"].OPAQUE_AND_TRANSLUCENT?this._rsOpaque=y["a"].fromCache({depthTest:{enabled:!0,func:_["a"].LEQUAL},depthMask:!0}):this._rsOpaque=void 0,this._blendOption===E["a"].TRANSLUCENT||this._blendOption===E["a"].OPAQUE_AND_TRANSLUCENT?this._rsTranslucent=y["a"].fromCache({depthTest:{enabled:!0,func:_["a"].LEQUAL},depthMask:!1,blending:C["a"].ALPHA_BLEND}):this._rsTranslucent=void 0),this._shaderDisableDepthDistance=this._shaderDisableDepthDistance||0!==t.minimumDisableDepthTestDistance,(G||this._shaderScaleByDistance&&!this._compiledShaderScaleByDistance||this._shaderTranslucencyByDistance&&!this._compiledShaderTranslucencyByDistance||this._shaderDistanceDisplayCondition&&!this._compiledShaderDistanceDisplayCondition||this._shaderDisableDepthDistance!==this._compiledShaderDisableDepthDistance)&&(k=new O["a"]({sources:[D["a"]]}),this._shaderScaleByDistance&&k.defines.push("EYE_DISTANCE_SCALING"),this._shaderTranslucencyByDistance&&k.defines.push("EYE_DISTANCE_TRANSLUCENCY"),this._shaderDistanceDisplayCondition&&k.defines.push("DISTANCE_DISPLAY_CONDITION"),this._shaderDisableDepthDistance&&k.defines.push("DISABLE_DEPTH_DISTANCE"),this._blendOption===E["a"].OPAQUE_AND_TRANSLUCENT&&(W=new O["a"]({defines:["OPAQUE"],sources:[T["a"]]}),this._sp=g["a"].replaceCache({context:d,shaderProgram:this._sp,vertexShaderSource:k,fragmentShaderSource:W,attributeLocations:M}),W=new O["a"]({defines:["TRANSLUCENT"],sources:[T["a"]]}),this._spTranslucent=g["a"].replaceCache({context:d,shaderProgram:this._spTranslucent,vertexShaderSource:k,fragmentShaderSource:W,attributeLocations:M})),this._blendOption===E["a"].OPAQUE&&(W=new O["a"]({sources:[T["a"]]}),this._sp=g["a"].replaceCache({context:d,shaderProgram:this._sp,vertexShaderSource:k,fragmentShaderSource:W,attributeLocations:M})),this._blendOption===E["a"].TRANSLUCENT&&(W=new O["a"]({sources:[T["a"]]}),this._spTranslucent=g["a"].replaceCache({context:d,shaderProgram:this._spTranslucent,vertexShaderSource:k,fragmentShaderSource:W,attributeLocations:M})),this._compiledShaderScaleByDistance=this._shaderScaleByDistance,this._compiledShaderTranslucencyByDistance=this._shaderTranslucencyByDistance,this._compiledShaderDistanceDisplayCondition=this._shaderDistanceDisplayCondition,this._compiledShaderDisableDepthDistance=this._shaderDisableDepthDistance);const ot=t.commandList;if(p.render||S){const t=this._colorCommands,e=this._blendOption===E["a"].OPAQUE,i=this._blendOption===E["a"].OPAQUE_AND_TRANSLUCENT;Y=this._vaf.va,$=Y.length,t.length=$;const n=i?2*$:$;for(at=0;at<n;++at){const n=e||i&&at%2===0;nt=t[at],Object(r["a"])(nt)||(nt=t[at]=new f["a"]),nt.primitiveType=u["a"].POINTS,nt.pass=n||!i?b["a"].OPAQUE:b["a"].TRANSLUCENT,nt.owner=this;const a=i?Math.floor(at/2):at;nt.boundingVolume=A,nt.modelMatrix=V,nt.shaderProgram=n?this._sp:this._spTranslucent,nt.uniformMap=this._uniforms,nt.vertexArray=Y[a].va,nt.renderState=n?this._rsOpaque:this._rsTranslucent,nt.debugShowBoundingVolume=this.debugShowBoundingVolume,nt.pickId="v_pickColor",ot.push(nt)}}},V.prototype.isDestroyed=function(){return!1},V.prototype.destroy=function(){return this._sp=this._sp&&this._sp.destroy(),this._spTranslucent=this._spTranslucent&&this._spTranslucent.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),this._vaf=this._vaf&&this._vaf.destroy(),G(this._pointPrimitives),Object(c["a"])(this)},e["a"]=V},"7b4a":function(t,e,i){"use strict";var n=i("535a"),a=i("2ab8");function o(t){const e=Object(n["a"])(t,{});this.attenuation=Object(n["a"])(e.attenuation,!1),this.geometricErrorScale=Object(n["a"])(e.geometricErrorScale,1),this.maximumAttenuation=e.maximumAttenuation,this.baseResolution=e.baseResolution,this.eyeDomeLighting=Object(n["a"])(e.eyeDomeLighting,!0),this.eyeDomeLightingStrength=Object(n["a"])(e.eyeDomeLightingStrength,1),this.eyeDomeLightingRadius=Object(n["a"])(e.eyeDomeLightingRadius,1),this.backFaceCulling=Object(n["a"])(e.backFaceCulling,!1),this.normalShading=Object(n["a"])(e.normalShading,!0)}o.isSupported=function(t){return a["a"].isSupported(t.context)},e["a"]=o},a994:function(t,e,i){"use strict";var n=i("bd8d"),a=i("2bb9"),o=i("535a"),s=i("2f63"),r=i("7d62"),c=i("93da"),l=i("d289"),d=i("6596"),h=i("5af0"),u=i("c4a1"),_=i("3443"),p=i("7b4a"),m=i("a307");function f(t,e,i,n,a){this._tileset=t,this._tile=e,this._resource=i,this._metadata=void 0,this._pickId=void 0,this._batchTable=void 0,this._styleDirty=!1,this._features=void 0,this.featurePropertiesDirty=!1,this._group=void 0,this._pointCloud=new _["a"]({arrayBuffer:n,byteOffset:a,cull:!1,opaquePass:l["a"].CESIUM_3D_TILE,vertexShaderLoaded:b(this),fragmentShaderLoaded:y(this),uniformMapLoaded:g(this),batchTableLoaded:O(this),pickIdLoaded:S(this)})}function b(t){return function(e){return Object(s["a"])(t._batchTable)?t._batchTable.getVertexShaderCallback(!1,"a_batchId",void 0)(e):e}}function y(t){return function(e){return Object(s["a"])(t._batchTable)?t._batchTable.getFragmentShaderCallback(!1,void 0,!1)(e):"uniform vec4 czm_pickColor;\n"+e}}function g(t){return function(e){return Object(s["a"])(t._batchTable)?t._batchTable.getUniformMapCallback()(e):Object(a["a"])(e,{czm_pickColor:function(){return t._pickId.color}})}}function O(t){return function(e,i,n){t._batchTable=new d["a"](t,e,i,n)}}function S(t){return function(){return Object(s["a"])(t._batchTable)?t._batchTable.getPickId():"czm_pickColor"}}function T(t){const e=t._tileset.pointCloudShading,i=t._tile.contentBoundingVolume.boundingSphere.volume(),n=c["a"].cbrt(i/t.pointsLength);let a=t._tile.geometricError;return 0===a&&(a=Object(s["a"])(e)&&Object(s["a"])(e.baseResolution)?e.baseResolution:n),a}function D(t){const e=t.featuresLength;if(!Object(s["a"])(t._features)&&e>0){const i=new Array(e);for(let n=0;n<e;++n)i[n]=new h["a"](t,n);t._features=i}}Object.defineProperties(f.prototype,{featuresLength:{get:function(){return Object(s["a"])(this._batchTable)?this._batchTable.featuresLength:0}},pointsLength:{get:function(){return this._pointCloud.pointsLength}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return this._pointCloud.geometryByteLength}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return Object(s["a"])(this._batchTable)?this._batchTable.batchTableByteLength:0}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._pointCloud.readyPromise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},metadata:{get:function(){return this._metadata},set:function(t){this._metadata=t}},batchTable:{get:function(){return this._batchTable}},group:{get:function(){return this._group},set:function(t){this._group=t}}}),f.prototype.hasProperty=function(t,e){return!!Object(s["a"])(this._batchTable)&&this._batchTable.hasProperty(t,e)},f.prototype.getFeature=function(t){if(!Object(s["a"])(this._batchTable))return;this.featuresLength;return D(this),this._features[t]},f.prototype.applyDebugSettings=function(t,e){this._pointCloud.color=t?e:n["a"].WHITE},f.prototype.applyStyle=function(t){Object(s["a"])(this._batchTable)?this._batchTable.applyStyle(t):this._styleDirty=!0};const C=new p["a"];f.prototype.update=function(t,e){const i=this._pointCloud,n=Object(o["a"])(t.pointCloudShading,C),a=this._tile,r=this._batchTable,c=e.mode,l=t.clippingPlanes;let d;Object(s["a"])(this._pickId)||Object(s["a"])(r)||(this._pickId=e.context.createPickId({primitive:t,content:this})),Object(s["a"])(r)&&r.update(t,e),d=Object(s["a"])(a._contentBoundingVolume)?c===m["a"].SCENE3D?a._contentBoundingVolume.boundingSphere:a._contentBoundingVolume2D.boundingSphere:c===m["a"].SCENE3D?a._boundingVolume.boundingSphere:a._boundingVolume2D.boundingSphere;const h=this._styleDirty;this._styleDirty=!1,i.clippingPlanesOriginMatrix=t.clippingPlanesOriginMatrix,i.style=Object(s["a"])(r)?void 0:t.style,i.styleDirty=h,i.modelMatrix=a.computedTransform,i.time=t.timeSinceLoad,i.shadows=t.shadows,i.boundingSphere=d,i.clippingPlanes=l,i.isClipped=Object(s["a"])(l)&&l.enabled&&a._isClipped,i.clippingPlanesDirty=a.clippingPlanesDirty,i.attenuation=n.attenuation,i.backFaceCulling=n.backFaceCulling,i.normalShading=n.normalShading,i.geometricError=T(this),i.geometricErrorScale=n.geometricErrorScale,i.splitDirection=t.splitDirection,Object(s["a"])(n)&&Object(s["a"])(n.maximumAttenuation)?i.maximumAttenuation=n.maximumAttenuation:a.refine===u["a"].ADD?i.maximumAttenuation=5:i.maximumAttenuation=t.maximumScreenSpaceError,i.update(e)},f.prototype.isDestroyed=function(){return!1},f.prototype.destroy=function(){return this._pickId=this._pickId&&this._pickId.destroy(),this._pointCloud=this._pointCloud&&this._pointCloud.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),Object(r["a"])(this)},e["a"]=f},b005:function(t,e,i){"use strict";var n=i("be18"),a=i("bd8d"),o=i("2bb9"),s=i("abab"),r=i("535a"),c=i("2f63"),l=i("e856"),d=i("283e"),h=i("1da3"),u=i("9889"),_=i("a141");const p={},m=Uint32Array.BYTES_PER_ELEMENT;function f(t,e){const i=t.json;let n,a,s;const r=Object(c["a"])(i.extensions)?i.extensions["3DTILES_draco_point_compression"]:void 0,l=Object(c["a"])(e)&&Object(c["a"])(e.extensions)?e.extensions["3DTILES_draco_point_compression"]:void 0;let h,u,_,p,m,f;if(Object(c["a"])(l)&&(s=l.properties),Object(c["a"])(r)){a=r.properties;const e=r.byteOffset,i=r.byteLength;if(!Object(c["a"])(a)||!Object(c["a"])(e)||!Object(c["a"])(i))throw new d["a"]("Draco properties, byteOffset, and byteLength must be defined");n=t.buffer.slice(e,e+i),h=Object(c["a"])(a.POSITION),u=Object(c["a"])(a.RGB)||Object(c["a"])(a.RGBA),_=Object(c["a"])(a.NORMAL),p=Object(c["a"])(a.BATCH_ID),m=Object(c["a"])(a.RGBA)}return Object(c["a"])(n)&&(f={buffer:n,featureTableProperties:a,batchTableProperties:s,properties:Object(o["a"])(a,s),dequantizeInShader:!0}),{draco:f,hasPositions:h,hasColors:u,isTranslucent:m,hasNormals:_,hasBatchIds:p}}function b(t){const e=t.json;let i;if(Object(c["a"])(e.POSITION))return i=t.getPropertyArray("POSITION",s["a"].FLOAT,3),{name:_["a"].POSITION,semantic:_["a"].POSITION,typedArray:i,isQuantized:!1,componentDatatype:s["a"].FLOAT,type:h["a"].VEC3};if(Object(c["a"])(e.POSITION_QUANTIZED)){i=t.getPropertyArray("POSITION_QUANTIZED",s["a"].UNSIGNED_SHORT,3);const e=t.getGlobalProperty("QUANTIZED_VOLUME_SCALE",s["a"].FLOAT,3);if(!Object(c["a"])(e))throw new d["a"]("Global property: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");const a=65535,o=t.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",s["a"].FLOAT,3);if(!Object(c["a"])(o))throw new d["a"]("Global property: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");return{name:_["a"].POSITION,semantic:_["a"].POSITION,typedArray:i,isQuantized:!0,componentDatatype:s["a"].FLOAT,type:h["a"].VEC3,quantizedRange:a,quantizedVolumeOffset:n["a"].unpack(o),quantizedVolumeScale:n["a"].unpack(e),quantizedComponentDatatype:s["a"].UNSIGNED_SHORT,quantizedType:h["a"].VEC3}}}function y(t){const e=t.json;let i;if(Object(c["a"])(e.RGBA))return i=t.getPropertyArray("RGBA",s["a"].UNSIGNED_BYTE,4),{name:_["a"].COLOR,semantic:_["a"].COLOR,setIndex:0,typedArray:i,componentDatatype:s["a"].UNSIGNED_BYTE,type:h["a"].VEC4,normalized:!0,isRGB565:!1,isTranslucent:!0};if(Object(c["a"])(e.RGB))return i=t.getPropertyArray("RGB",s["a"].UNSIGNED_BYTE,3),{name:"COLOR",semantic:_["a"].COLOR,setIndex:0,typedArray:i,componentDatatype:s["a"].UNSIGNED_BYTE,type:h["a"].VEC3,normalized:!0,isRGB565:!1,isTranslucent:!1};if(Object(c["a"])(e.RGB565))return i=t.getPropertyArray("RGB565",s["a"].UNSIGNED_SHORT,1),{name:"COLOR",semantic:_["a"].COLOR,setIndex:0,typedArray:i,componentDatatype:s["a"].FLOAT,type:h["a"].VEC3,normalized:!1,isRGB565:!0,isTranslucent:!1};if(Object(c["a"])(e.CONSTANT_RGBA)){const e=t.getGlobalProperty("CONSTANT_RGBA",s["a"].UNSIGNED_BYTE,4),i=e[3],n=a["a"].fromBytes(e[0],e[1],e[2],i),o=i<255;return{name:_["a"].COLOR,semantic:_["a"].COLOR,setIndex:0,constantColor:n,componentDatatype:s["a"].FLOAT,type:h["a"].VEC4,isQuantized:!1,isTranslucent:o}}}function g(t){const e=t.json;let i;if(Object(c["a"])(e.NORMAL))return i=t.getPropertyArray("NORMAL",s["a"].FLOAT,3),{name:_["a"].NORMAL,semantic:_["a"].NORMAL,typedArray:i,octEncoded:!1,octEncodedZXY:!1,componentDatatype:s["a"].FLOAT,type:h["a"].VEC3};if(Object(c["a"])(e.NORMAL_OCT16P)){i=t.getPropertyArray("NORMAL_OCT16P",s["a"].UNSIGNED_BYTE,2);const e=8;return{name:_["a"].NORMAL,semantic:_["a"].NORMAL,typedArray:i,octEncoded:!0,octEncodedZXY:!1,quantizedRange:(1<<e)-1,quantizedType:h["a"].VEC2,quantizedComponentDatatype:s["a"].UNSIGNED_BYTE,componentDatatype:s["a"].FLOAT,type:h["a"].VEC3}}}function O(t){const e=t.json;if(Object(c["a"])(e.BATCH_ID)){const e=t.getPropertyArray("BATCH_ID",s["a"].UNSIGNED_SHORT,1);return{name:_["a"].FEATURE_ID,semantic:_["a"].FEATURE_ID,setIndex:0,typedArray:e,componentDatatype:s["a"].fromTypedArray(e),type:h["a"].SCALAR}}}p.parse=function(t,e){e=Object(r["a"])(e,0);const i=new Uint8Array(t),a=new DataView(t);e+=m;const o=a.getUint32(e,!0);if(1!==o)throw new d["a"](`Only Point Cloud tile version 1 is supported.  Version ${o} is not.`);e+=m,e+=m;const h=a.getUint32(e,!0);if(0===h)throw new d["a"]("Feature table must have a byte length greater than zero");e+=m;const _=a.getUint32(e,!0);e+=m;const p=a.getUint32(e,!0);e+=m;const S=a.getUint32(e,!0);e+=m;const T=Object(l["a"])(i,e,h);e+=h;const D=new Uint8Array(t,e,_);let C,E;e+=_,p>0&&(C=Object(l["a"])(i,e,p),e+=p,S>0&&(E=new Uint8Array(t,e,S),e+=S));const A=new u["a"](T,D),I=A.getGlobalProperty("POINTS_LENGTH");if(A.featuresLength=I,!Object(c["a"])(I))throw new d["a"]("Feature table global property: POINTS_LENGTH must be defined");let P=A.getGlobalProperty("RTC_CENTER",s["a"].FLOAT,3);Object(c["a"])(P)&&(P=n["a"].unpack(P));const N=f(A,C);if(N.rtcCenter=P,N.pointsLength=I,!N.hasPositions){const t=b(A);N.positions=t,N.hasPositions=N.hasPositions||Object(c["a"])(t)}if(!N.hasPositions)throw new d["a"]("Either POSITION or POSITION_QUANTIZED must be defined.");if(!N.hasNormals){const t=g(A);N.normals=t,N.hasNormals=N.hasNormals||Object(c["a"])(t)}if(!N.hasColors){const t=y(A);N.colors=t,N.hasColors=N.hasColors||Object(c["a"])(t),N.hasConstantColor=Object(c["a"])(N.constantColor),N.isTranslucent=Object(c["a"])(t)&&t.isTranslucent}if(!N.hasBatchIds){const t=O(A);N.batchIds=t,N.hasBatchIds=N.hasBatchIds||Object(c["a"])(t)}if(N.hasBatchIds){const t=A.getGlobalProperty("BATCH_LENGTH");if(!Object(c["a"])(t))throw new d["a"]("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");N.batchLength=t}return Object(c["a"])(E)&&(E=new Uint8Array(E),N.batchTableJson=C,N.batchTableBinary=E),N},e["a"]=p},bdd0:function(t,e,i){"use strict";var n=i("77af"),a=i("670c"),o=i("be18"),s=i("a561"),r=i("bd8d"),c=i("535a"),l=i("2f63"),d=i("aee6"),h=i("52f0"),u=i("6dfc"),_=i("a307"),p=i("0c80");function m(t,e){t=Object(c["a"])(t,c["a"].EMPTY_OBJECT);let i=t.translucencyByDistance,n=t.scaleByDistance,a=t.distanceDisplayCondition;Object(l["a"])(i)&&(i=u["a"].clone(i)),Object(l["a"])(n)&&(n=u["a"].clone(n)),Object(l["a"])(a)&&(a=d["a"].clone(a)),this._show=Object(c["a"])(t.show,!0),this._position=o["a"].clone(Object(c["a"])(t.position,o["a"].ZERO)),this._actualPosition=o["a"].clone(this._position),this._color=r["a"].clone(Object(c["a"])(t.color,r["a"].WHITE)),this._outlineColor=r["a"].clone(Object(c["a"])(t.outlineColor,r["a"].TRANSPARENT)),this._outlineWidth=Object(c["a"])(t.outlineWidth,0),this._pixelSize=Object(c["a"])(t.pixelSize,10),this._scaleByDistance=n,this._translucencyByDistance=i,this._distanceDisplayCondition=a,this._disableDepthTestDistance=Object(c["a"])(t.disableDepthTestDistance,0),this._id=t.id,this._collection=Object(c["a"])(t.collection,e),this._clusterShow=!0,this._pickId=void 0,this._pointPrimitiveCollection=e,this._dirty=!1,this._index=-1}const f=m.SHOW_INDEX=0,b=m.POSITION_INDEX=1,y=m.COLOR_INDEX=2,g=m.OUTLINE_COLOR_INDEX=3,O=m.OUTLINE_WIDTH_INDEX=4,S=m.PIXEL_SIZE_INDEX=5,T=m.SCALE_BY_DISTANCE_INDEX=6,D=m.TRANSLUCENCY_BY_DISTANCE_INDEX=7,C=m.DISTANCE_DISPLAY_CONDITION_INDEX=8,E=m.DISABLE_DEPTH_DISTANCE_INDEX=9;function A(t,e){const i=t._pointPrimitiveCollection;Object(l["a"])(i)&&(i._updatePointPrimitive(t,e),t._dirty=!0)}m.NUMBER_OF_PROPERTIES=10,Object.defineProperties(m.prototype,{show:{get:function(){return this._show},set:function(t){this._show!==t&&(this._show=t,A(this,f))}},position:{get:function(){return this._position},set:function(t){const e=this._position;o["a"].equals(e,t)||(o["a"].clone(t,e),o["a"].clone(t,this._actualPosition),A(this,b))}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(t){const e=this._scaleByDistance;u["a"].equals(e,t)||(this._scaleByDistance=u["a"].clone(t,e),A(this,T))}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(t){const e=this._translucencyByDistance;u["a"].equals(e,t)||(this._translucencyByDistance=u["a"].clone(t,e),A(this,D))}},pixelSize:{get:function(){return this._pixelSize},set:function(t){this._pixelSize!==t&&(this._pixelSize=t,A(this,S))}},color:{get:function(){return this._color},set:function(t){const e=this._color;r["a"].equals(e,t)||(r["a"].clone(t,e),A(this,y))}},outlineColor:{get:function(){return this._outlineColor},set:function(t){const e=this._outlineColor;r["a"].equals(e,t)||(r["a"].clone(t,e),A(this,g))}},outlineWidth:{get:function(){return this._outlineWidth},set:function(t){this._outlineWidth!==t&&(this._outlineWidth=t,A(this,O))}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(t){d["a"].equals(this._distanceDisplayCondition,t)||(this._distanceDisplayCondition=d["a"].clone(t,this._distanceDisplayCondition),A(this,C))}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(t){this._disableDepthTestDistance!==t&&(this._disableDepthTestDistance=t,A(this,E))}},id:{get:function(){return this._id},set:function(t){this._id=t,Object(l["a"])(this._pickId)&&(this._pickId.object.id=t)}},pickId:{get:function(){return this._pickId}},clusterShow:{get:function(){return this._clusterShow},set:function(t){this._clusterShow!==t&&(this._clusterShow=t,A(this,f))}}}),m.prototype.getPickId=function(t){return Object(l["a"])(this._pickId)||(this._pickId=t.createPickId({primitive:this,collection:this._collection,id:this._id})),this._pickId},m.prototype._getActualPosition=function(){return this._actualPosition},m.prototype._setActualPosition=function(t){o["a"].clone(t,this._actualPosition),A(this,b)};const I=new s["a"];m._computeActualPosition=function(t,e,i){return e.mode===_["a"].SCENE3D?t:(h["a"].multiplyByPoint(i,t,I),p["a"].computeActualWgs84Position(e,I))};const P=new s["a"];m._computeScreenSpacePosition=function(t,e,i,n){const a=h["a"].multiplyByVector(t,s["a"].fromElements(e.x,e.y,e.z,1,P),P),o=p["a"].wgs84ToWindowCoordinates(i,a,n);return o},m.prototype.computeScreenSpacePosition=function(t,e){const i=this._pointPrimitiveCollection;Object(l["a"])(e)||(e=new a["a"]);const n=i.modelMatrix,o=m._computeScreenSpacePosition(n,this._actualPosition,t,e);if(Object(l["a"])(o))return o.y=t.canvas.clientHeight-o.y,o},m.getScreenSpaceBoundingBox=function(t,e,i){const a=t.pixelSize,o=.5*a,s=e.x-o,r=e.y-o,c=a,d=a;return Object(l["a"])(i)||(i=new n["a"]),i.x=s,i.y=r,i.width=c,i.height=d,i},m.prototype.equals=function(t){return this===t||Object(l["a"])(t)&&this._id===t._id&&o["a"].equals(this._position,t._position)&&r["a"].equals(this._color,t._color)&&this._pixelSize===t._pixelSize&&this._outlineWidth===t._outlineWidth&&this._show===t._show&&r["a"].equals(this._outlineColor,t._outlineColor)&&u["a"].equals(this._scaleByDistance,t._scaleByDistance)&&u["a"].equals(this._translucencyByDistance,t._translucencyByDistance)&&d["a"].equals(this._distanceDisplayCondition,t._distanceDisplayCondition)&&this._disableDepthTestDistance===t._disableDepthTestDistance},m.prototype._destroy=function(){this._pickId=this._pickId&&this._pickId.destroy(),this._pointPrimitiveCollection=void 0},e["a"]=m}}]);