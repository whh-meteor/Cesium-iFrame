(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Cesium~f31eb030"],{"0d09":function(e,t,n){"use strict";const o={NEAREST:0,LINEAR:1};t["a"]=o},"18a0":function(e,t,n){"use strict";var o=n("bd8d"),i=n("2f63"),s=n("7d62"),a=n("93da"),r=n("f845"),c=n("f630");function u(e){this._collection=e,this._framebuffers=[],this._stageNameToFramebuffer={},this._width=void 0,this._height=void 0,this._updateDependencies=!1}function l(e){while(Object(i["a"])(e.length))e=e.get(e.length-1);return e.name}function h(e,t,n,o,s){if(!o.enabled||!o._isSupported(t))return s;const a=n[o.name]={};if(Object(i["a"])(s)){const t=e.getStageByName(s);a[l(t)]=!0}const r=o.uniforms;if(Object(i["a"])(r)){const t=Object.getOwnPropertyNames(r),n=t.length;for(let o=0;o<n;++o){const n=r[t[o]];if("string"===typeof n){const t=e.getStageByName(n);Object(i["a"])(t)&&(a[l(t)]=!0)}}}return o.name}function d(e,t,n,o,s){if(Object(i["a"])(o.enabled)&&!o.enabled||Object(i["a"])(o._isSupported)&&!o._isSupported(t))return s;const a=s,r=!Object(i["a"])(o.inputPreviousStageTexture)||o.inputPreviousStageTexture;let c=s;const u=o.length;for(let l=0;l<u;++l){const a=o.get(l);c=Object(i["a"])(a.length)?d(e,t,n,a,s):h(e,t,n,a,s),r&&(s=c)}let f,_;if(r)for(f=1;f<u;++f)_=l(o.get(f)),Object(i["a"])(n[_])||(n[_]={}),n[_][a]=!0;else for(f=1;f<u;++f){_=l(o.get(f));const e=n[_];for(let t=0;t<f;++t)e[l(o.get(t))]=!0}return c}function f(e,t){const n={};if(Object(i["a"])(e.ambientOcclusion)){const o=e.ambientOcclusion,i=e.bloom,s=e._tonemapping,a=e.fxaa;let r=d(e,t,n,o,void 0);r=d(e,t,n,i,r),r=h(e,t,n,s,r),r=d(e,t,n,e,r),h(e,t,n,a,r)}else d(e,t,n,e,void 0);return n}function _(e,t,n){const s=e._collection,a=s.getStageByName(t),r=a._textureScale,u=a._forcePowerOfTwo,l=a._pixelFormat,h=a._pixelDatatype,d=a._clearColor;let f,_;const p=e._framebuffers,m=p.length;for(f=0;f<m;++f){if(_=p[f],r!==_.textureScale||u!==_.forcePowerOfTwo||l!==_.pixelFormat||h!==_.pixelDatatype||!o["a"].equals(d,_.clearColor))continue;const e=_.stages,t=e.length;let i=!1;for(let o=0;o<t;++o)if(n[e[o]]){i=!0;break}if(!i)break}return Object(i["a"])(_)&&f<m?(_.stages.push(t),_):(_={textureScale:r,forcePowerOfTwo:u,pixelFormat:l,pixelDatatype:h,clearColor:d,stages:[t],buffer:new c["a"]({pixelFormat:l,pixelDatatype:h}),clear:void 0},p.push(_),_)}function p(e,t){const n=f(e._collection,t);for(const o in n)n.hasOwnProperty(o)&&(e._stageNameToFramebuffer[o]=_(e,o,n[o]))}function m(e){const t=e._framebuffers,n=t.length;for(let o=0;o<n;++o){const e=t[o];e.buffer.destroy()}}function g(e,t){const n=e._width,o=e._height,i=e._framebuffers,s=i.length;for(let c=0;c<s;++c){const e=i[c],s=e.textureScale;let u=Math.ceil(n*s),l=Math.ceil(o*s),h=Math.min(u,l);e.forcePowerOfTwo&&(a["a"].isPowerOfTwo(h)||(h=a["a"].nextPowerOfTwo(h)),u=h,l=h),e.buffer.update(t,u,l),e.clear=new r["a"]({color:e.clearColor,framebuffer:e.buffer.framebuffer})}}u.prototype.updateDependencies=function(){this._updateDependencies=!0},u.prototype.update=function(e){const t=this._collection,n=this._updateDependencies,o=Object(i["a"])(t.ambientOcclusion)&&t.ambientOcclusion.enabled&&t.ambientOcclusion._isSupported(e),s=Object(i["a"])(t.bloom)&&t.bloom.enabled&&t.bloom._isSupported(e),a=Object(i["a"])(t._tonemapping)&&t._tonemapping.enabled&&t._tonemapping._isSupported(e),r=Object(i["a"])(t.fxaa)&&t.fxaa.enabled&&t.fxaa._isSupported(e),c=!Object(i["a"])(t._activeStages)||t._activeStages.length>0||o||s||a||r;if((n||!c&&this._framebuffers.length>0)&&(m(this),this._framebuffers.length=0,this._stageNameToFramebuffer={},this._width=void 0,this._height=void 0),!n&&!c)return;0===this._framebuffers.length&&p(this,e);const u=e.drawingBufferWidth,l=e.drawingBufferHeight,h=this._width!==u||this._height!==l;(n||h)&&(this._width=u,this._height=l,this._updateDependencies=!1,m(this),g(this,e))},u.prototype.clear=function(e){const t=this._framebuffers;for(let n=0;n<t.length;++n)t[n].clear.execute(e)},u.prototype.getStageByName=function(e){return this._collection.getStageByName(e)},u.prototype.getOutputTexture=function(e){return this._collection.getOutputTexture(e)},u.prototype.getFramebuffer=function(e){const t=this._stageNameToFramebuffer[e];if(Object(i["a"])(t))return t.buffer.framebuffer},u.prototype.isDestroyed=function(){return!1},u.prototype.destroy=function(){return m(this),Object(s["a"])(this)},t["a"]=u},"2e78":function(e,t,n){"use strict";var o=n("535a"),i=n("2f63"),s=n("5e57"),a=n("0541"),r=n("7be3"),c=n("b71e"),u=n("e187"),l=n("5cb0"),h=n("aea3");let d=`${c["a"]}\n${r["a"]}`;const f=u["a"];function _(e){e=Object(o["a"])(e,o["a"].EMPTY_OBJECT);const t=Object(o["a"])(e.translucent,!0),n=!1,s=_.VERTEX_FORMAT;this.material=Object(i["a"])(e.material)?e.material:h["a"].fromType(h["a"].ColorType),this.translucent=t,this._vertexShaderSource=Object(o["a"])(e.vertexShaderSource,d),this._fragmentShaderSource=Object(o["a"])(e.fragmentShaderSource,f),this._renderState=l["a"].getDefaultRenderState(t,n,e.renderState),this._closed=n,this._vertexFormat=s}s["a"].isInternetExplorer()||(d="#define CLIP_POLYLINE \n"+d),Object.defineProperties(_.prototype,{vertexShaderSource:{get:function(){let e=this._vertexShaderSource;return-1!==this.material.shaderSource.search(/varying\s+float\s+v_polylineAngle;/g)&&(e="#define POLYLINE_DASH\n"+e),e}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}}}),_.VERTEX_FORMAT=a["a"].POSITION_AND_ST,_.prototype.getFragmentShaderSource=l["a"].prototype.getFragmentShaderSource,_.prototype.isTranslucent=l["a"].prototype.isTranslucent,_.prototype.getRenderState=l["a"].prototype.getRenderState,t["a"]=_},4082:function(e,t,n){"use strict";var o=n("cef5"),i=n("670c"),s=n("be18"),a=n("a561"),r=n("bef8"),c=n("bd8d"),u=n("2bb9"),l=n("abab"),h=n("535a"),d=n("2f63"),f=n("7d62"),_=n("6cbd"),p=n("5e57"),m=n("0123"),g=n("66bf"),b=n("93da"),y=n("52f0"),S=n("188e"),x=n("283e"),T=n("f20a"),O=n("8b68"),w=n("b997"),E=n("a894"),D=n("d289"),v=n("6dc0"),I=n("e90c"),P=n("5770"),C=n("a913"),A=n("7c5e"),j=n("b71e"),B=n("e187"),N=n("bfb2"),L=n("2cc3"),R=n("b7c8"),M=n("aea3"),F=n("ee1e"),U=n("aee6"),z=n("31af");function V(e,t){e=Object(h["a"])(e,h["a"].EMPTY_OBJECT),this._show=Object(h["a"])(e.show,!0),this._width=Object(h["a"])(e.width,1),this._loop=Object(h["a"])(e.loop,!1),this._distanceDisplayCondition=e.distanceDisplayCondition,this._material=e.material,Object(d["a"])(this._material)||(this._material=M["a"].fromType(M["a"].ColorType,{color:new c["a"](1,1,1,1)}));let n,i=e.positions;Object(d["a"])(i)||(i=[]),this._positions=i,this._actualPositions=Object(F["a"])(i,s["a"].equalsEpsilon),this._loop&&this._actualPositions.length>2&&(this._actualPositions===this._positions&&(this._actualPositions=i.slice()),this._actualPositions.push(s["a"].clone(this._actualPositions[0]))),this._length=this._actualPositions.length,this._id=e.id,Object(d["a"])(t)&&(n=y["a"].clone(t.modelMatrix)),this._modelMatrix=n,this._segments=z["a"].wrapLongitude(this._actualPositions,n),this._actualLength=void 0,this._propertiesChanged=new Uint32Array(q),this._polylineCollection=t,this._dirty=!1,this._pickId=void 0,this._boundingVolume=o["a"].fromPoints(this._actualPositions),this._boundingVolumeWC=o["a"].transform(this._boundingVolume,this._modelMatrix),this._boundingVolume2D=new o["a"]}const k=V.POSITION_INDEX=0,H=V.SHOW_INDEX=1,Y=V.WIDTH_INDEX=2,W=V.MATERIAL_INDEX=3,X=V.POSITION_SIZE_INDEX=4,G=V.DISTANCE_DISPLAY_CONDITION=5,q=V.NUMBER_OF_PROPERTIES=6;function $(e,t){++e._propertiesChanged[t];const n=e._polylineCollection;Object(d["a"])(n)&&(n._updatePolyline(e,t),e._dirty=!0)}Object.defineProperties(V.prototype,{show:{get:function(){return this._show},set:function(e){e!==this._show&&(this._show=e,$(this,H))}},positions:{get:function(){return this._positions},set:function(e){let t=Object(F["a"])(e,s["a"].equalsEpsilon);this._loop&&t.length>2&&(t===e&&(t=e.slice()),t.push(s["a"].clone(t[0]))),this._actualPositions.length===t.length&&this._actualPositions.length===this._length||$(this,X),this._positions=e,this._actualPositions=t,this._length=t.length,this._boundingVolume=o["a"].fromPoints(this._actualPositions,this._boundingVolume),this._boundingVolumeWC=o["a"].transform(this._boundingVolume,this._modelMatrix,this._boundingVolumeWC),$(this,k),this.update()}},material:{get:function(){return this._material},set:function(e){this._material!==e&&(this._material=e,$(this,W))}},width:{get:function(){return this._width},set:function(e){const t=this._width;e!==t&&(this._width=e,$(this,Y))}},loop:{get:function(){return this._loop},set:function(e){if(e!==this._loop){let t=this._actualPositions;e?t.length>2&&!s["a"].equals(t[0],t[t.length-1])&&(t.length===this._positions.length&&(this._actualPositions=t=this._positions.slice()),t.push(s["a"].clone(t[0]))):t.length>2&&s["a"].equals(t[0],t[t.length-1])&&(t.length-1===this._positions.length?this._actualPositions=this._positions:t.pop()),this._loop=e,$(this,X)}}},id:{get:function(){return this._id},set:function(e){this._id=e,Object(d["a"])(this._pickId)&&(this._pickId.object.id=e)}},pickId:{get:function(){return this._pickId}},isDestroyed:{get:function(){return!Object(d["a"])(this._polylineCollection)}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){U["a"].equals(e,this._distanceDisplayCondition)||(this._distanceDisplayCondition=U["a"].clone(e,this._distanceDisplayCondition),$(this,G))}}}),V.prototype.update=function(){let e=y["a"].IDENTITY;Object(d["a"])(this._polylineCollection)&&(e=this._polylineCollection.modelMatrix);const t=this._segments.positions.length,n=this._segments.lengths,i=this._propertiesChanged[k]>0||this._propertiesChanged[X]>0;if(y["a"].equals(e,this._modelMatrix)&&!i||(this._segments=z["a"].wrapLongitude(this._actualPositions,e),this._boundingVolumeWC=o["a"].transform(this._boundingVolume,e,this._boundingVolumeWC)),this._modelMatrix=y["a"].clone(e,this._modelMatrix),this._segments.positions.length!==t)$(this,X);else{const e=n.length;for(let t=0;t<e;++t)if(n[t]!==this._segments.lengths[t]){$(this,X);break}}},V.prototype.getPickId=function(e){return Object(d["a"])(this._pickId)||(this._pickId=e.createPickId({primitive:this,collection:this._polylineCollection,id:this._id})),this._pickId},V.prototype._clean=function(){this._dirty=!1;const e=this._propertiesChanged;for(let t=0;t<q-1;++t)e[t]=0},V.prototype._destroy=function(){this._pickId=this._pickId&&this._pickId.destroy(),this._material=this._material&&this._material.destroy(),this._polylineCollection=void 0};var J=V,K=n("a307");const Q=J.SHOW_INDEX,Z=J.WIDTH_INDEX,ee=J.POSITION_INDEX,te=J.MATERIAL_INDEX,ne=J.POSITION_SIZE_INDEX,oe=J.DISTANCE_DISPLAY_CONDITION,ie=J.NUMBER_OF_PROPERTIES,se={texCoordExpandAndBatchIndex:0,position3DHigh:1,position3DLow:2,position2DHigh:3,position2DLow:4,prevPosition3DHigh:5,prevPosition3DLow:6,prevPosition2DHigh:7,prevPosition2DLow:8,nextPosition3DHigh:9,nextPosition3DLow:10,nextPosition2DHigh:11,nextPosition2DLow:12};function ae(e){e=Object(h["a"])(e,h["a"].EMPTY_OBJECT),this.show=Object(h["a"])(e.show,!0),this.modelMatrix=y["a"].clone(Object(h["a"])(e.modelMatrix,y["a"].IDENTITY)),this._modelMatrix=y["a"].clone(y["a"].IDENTITY),this.debugShowBoundingVolume=Object(h["a"])(e.debugShowBoundingVolume,!1),this._opaqueRS=void 0,this._translucentRS=void 0,this._colorCommands=[],this._polylinesUpdated=!1,this._polylinesRemoved=!1,this._createVertexArray=!1,this._propertiesChanged=new Uint32Array(ie),this._polylines=[],this._polylineBuckets={},this._positionBufferUsage={bufferUsage:O["a"].STATIC_DRAW,frameCount:0},this._mode=void 0,this._polylinesToUpdate=[],this._vertexArrays=[],this._positionBuffer=void 0,this._texCoordExpandAndBatchIndexBuffer=void 0,this._batchTable=void 0,this._createBatchTable=!1,this._useHighlightColor=!1,this._highlightColor=c["a"].clone(c["a"].WHITE);const t=this;this._uniformMap={u_highlightColor:function(){return t._highlightColor}}}function re(e,t){Object(d["a"])(e._batchTable)&&e._batchTable.destroy();const n=[{functionName:"batchTable_getWidthAndShow",componentDatatype:l["a"].UNSIGNED_BYTE,componentsPerAttribute:2},{functionName:"batchTable_getPickColor",componentDatatype:l["a"].UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0},{functionName:"batchTable_getCenterHigh",componentDatatype:l["a"].FLOAT,componentsPerAttribute:3},{functionName:"batchTable_getCenterLowAndRadius",componentDatatype:l["a"].FLOAT,componentsPerAttribute:4},{functionName:"batchTable_getDistanceDisplayCondition",componentDatatype:l["a"].FLOAT,componentsPerAttribute:2}];e._batchTable=new L["a"](t,n,e._polylines.length)}Object.defineProperties(ae.prototype,{length:{get:function(){return Te(this),this._polylines.length}}}),ae.prototype.add=function(e){const t=new J(e,this);return t._index=this._polylines.length,this._polylines.push(t),this._createVertexArray=!0,this._createBatchTable=!0,t},ae.prototype.remove=function(e){if(this.contains(e)){if(this._polylinesRemoved=!0,this._createVertexArray=!0,this._createBatchTable=!0,Object(d["a"])(e._bucket)){const t=e._bucket;t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy()}return e._destroy(),!0}return!1},ae.prototype.removeAll=function(){Oe(this),Ee(this),this._polylineBuckets={},this._polylinesRemoved=!1,this._polylines.length=0,this._polylinesToUpdate.length=0,this._createVertexArray=!0},ae.prototype.contains=function(e){return Object(d["a"])(e)&&e._polylineCollection===this},ae.prototype.get=function(e){return Te(this),this._polylines[e]};const ce=new _["a"],ue=new a["a"],le=new i["a"];ae.prototype.update=function(e){if(Te(this),0===this._polylines.length||!this.show)return;xe(this,e);const t=e.context,n=e.mapProjection;let o,s=this._propertiesChanged;if(this._createBatchTable){if(0===w["a"].maximumVertexTextureImageUnits)throw new x["a"]("Vertex texture fetch support is required to render polylines. The maximum number of vertex texture image units must be greater than zero.");re(this,t),this._createBatchTable=!1}if(this._createVertexArray||_e(this))me(this,t,n);else if(this._polylinesUpdated){const r=this._polylinesToUpdate;if(this._mode!==K["a"].SCENE3D){const e=r.length;for(let t=0;t<e;++t)o=r[t],o.update()}if(s[ne]||s[te])me(this,t,n);else{const t=r.length,c=this._polylineBuckets;for(let u=0;u<t;++u){o=r[u],s=o._propertiesChanged;const t=o._bucket;let l=0;for(const e in c)if(c.hasOwnProperty(e)){if(c[e]===t){s[ee]&&t.writeUpdate(l,o,this._positionBuffer,n);break}l+=c[e].lengthOfPositions}if((s[Q]||s[Z])&&this._batchTable.setBatchedAttribute(o._index,0,new i["a"](o._width,o._show)),this._batchTable.attributes.length>2){if(s[ee]||s[ne]){const t=e.mode===K["a"].SCENE2D?o._boundingVolume2D:o._boundingVolumeWC,n=_["a"].fromCartesian(t.center,ce),i=a["a"].fromElements(n.low.x,n.low.y,n.low.z,t.radius,ue);this._batchTable.setBatchedAttribute(o._index,2,n.high),this._batchTable.setBatchedAttribute(o._index,3,i)}if(s[oe]){const e=le;e.x=0,e.y=Number.MAX_VALUE;const t=o.distanceDisplayCondition;Object(d["a"])(t)&&(e.x=t.near,e.y=t.far),this._batchTable.setBatchedAttribute(o._index,4,e)}}o._clean()}}r.length=0,this._polylinesUpdated=!1}s=this._propertiesChanged;for(let i=0;i<ie;++i)s[i]=0;let r=y["a"].IDENTITY;e.mode===K["a"].SCENE3D&&(r=this.modelMatrix);const c=e.passes,u=0!==e.morphTime;if(Object(d["a"])(this._opaqueRS)&&this._opaqueRS.depthTest.enabled===u||(this._opaqueRS=v["a"].fromCache({depthMask:u,depthTest:{enabled:u}})),Object(d["a"])(this._translucentRS)&&this._translucentRS.depthTest.enabled===u||(this._translucentRS=v["a"].fromCache({blending:R["a"].ALPHA_BLEND,depthMask:!u,depthTest:{enabled:u}})),this._batchTable.update(e),c.render||c.pick){const t=this._colorCommands;fe(this,e,t,r)}};const he=new o["a"],de=new o["a"];function fe(e,t,n,i){const s=t.context,a=t.commandList,r=n.length;let c=0,l=!0;const h=e._vertexArrays,f=e.debugShowBoundingVolume,_=e._batchTable,p=_.getUniformMapCallback(),m=h.length;for(let g=0;g<m;++g){const _=h[g],m=_.buckets,b=m.length;for(let h=0;h<b;++h){const g=m[h];let b=g.offset;const y=g.bucket.shaderProgram,S=g.bucket.polylines,x=S.length;let T,O,w,v,I=0;for(let h=0;h<x;++h){const m=S[h],x=ye(m._material);if(x!==T){if(Object(d["a"])(T)&&I>0){const t=O.isTranslucent();c>=r?(w=new E["a"]({owner:e}),n.push(w)):w=n[c],++c,v=Object(u["a"])(p(O._uniforms),e._uniformMap),w.boundingVolume=o["a"].clone(he,w.boundingVolume),w.modelMatrix=i,w.shaderProgram=y,w.vertexArray=_.va,w.renderState=t?e._translucentRS:e._opaqueRS,w.pass=t?D["a"].TRANSLUCENT:D["a"].OPAQUE,w.debugShowBoundingVolume=f,w.pickId="v_pickColor",w.uniformMap=v,w.count=I,w.offset=b,b+=I,I=0,l=!0,a.push(w)}O=m._material,O.update(s),T=x}const P=m._locatorBuckets,C=P.length;for(let e=0;e<C;++e){const t=P[e];t.locator===g&&(I+=t.count)}let A;t.mode===K["a"].SCENE3D?A=m._boundingVolumeWC:t.mode===K["a"].COLUMBUS_VIEW?A=m._boundingVolume2D:t.mode===K["a"].SCENE2D?Object(d["a"])(m._boundingVolume2D)&&(A=o["a"].clone(m._boundingVolume2D,de),A.center.x=0):Object(d["a"])(m._boundingVolumeWC)&&Object(d["a"])(m._boundingVolume2D)&&(A=o["a"].union(m._boundingVolumeWC,m._boundingVolume2D,de)),l?(l=!1,o["a"].clone(A,he)):o["a"].union(A,he,he)}Object(d["a"])(T)&&I>0&&(c>=r?(w=new E["a"]({owner:e}),n.push(w)):w=n[c],++c,v=Object(u["a"])(p(O._uniforms),e._uniformMap),w.boundingVolume=o["a"].clone(he,w.boundingVolume),w.modelMatrix=i,w.shaderProgram=y,w.vertexArray=_.va,w.renderState=O.isTranslucent()?e._translucentRS:e._opaqueRS,w.pass=O.isTranslucent()?D["a"].TRANSLUCENT:D["a"].OPAQUE,w.debugShowBoundingVolume=f,w.pickId="v_pickColor",w.uniformMap=v,w.count=I,w.offset=b,l=!0,a.push(w)),T=void 0}}n.length=c}function _e(e){let t=!1;const n=e._propertiesChanged,o=e._positionBufferUsage;return n[ee]?o.bufferUsage!==O["a"].STREAM_DRAW?(t=!0,o.bufferUsage=O["a"].STREAM_DRAW,o.frameCount=100):o.frameCount=100:o.bufferUsage!==O["a"].STATIC_DRAW&&(0===o.frameCount?(t=!0,o.bufferUsage=O["a"].STATIC_DRAW):o.frameCount--),t}ae.prototype.isDestroyed=function(){return!1},ae.prototype.destroy=function(){return we(this),Oe(this),Ee(this),this._batchTable=this._batchTable&&this._batchTable.destroy(),Object(f["a"])(this)};const pe=[0,0,0];function me(e,t,n){e._createVertexArray=!1,Oe(e),we(e),Se(e);const o=[[]];let i=o[0];const s=e._batchTable,a=e._useHighlightColor,r=[0];let c=0;const u=[[]];let h=0;const f=e._polylineBuckets;let _,p;for(_ in f)f.hasOwnProperty(_)&&(p=f[_],p.updateShader(t,s,a),h+=p.lengthOfPositions);if(h>0){const a=e._mode,g=new Float32Array(6*h*3),y=new Float32Array(4*h);let S,x=0,w=0,E=0;for(_ in f)if(f.hasOwnProperty(_)){p=f[_],p.write(g,y,x,w,E,s,t,n),a===K["a"].MORPHING&&(Object(d["a"])(S)||(S=new Float32Array(6*h*3)),p.writeForMorph(S,x));const e=p.lengthOfPositions;x+=6*e*3,w+=4*e,E+=4*e,c=p.updateIndices(o,r,u,c)}const D=e._positionBufferUsage.bufferUsage,v=O["a"].STATIC_DRAW;let I;e._positionBuffer=T["a"].createVertexBuffer({context:t,typedArray:g,usage:D}),Object(d["a"])(S)&&(I=T["a"].createVertexBuffer({context:t,typedArray:S,usage:D})),e._texCoordExpandAndBatchIndexBuffer=T["a"].createVertexBuffer({context:t,typedArray:y,usage:v});const P=3*Float32Array.BYTES_PER_ELEMENT,C=4*Float32Array.BYTES_PER_ELEMENT;let j=0;const B=o.length;for(let n=0;n<B;++n)if(i=o[n],i.length>0){const o=new Uint16Array(i),s=T["a"].createIndexBuffer({context:t,typedArray:o,usage:O["a"].STATIC_DRAW,indexDatatype:m["a"].UNSIGNED_SHORT});j+=r[n];const c=6*(n*(P*b["a"].SIXTY_FOUR_KILOBYTES)-j*P),h=P+c,d=P+h,f=P+d,_=P+f,p=P+_,g=n*(C*b["a"].SIXTY_FOUR_KILOBYTES)-j*C,y=[{index:se.position3DHigh,componentsPerAttribute:3,componentDatatype:l["a"].FLOAT,offsetInBytes:c,strideInBytes:6*P},{index:se.position3DLow,componentsPerAttribute:3,componentDatatype:l["a"].FLOAT,offsetInBytes:h,strideInBytes:6*P},{index:se.position2DHigh,componentsPerAttribute:3,componentDatatype:l["a"].FLOAT,offsetInBytes:c,strideInBytes:6*P},{index:se.position2DLow,componentsPerAttribute:3,componentDatatype:l["a"].FLOAT,offsetInBytes:h,strideInBytes:6*P},{index:se.prevPosition3DHigh,componentsPerAttribute:3,componentDatatype:l["a"].FLOAT,offsetInBytes:d,strideInBytes:6*P},{index:se.prevPosition3DLow,componentsPerAttribute:3,componentDatatype:l["a"].FLOAT,offsetInBytes:f,strideInBytes:6*P},{index:se.prevPosition2DHigh,componentsPerAttribute:3,componentDatatype:l["a"].FLOAT,offsetInBytes:d,strideInBytes:6*P},{index:se.prevPosition2DLow,componentsPerAttribute:3,componentDatatype:l["a"].FLOAT,offsetInBytes:f,strideInBytes:6*P},{index:se.nextPosition3DHigh,componentsPerAttribute:3,componentDatatype:l["a"].FLOAT,offsetInBytes:_,strideInBytes:6*P},{index:se.nextPosition3DLow,componentsPerAttribute:3,componentDatatype:l["a"].FLOAT,offsetInBytes:p,strideInBytes:6*P},{index:se.nextPosition2DHigh,componentsPerAttribute:3,componentDatatype:l["a"].FLOAT,offsetInBytes:_,strideInBytes:6*P},{index:se.nextPosition2DLow,componentsPerAttribute:3,componentDatatype:l["a"].FLOAT,offsetInBytes:p,strideInBytes:6*P},{index:se.texCoordExpandAndBatchIndex,componentsPerAttribute:4,componentDatatype:l["a"].FLOAT,vertexBuffer:e._texCoordExpandAndBatchIndexBuffer,offsetInBytes:g}];let S,x,w,E;a===K["a"].SCENE3D?(x=e._positionBuffer,S="vertexBuffer",w=pe,E="value"):a===K["a"].SCENE2D||a===K["a"].COLUMBUS_VIEW?(x=pe,S="value",w=e._positionBuffer,E="vertexBuffer"):(x=I,S="vertexBuffer",w=e._positionBuffer,E="vertexBuffer"),y[0][S]=x,y[1][S]=x,y[2][E]=w,y[3][E]=w,y[4][S]=x,y[5][S]=x,y[6][E]=w,y[7][E]=w,y[8][S]=x,y[9][S]=x,y[10][E]=w,y[11][E]=w;const D=new A["a"]({context:t,attributes:y,indexBuffer:s});e._vertexArrays.push({va:D,buckets:u[n]})}}}function ge(e,t){return t instanceof C["a"]?t.id:t}const be=[];function ye(e){const t=M["a"]._uniformList[e.type],n=t.length;be.length=2*n;let o=0;for(let i=0;i<n;++i){const n=t[i];be[o]=n,be[o+1]=e._uniforms[n](),o+=2}return`${e.type}:${JSON.stringify(be,ge)}`}function Se(e){const t=e._mode,n=e._modelMatrix,o=e._polylineBuckets={},i=e._polylines,s=i.length;for(let a=0;a<s;++a){const e=i[a];if(e._actualPositions.length>1){e.update();const i=e.material;let s=o[i.type];Object(d["a"])(s)||(s=o[i.type]=new ve(i,t,n)),s.addPolyline(e)}}}function xe(e,t){const n=t.mode;e._mode===n&&y["a"].equals(e._modelMatrix,e.modelMatrix)||(e._mode=n,e._modelMatrix=y["a"].clone(e.modelMatrix),e._createVertexArray=!0)}function Te(e){if(e._polylinesRemoved){e._polylinesRemoved=!1;const t=[],n=[];let o,i=0;const s=e._polylines.length;for(let a=0;a<s;++a)o=e._polylines[a],o.isDestroyed||(o._index=i++,n.push(o),t.push(o));e._polylines=t,e._polylinesToUpdate=n}}function Oe(e){const t=e._polylines,n=t.length;for(let o=0;o<n;++o)if(!t[o].isDestroyed){const e=t[o]._bucket;Object(d["a"])(e)&&(e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy())}}function we(e){const t=e._vertexArrays.length;for(let n=0;n<t;++n)e._vertexArrays[n].va.destroy();e._vertexArrays.length=0}function Ee(e){const t=e._polylines,n=t.length;for(let o=0;o<n;++o)t[o].isDestroyed||t[o]._destroy()}function De(e,t,n){this.count=e,this.offset=t,this.bucket=n}function ve(e,t,n){this.polylines=[],this.lengthOfPositions=0,this.material=e,this.shaderProgram=void 0,this.mode=t,this.modelMatrix=n}function Ie(e){return s["a"].dot(s["a"].UNIT_X,e._boundingVolume.center)<0||e._boundingVolume.intersectPlane(S["a"].ORIGIN_ZX_PLANE)===g["a"].INTERSECTING}ae.prototype._updatePolyline=function(e,t){this._polylinesUpdated=!0,e._dirty||this._polylinesToUpdate.push(e),++this._propertiesChanged[t]},ve.prototype.addPolyline=function(e){const t=this.polylines;t.push(e),e._actualLength=this.getPolylinePositionsLength(e),this.lengthOfPositions+=e._actualLength,e._bucket=this},ve.prototype.updateShader=function(e,t,n){if(Object(d["a"])(this.shaderProgram))return;const o=["DISTANCE_DISPLAY_CONDITION"];n&&o.push("VECTOR_TILE"),-1!==this.material.shaderSource.search(/varying\s+float\s+v_polylineAngle;/g)&&o.push("POLYLINE_DASH"),p["a"].isInternetExplorer()||o.push("CLIP_POLYLINE");const i=new P["a"]({defines:o,sources:["varying vec4 v_pickColor;\n",this.material.shaderSource,B["a"]]}),s=t.getVertexShaderCallback()(N["a"]),a=new P["a"]({defines:o,sources:[j["a"],s]});this.shaderProgram=I["a"].fromCache({context:e,vertexShaderSource:a,fragmentShaderSource:i,attributeLocations:se})},ve.prototype.getPolylinePositionsLength=function(e){let t;if(this.mode===K["a"].SCENE3D||!Ie(e))return t=e._actualPositions.length,4*t-4;let n=0;const o=e._segments.lengths;t=o.length;for(let i=0;i<t;++i)n+=4*o[i]-4;return n};const Pe=new s["a"],Ce=new s["a"],Ae=new s["a"],je=new s["a"],Be=new a["a"],Ne=new i["a"];ve.prototype.write=function(e,t,n,o,i,r,u,l){const h=this.mode,f=l.ellipsoid.maximumRadius*b["a"].PI,p=this.polylines,m=p.length;for(let g=0;g<m;++g){const o=p[g],m=o.width,b=o.show&&m>0,y=o._index,S=this.getSegments(o,l),x=S.positions,T=S.lengths,O=x.length,w=o.getPickId(u).color;let E,D=0,v=0;for(let a=0;a<O;++a){0===a?o._loop?E=x[O-2]:(E=je,s["a"].subtract(x[0],x[1],E),s["a"].add(x[0],E,E)):E=x[a-1],s["a"].clone(E,Ce),s["a"].clone(x[a],Pe),a===O-1?o._loop?E=x[1]:(E=je,s["a"].subtract(x[O-1],x[O-2],E),s["a"].add(x[O-1],E,E)):E=x[a+1],s["a"].clone(E,Ae);const r=T[D];a===v+r&&(v+=r,++D);const c=a-v===0,u=a===v+T[D]-1;h===K["a"].SCENE2D&&(Ce.z=0,Pe.z=0,Ae.z=0),h!==K["a"].SCENE2D&&h!==K["a"].MORPHING||(c||u)&&f-Math.abs(Pe.x)<1&&((Pe.x<0&&Ce.x>0||Pe.x>0&&Ce.x<0)&&s["a"].clone(Pe,Ce),(Pe.x<0&&Ae.x>0||Pe.x>0&&Ae.x<0)&&s["a"].clone(Pe,Ae));const l=c?2:0,d=u?2:4;for(let o=l;o<d;++o){_["a"].writeElements(Pe,e,n),_["a"].writeElements(Ce,e,n+6),_["a"].writeElements(Ae,e,n+12);const s=o-2<0?-1:1;t[i]=a/(O-1),t[i+1]=o%2*2-1,t[i+2]=s,t[i+3]=y,n+=18,i+=4}}const I=Be;I.x=c["a"].floatToByte(w.red),I.y=c["a"].floatToByte(w.green),I.z=c["a"].floatToByte(w.blue),I.w=c["a"].floatToByte(w.alpha);const P=Ne;P.x=m,P.y=b?1:0;const C=h===K["a"].SCENE2D?o._boundingVolume2D:o._boundingVolumeWC,A=_["a"].fromCartesian(C.center,ce),j=A.high,B=a["a"].fromElements(A.low.x,A.low.y,A.low.z,C.radius,ue),N=le;N.x=0,N.y=Number.MAX_VALUE;const L=o.distanceDisplayCondition;Object(d["a"])(L)&&(N.x=L.near,N.y=L.far),r.setBatchedAttribute(y,0,P),r.setBatchedAttribute(y,1,I),r.attributes.length>2&&(r.setBatchedAttribute(y,2,j),r.setBatchedAttribute(y,3,B),r.setBatchedAttribute(y,4,N))}};const Le=new s["a"],Re=new s["a"],Me=new s["a"],Fe=new s["a"];ve.prototype.writeForMorph=function(e,t){const n=this.modelMatrix,o=this.polylines,i=o.length;for(let a=0;a<i;++a){const i=o[a],r=i._segments.positions,c=i._segments.lengths,u=r.length;let l=0,h=0;for(let o=0;o<u;++o){let a;0===o?i._loop?a=r[u-2]:(a=Fe,s["a"].subtract(r[0],r[1],a),s["a"].add(r[0],a,a)):a=r[o-1],a=y["a"].multiplyByPoint(n,a,Re);const d=y["a"].multiplyByPoint(n,r[o],Le);let f;o===u-1?i._loop?f=r[1]:(f=Fe,s["a"].subtract(r[u-1],r[u-2],f),s["a"].add(r[u-1],f,f)):f=r[o+1],f=y["a"].multiplyByPoint(n,f,Me);const p=c[l];o===h+p&&(h+=p,++l);const m=o-h===0,g=o===h+c[l]-1,b=m?2:0,S=g?2:4;for(let n=b;n<S;++n)_["a"].writeElements(d,e,t),_["a"].writeElements(a,e,t+6),_["a"].writeElements(f,e,t+12),t+=18}}};const Ue=new Array(1);ve.prototype.updateIndices=function(e,t,n,o){let i=n.length-1,s=new De(0,o,this);n[i].push(s);let a=0,r=e[e.length-1],c=0;r.length>0&&(c=r[r.length-1]+1);const u=this.polylines,l=u.length;for(let h=0;h<l;++h){const l=u[h];let d;if(l._locatorBuckets=[],this.mode===K["a"].SCENE3D){d=Ue;const e=l._actualPositions.length;if(!(e>0))continue;d[0]=e}else d=l._segments.lengths;const f=d.length;if(f>0){let u=0;for(let h=0;h<f;++h){const f=d[h]-1;for(let h=0;h<f;++h)c+4>b["a"].SIXTY_FOUR_KILOBYTES&&(l._locatorBuckets.push({locator:s,count:u}),u=0,t.push(4),r=[],e.push(r),c=0,s.count=a,a=0,o=0,s=new De(0,0,this),n[++i]=[s]),r.push(c,c+2,c+1),r.push(c+1,c+2,c+3),u+=6,a+=6,o+=6,c+=4}l._locatorBuckets.push({locator:s,count:u}),c+4>b["a"].SIXTY_FOUR_KILOBYTES&&(t.push(0),r=[],e.push(r),c=0,s.count=a,o=0,a=0,s=new De(0,0,this),n[++i]=[s])}l._clean()}return s.count=a,o},ve.prototype.getPolylineStartIndex=function(e){const t=this.polylines;let n=0;const o=t.length;for(let i=0;i<o;++i){const o=t[i];if(o===e)break;n+=o._actualLength}return n};const ze={positions:void 0,lengths:void 0},Ve=new Array(1),ke=new s["a"],He=new r["a"];let Ye;ve.prototype.getSegments=function(e,t){let n=e._actualPositions;if(this.mode===K["a"].SCENE3D)return Ve[0]=n.length,ze.positions=n,ze.lengths=Ve,ze;Ie(e)&&(n=e._segments.positions);const i=t.ellipsoid,a=[],r=this.modelMatrix,c=n.length;let u,l=ke;for(let o=0;o<c;++o)u=n[o],l=y["a"].multiplyByPoint(r,u,l),a.push(t.project(i.cartesianToCartographic(l,He)));if(a.length>0){e._boundingVolume2D=o["a"].fromPoints(a,e._boundingVolume2D);const t=e._boundingVolume2D.center;e._boundingVolume2D.center=new s["a"](t.z,t.x,t.y)}return ze.positions=a,ze.lengths=e._segments.lengths,ze},ve.prototype.writeUpdate=function(e,t,n,o){const i=this.mode,a=o.ellipsoid.maximumRadius*b["a"].PI;let r=t._actualLength;if(r){e+=this.getPolylineStartIndex(t);let c=Ye;const u=6*r*3;!Object(d["a"])(c)||c.length<u?c=Ye=new Float32Array(u):c.length>u&&(c=new Float32Array(c.buffer,0,u));const l=this.getSegments(t,o),h=l.positions,f=l.lengths;let p,m=0,g=0,b=0;r=h.length;for(let e=0;e<r;++e){0===e?t._loop?p=h[r-2]:(p=je,s["a"].subtract(h[0],h[1],p),s["a"].add(h[0],p,p)):p=h[e-1],s["a"].clone(p,Ce),s["a"].clone(h[e],Pe),e===r-1?t._loop?p=h[1]:(p=je,s["a"].subtract(h[r-1],h[r-2],p),s["a"].add(h[r-1],p,p)):p=h[e+1],s["a"].clone(p,Ae);const n=f[g];e===b+n&&(b+=n,++g);const o=e-b===0,u=e===b+f[g]-1;i===K["a"].SCENE2D&&(Ce.z=0,Pe.z=0,Ae.z=0),i!==K["a"].SCENE2D&&i!==K["a"].MORPHING||(o||u)&&a-Math.abs(Pe.x)<1&&((Pe.x<0&&Ce.x>0||Pe.x>0&&Ce.x<0)&&s["a"].clone(Pe,Ce),(Pe.x<0&&Ae.x>0||Pe.x>0&&Ae.x<0)&&s["a"].clone(Pe,Ae));const l=o?2:0,d=u?2:4;for(let e=l;e<d;++e)_["a"].writeElements(Pe,c,m),_["a"].writeElements(Ce,c,m+6),_["a"].writeElements(Ae,c,m+12),m+=18}n.copyFromArrayView(c,18*Float32Array.BYTES_PER_ELEMENT*e)}};t["a"]=ae},"63ae":function(e,t,n){"use strict";var o=n("535a"),i=n("5e57"),s=n("0541"),a=n("d3f9"),r=n("a0fe"),c=n("b71e"),u=n("5cb0");let l=`${c["a"]}\n${r["a"]}`;const h=a["a"];function d(e){e=Object(o["a"])(e,o["a"].EMPTY_OBJECT);const t=Object(o["a"])(e.translucent,!0),n=!1,i=d.VERTEX_FORMAT;this.material=void 0,this.translucent=t,this._vertexShaderSource=Object(o["a"])(e.vertexShaderSource,l),this._fragmentShaderSource=Object(o["a"])(e.fragmentShaderSource,h),this._renderState=u["a"].getDefaultRenderState(t,n,e.renderState),this._closed=n,this._vertexFormat=i}i["a"].isInternetExplorer()||(l="#define CLIP_POLYLINE \n"+l),Object.defineProperties(d.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}}}),d.VERTEX_FORMAT=s["a"].POSITION_ONLY,d.prototype.getFragmentShaderSource=u["a"].prototype.getFragmentShaderSource,d.prototype.isTranslucent=u["a"].prototype.isTranslucent,d.prototype.getRenderState=u["a"].prototype.getRenderState,t["a"]=d},9249:function(e,t,n){"use strict";var o=n("77af"),i=n("bd8d"),s=n("2bb9"),a=n("71ce"),r=n("535a"),c=n("2f63"),u=n("7d62"),l=n("e42d"),h=n("d4ed"),d=n("00f8"),f=n("6ef5"),_=n("6dc0"),p=n("6c84"),m=n("5770"),g=n("a913"),b=n("3022"),y=n("03f1"),S=n("23b6"),x=n("0d09");function T(e){e=Object(r["a"])(e,r["a"].EMPTY_OBJECT);const t=e.fragmentShader,n=Object(r["a"])(e.textureScale,1),s=Object(r["a"])(e.pixelFormat,l["a"].RGBA);this._fragmentShader=t,this._uniforms=e.uniforms,this._textureScale=n,this._forcePowerOfTwo=Object(r["a"])(e.forcePowerOfTwo,!1),this._sampleMode=Object(r["a"])(e.sampleMode,x["a"].NEAREST),this._pixelFormat=s,this._pixelDatatype=Object(r["a"])(e.pixelDatatype,f["a"].UNSIGNED_BYTE),this._clearColor=Object(r["a"])(e.clearColor,i["a"].BLACK),this._uniformMap=void 0,this._command=void 0,this._colorTexture=void 0,this._depthTexture=void 0,this._idTexture=void 0,this._actualUniforms={},this._dirtyUniforms=[],this._texturesToRelease=[],this._texturesToCreate=[],this._texturePromise=void 0;const u=new d["a"];u.scissorTest={enabled:!0,rectangle:Object(c["a"])(e.scissorRectangle)?o["a"].clone(e.scissorRectangle):new o["a"]},this._passState=u,this._ready=!1;let h=e.name;Object(c["a"])(h)||(h=Object(a["a"])()),this._name=h,this._logDepthChanged=void 0,this._useLogDepth=void 0,this._selectedIdTexture=void 0,this._selected=void 0,this._selectedShadow=void 0,this._parentSelected=void 0,this._parentSelectedShadow=void 0,this._combinedSelected=void 0,this._combinedSelectedShadow=void 0,this._selectedLength=0,this._parentSelectedLength=0,this._selectedDirty=!0,this._textureCache=void 0,this._index=void 0,this.enabled=!0,this._enabled=!0}Object.defineProperties(T.prototype,{ready:{get:function(){return this._ready}},name:{get:function(){return this._name}},fragmentShader:{get:function(){return this._fragmentShader}},uniforms:{get:function(){return this._uniforms}},textureScale:{get:function(){return this._textureScale}},forcePowerOfTwo:{get:function(){return this._forcePowerOfTwo}},sampleMode:{get:function(){return this._sampleMode}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},clearColor:{get:function(){return this._clearColor}},scissorRectangle:{get:function(){return this._passState.scissorTest.rectangle}},outputTexture:{get:function(){if(Object(c["a"])(this._textureCache)){const e=this._textureCache.getFramebuffer(this._name);if(Object(c["a"])(e))return e.getColorTexture(0)}}},selected:{get:function(){return this._selected},set:function(e){this._selected=e}},parentSelected:{get:function(){return this._parentSelected},set:function(e){this._parentSelected=e}}});const O=/uniform\s+sampler2D\s+depthTexture/g;function w(e,t,n){const o=t[n];return("string"===typeof o||o instanceof HTMLCanvasElement||o instanceof HTMLImageElement||o instanceof HTMLVideoElement||o instanceof ImageData)&&e._dirtyUniforms.push(n),{get:function(){return t[n]},set:function(o){const i=t[n];t[n]=o;const s=e._actualUniforms,a=s[n];Object(c["a"])(a)&&a!==i&&a instanceof g["a"]&&!Object(c["a"])(e._textureCache.getStageByName(n))&&(e._texturesToRelease.push(a),delete s[n],delete s[n+"Dimensions"]),i instanceof g["a"]&&e._texturesToRelease.push(i),"string"===typeof o||o instanceof HTMLCanvasElement||o instanceof HTMLImageElement||o instanceof HTMLVideoElement||o instanceof ImageData?e._dirtyUniforms.push(n):s[n]=o}}}function E(e,t){return function(){const n=e._actualUniforms[t];return"function"===typeof n?n():n}}function D(e,t){return function(){const n=e[t]();if(Object(c["a"])(n))return n.dimensions}}function v(e){if(Object(c["a"])(e._uniformMap))return;const t={},n={},o=e._uniforms,i=e._actualUniforms;for(const s in o)if(o.hasOwnProperty(s)){"function"!==typeof o[s]?(t[s]=E(e,s),n[s]=w(e,o,s)):(t[s]=o[s],n[s]=o[s]),i[s]=o[s];const a=t[s]();("string"===typeof a||a instanceof g["a"]||a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement)&&(t[s+"Dimensions"]=D(t,s))}e._uniforms={},Object.defineProperties(e._uniforms,n),e._uniformMap=Object(s["a"])(t,{colorTexture:function(){return e._colorTexture},colorTextureDimensions:function(){return e._colorTexture.dimensions},depthTexture:function(){return e._depthTexture},depthTextureDimensions:function(){return e._depthTexture.dimensions},czm_idTexture:function(){return e._idTexture},czm_selectedIdTexture:function(){return e._selectedIdTexture},czm_selectedIdTextureStep:function(){return 1/e._selectedIdTexture.width}})}function I(e,t){if(Object(c["a"])(e._command)&&!e._logDepthChanged&&!e._selectedDirty)return;let n=e._fragmentShader;if(Object(c["a"])(e._selectedIdTexture)){const t=e._selectedIdTexture.width;n=n.replace(/varying\s+vec2\s+v_textureCoordinates;/g,""),n=`#define CZM_SELECTED_FEATURE \nuniform sampler2D czm_idTexture; \nuniform sampler2D czm_selectedIdTexture; \nuniform float czm_selectedIdTextureStep; \nvarying vec2 v_textureCoordinates; \nbool czm_selected(vec2 offset) \n{ \n    bool selected = false;\n    vec4 id = texture2D(czm_idTexture, v_textureCoordinates + offset); \n    for (int i = 0; i < ${t}; ++i) \n    { \n        vec4 selectedId = texture2D(czm_selectedIdTexture, vec2((float(i) + 0.5) * czm_selectedIdTextureStep, 0.5)); \n        if (all(equal(id, selectedId))) \n        { \n            return true; \n        } \n    } \n    return false; \n} \n\nbool czm_selected() \n{ \n    return czm_selected(vec2(0.0)); \n} \n\n`+n}const o=new m["a"]({defines:[e._useLogDepth?"LOG_DEPTH":""],sources:[n]});e._command=t.createViewportQuadCommand(o,{uniformMap:e._uniformMap,owner:e})}function P(e){const t=e._sampleMode;let n,o;t===x["a"].LINEAR?(n=y["a"].LINEAR,o=b["a"].LINEAR):(n=y["a"].NEAREST,o=b["a"].NEAREST);const i=e._sampler;Object(c["a"])(i)&&i.minificationFilter===n&&i.magnificationFilter===o||(e._sampler=new p["a"]({wrapS:S["a"].CLAMP_TO_EDGE,wrapT:S["a"].CLAMP_TO_EDGE,minificationFilter:n,magnificationFilter:o}))}function C(e,t){return function(n){e._texturesToCreate.push({name:t,source:n})}}function A(e,t){return function(){return e._textureCache.getOutputTexture(t)}}function j(e,t){let n,o,i;const s=e._texturesToRelease;let a=s.length;for(n=0;n<a;++n)o=s[n],o=o&&o.destroy();s.length=0;const r=e._texturesToCreate;for(a=r.length,n=0;n<a;++n){const o=r[n];i=o.name;const s=o.source;e._actualUniforms[i]=new g["a"]({context:t,source:s})}r.length=0;const u=e._dirtyUniforms;if(0===u.length&&!Object(c["a"])(e._texturePromise))return void(e._ready=!0);if(0===u.length||Object(c["a"])(e._texturePromise))return;a=u.length;const l=e._uniforms,d=[];for(n=0;n<a;++n){i=u[n];const t=l[i],o=e._textureCache.getStageByName(t);if(Object(c["a"])(o))e._actualUniforms[i]=A(e,t);else if("string"===typeof t){const n=new h["a"]({url:t});d.push(n.fetchImage().then(C(e,i)))}else e._texturesToCreate.push({name:i,source:t})}u.length=0,d.length>0?(e._ready=!1,e._texturePromise=Promise.all(d).then((function(){e._ready=!0,e._texturePromise=void 0}))):e._ready=!0}function B(e){Object(c["a"])(e._command)&&(e._command.shaderProgram=e._command.shaderProgram&&e._command.shaderProgram.destroy(),e._command=void 0),e._selectedIdTexture=e._selectedIdTexture&&e._selectedIdTexture.destroy();const t=e._textureCache;if(!Object(c["a"])(t))return;const n=e._uniforms,o=e._actualUniforms;for(const i in o)o.hasOwnProperty(i)&&o[i]instanceof g["a"]&&(Object(c["a"])(t.getStageByName(n[i]))||o[i].destroy(),e._dirtyUniforms.push(i))}function N(e){let t=Object(c["a"])(e._selected)?e._selected.length:0;const n=Object(c["a"])(e._parentSelected)?e._parentSelected:0;let o=e._selected!==e._selectedShadow||t!==e._selectedLength;if(o=o||e._parentSelected!==e._parentSelectedShadow||n!==e._parentSelectedLength,Object(c["a"])(e._selected)&&Object(c["a"])(e._parentSelected)?e._combinedSelected=e._selected.concat(e._parentSelected):Object(c["a"])(e._parentSelected)?e._combinedSelected=e._parentSelected:e._combinedSelected=e._selected,!o&&Object(c["a"])(e._combinedSelected)){if(!Object(c["a"])(e._combinedSelectedShadow))return!0;t=e._combinedSelected.length;for(let n=0;n<t;++n)if(e._combinedSelected[n]!==e._combinedSelectedShadow[n])return!0}return o}function L(e,t){if(!e._selectedDirty)return;e._selectedIdTexture=e._selectedIdTexture&&e._selectedIdTexture.destroy(),e._selectedIdTexture=void 0;const n=e._combinedSelected;if(!Object(c["a"])(n))return;let o,s,a=0;const r=n.length;for(o=0;o<r;++o)s=n[o],Object(c["a"])(s.pickIds)?a+=s.pickIds.length:Object(c["a"])(s.pickId)&&++a;if(0===r||0===a){const n=new Uint8Array(4);return n[0]=255,n[1]=255,n[2]=255,n[3]=255,void(e._selectedIdTexture=new g["a"]({context:t,pixelFormat:l["a"].RGBA,pixelDatatype:f["a"].UNSIGNED_BYTE,source:{arrayBufferView:n,width:1,height:1},sampler:p["a"].NEAREST}))}let u,h=0;const d=new Uint8Array(4*a);for(o=0;o<r;++o)if(s=n[o],Object(c["a"])(s.pickIds)){const e=s.pickIds,t=e.length;for(let n=0;n<t;++n)u=e[n].color,d[h]=i["a"].floatToByte(u.red),d[h+1]=i["a"].floatToByte(u.green),d[h+2]=i["a"].floatToByte(u.blue),d[h+3]=i["a"].floatToByte(u.alpha),h+=4}else Object(c["a"])(s.pickId)&&(u=s.pickId.color,d[h]=i["a"].floatToByte(u.red),d[h+1]=i["a"].floatToByte(u.green),d[h+2]=i["a"].floatToByte(u.blue),d[h+3]=i["a"].floatToByte(u.alpha),h+=4);e._selectedIdTexture=new g["a"]({context:t,pixelFormat:l["a"].RGBA,pixelDatatype:f["a"].UNSIGNED_BYTE,source:{arrayBufferView:d,width:a,height:1},sampler:p["a"].NEAREST})}T.prototype._isSupported=function(e){return!O.test(this._fragmentShader)||e.depthTexture},T.prototype.update=function(e,t){if(this.enabled===this._enabled||this.enabled||B(this),this._enabled=this.enabled,!this._enabled)return;if(this._logDepthChanged=t!==this._useLogDepth,this._useLogDepth=t,this._selectedDirty=N(this),this._selectedShadow=this._selected,this._parentSelectedShadow=this._parentSelected,this._combinedSelectedShadow=this._combinedSelected,this._selectedLength=Object(c["a"])(this._selected)?this._selected.length:0,this._parentSelectedLength=Object(c["a"])(this._parentSelected)?this._parentSelected.length:0,L(this,e),v(this),j(this,e),I(this,e),P(this),this._selectedDirty=!1,!this._ready)return;const n=this._textureCache.getFramebuffer(this._name);if(this._command.framebuffer=n,!Object(c["a"])(n))return;const i=n.getColorTexture(0);let s;i.width===e.drawingBufferWidth&&i.height===e.drawingBufferHeight||(s=this._renderState,Object(c["a"])(s)&&i.width===s.viewport.width&&i.height===s.viewport.height||(this._renderState=_["a"].fromCache({viewport:new o["a"](0,0,i.width,i.height)}))),this._command.renderState=s},T.prototype.execute=function(e,t,n,o){if(!Object(c["a"])(this._command)||!Object(c["a"])(this._command.framebuffer)||!this._ready||!this._enabled)return;this._colorTexture=t,this._depthTexture=n,this._idTexture=o,p["a"].equals(this._colorTexture.sampler,this._sampler)||(this._colorTexture.sampler=this._sampler);const i=this.scissorRectangle.width>0&&this.scissorRectangle.height>0?this._passState:void 0;Object(c["a"])(i)&&(i.context=e),this._command.execute(e,i)},T.prototype.isDestroyed=function(){return!1},T.prototype.destroy=function(){return B(this),Object(u["a"])(this)},t["a"]=T},"9e4a":function(e,t,n){"use strict";var o=n("2f63"),i=n("7d62"),s=n("e42d"),a=n("6ef5"),r=n("6c84"),c=n("a913"),u=n("3022"),l=n("03f1"),h=n("23b6"),d=n("3720"),f=n("7229"),_=n("bd8d"),p=n("71ce"),m=n("c52f"),g=n("8c6d"),b=n("2b1f"),y=n("7ae0"),S=n("2d5d"),x=n("2bfd"),T=n("bdad"),O=n("8a4d"),w=n("6768"),E=n("3573"),D=n("7e2c"),v=n("a415"),I=n("1c39"),P=n("ae18"),C=n("f1e5"),A=n("aab0"),j=n("bc38"),B=n("c470"),N=n("6448"),L=n("0721"),R=n("0967"),M=n("9249"),F=n("f724"),U=n("0d09");const z={};function V(e){const t=1,n=2,o=1,i="#define USE_STEP_SIZE\n"+P["a"],s=new M["a"]({name:e+"_x_direction",fragmentShader:i,uniforms:{delta:t,sigma:n,stepSize:o,direction:0},sampleMode:U["a"].LINEAR}),a=new M["a"]({name:e+"_y_direction",fragmentShader:i,uniforms:{delta:t,sigma:n,stepSize:o,direction:1},sampleMode:U["a"].LINEAR}),r={};return Object.defineProperties(r,{delta:{get:function(){return s.uniforms.delta},set:function(e){const t=s.uniforms,n=a.uniforms;t.delta=n.delta=e}},sigma:{get:function(){return s.uniforms.sigma},set:function(e){const t=s.uniforms,n=a.uniforms;t.sigma=n.sigma=e}},stepSize:{get:function(){return s.uniforms.stepSize},set:function(e){const t=s.uniforms,n=a.uniforms;t.stepSize=n.stepSize=e}}}),new F["a"]({name:e,stages:[s,a],uniforms:r})}function k(e){if(!Object(o["a"])(e))return z.createEdgeDetectionStage();const t=new F["a"]({name:"czm_edge_detection_multiple",stages:e,inputPreviousStageTexture:!1}),n={};let i="",s="";for(let o=0;o<e.length;++o)i+=`uniform sampler2D edgeTexture${o}; \n`,s+=`        vec4 edge${o} = texture2D(edgeTexture${o}, v_textureCoordinates); \n        if (edge${o}.a > 0.0) \n        { \n            color = edge${o}; \n            break; \n        } \n`,n["edgeTexture"+o]=e[o].name;const a=i+"varying vec2 v_textureCoordinates; \nvoid main() { \n    vec4 color = vec4(0.0); \n"+`    for (int i = 0; i < ${e.length}; i++) \n`+`    { \n${s}    } \n    gl_FragColor = color; \n} \n`,r=new M["a"]({name:"czm_edge_detection_combine",fragmentShader:a,uniforms:n});return new F["a"]({name:"czm_edge_detection_composite",stages:[t,r]})}z.createBlurStage=function(){return V("czm_blur")},z.createDepthOfFieldStage=function(){const e=V("czm_depth_of_field_blur"),t=new M["a"]({name:"czm_depth_of_field_composite",fragmentShader:w["a"],uniforms:{focalDistance:5,blurTexture:e.name}}),n={};return Object.defineProperties(n,{focalDistance:{get:function(){return t.uniforms.focalDistance},set:function(e){t.uniforms.focalDistance=e}},delta:{get:function(){return e.uniforms.delta},set:function(t){e.uniforms.delta=t}},sigma:{get:function(){return e.uniforms.sigma},set:function(t){e.uniforms.sigma=t}},stepSize:{get:function(){return e.uniforms.stepSize},set:function(t){e.uniforms.stepSize=t}}}),new F["a"]({name:"czm_depth_of_field",stages:[e,t],inputPreviousStageTexture:!1,uniforms:n})},z.isDepthOfFieldSupported=function(e){return e.context.depthTexture},z.createEdgeDetectionStage=function(){const e=Object(p["a"])();return new M["a"]({name:"czm_edge_detection_"+e,fragmentShader:D["a"],uniforms:{length:.25,color:_["a"].clone(_["a"].BLACK)}})},z.isEdgeDetectionSupported=function(e){return e.context.depthTexture},z.createSilhouetteStage=function(e){const t=k(e),n=new M["a"]({name:"czm_silhouette_color_edges",fragmentShader:N["a"],uniforms:{silhouetteTexture:t.name}});return new F["a"]({name:"czm_silhouette",stages:[t,n],inputPreviousStageTexture:!1,uniforms:t.uniforms})},z.isSilhouetteSupported=function(e){return e.context.depthTexture},z.createBloomStage=function(){const e=new M["a"]({name:"czm_bloom_contrast_bias",fragmentShader:O["a"],uniforms:{contrast:128,brightness:-.3}}),t=V("czm_bloom_blur"),n=new F["a"]({name:"czm_bloom_contrast_bias_blur",stages:[e,t]}),o=new M["a"]({name:"czm_bloom_generate_composite",fragmentShader:x["a"],uniforms:{glowOnly:!1,bloomTexture:n.name}}),i={};return Object.defineProperties(i,{glowOnly:{get:function(){return o.uniforms.glowOnly},set:function(e){o.uniforms.glowOnly=e}},contrast:{get:function(){return e.uniforms.contrast},set:function(t){e.uniforms.contrast=t}},brightness:{get:function(){return e.uniforms.brightness},set:function(t){e.uniforms.brightness=t}},delta:{get:function(){return t.uniforms.delta},set:function(e){t.uniforms.delta=e}},sigma:{get:function(){return t.uniforms.sigma},set:function(e){t.uniforms.sigma=e}},stepSize:{get:function(){return t.uniforms.stepSize},set:function(e){t.uniforms.stepSize=e}}}),new F["a"]({name:"czm_bloom",stages:[n,o],inputPreviousStageTexture:!1,uniforms:i})},z.createAmbientOcclusionStage=function(){const e=new M["a"]({name:"czm_ambient_occlusion_generate",fragmentShader:b["a"],uniforms:{intensity:3,bias:.1,lengthCap:.26,stepSize:1.95,frustumLength:1e3,randomTexture:void 0}}),t=V("czm_ambient_occlusion_blur");t.uniforms.stepSize=.86;const n=new F["a"]({name:"czm_ambient_occlusion_generate_blur",stages:[e,t]}),o=new M["a"]({name:"czm_ambient_occlusion_composite",fragmentShader:y["a"],uniforms:{ambientOcclusionOnly:!1,ambientOcclusionTexture:n.name}}),i={};return Object.defineProperties(i,{intensity:{get:function(){return e.uniforms.intensity},set:function(t){e.uniforms.intensity=t}},bias:{get:function(){return e.uniforms.bias},set:function(t){e.uniforms.bias=t}},lengthCap:{get:function(){return e.uniforms.lengthCap},set:function(t){e.uniforms.lengthCap=t}},stepSize:{get:function(){return e.uniforms.stepSize},set:function(t){e.uniforms.stepSize=t}},frustumLength:{get:function(){return e.uniforms.frustumLength},set:function(t){e.uniforms.frustumLength=t}},randomTexture:{get:function(){return e.uniforms.randomTexture},set:function(t){e.uniforms.randomTexture=t}},delta:{get:function(){return t.uniforms.delta},set:function(e){t.uniforms.delta=e}},sigma:{get:function(){return t.uniforms.sigma},set:function(e){t.uniforms.sigma=e}},blurStepSize:{get:function(){return t.uniforms.stepSize},set:function(e){t.uniforms.stepSize=e}},ambientOcclusionOnly:{get:function(){return o.uniforms.ambientOcclusionOnly},set:function(e){o.uniforms.ambientOcclusionOnly=e}}}),new F["a"]({name:"czm_ambient_occlusion",stages:[n,o],inputPreviousStageTexture:!1,uniforms:i})},z.isAmbientOcclusionSupported=function(e){return e.context.depthTexture};const H=`#define FXAA_QUALITY_PRESET 39 \n${L["a"]}\n${I["a"]}`;z.createFXAAStage=function(){return new M["a"]({name:"czm_FXAA",fragmentShader:H,sampleMode:U["a"].LINEAR})},z.createAcesTonemappingStage=function(e){let t=e?"#define AUTO_EXPOSURE\n":"";return t+=g["a"],new M["a"]({name:"czm_aces",fragmentShader:t,uniforms:{autoExposure:void 0}})},z.createFilmicTonemappingStage=function(e){let t=e?"#define AUTO_EXPOSURE\n":"";return t+=v["a"],new M["a"]({name:"czm_filmic",fragmentShader:t,uniforms:{autoExposure:void 0}})},z.createReinhardTonemappingStage=function(e){let t=e?"#define AUTO_EXPOSURE\n":"";return t+=B["a"],new M["a"]({name:"czm_reinhard",fragmentShader:t,uniforms:{autoExposure:void 0}})},z.createModifiedReinhardTonemappingStage=function(e){let t=e?"#define AUTO_EXPOSURE\n":"";return t+=A["a"],new M["a"]({name:"czm_modified_reinhard",fragmentShader:t,uniforms:{white:_["a"].WHITE,autoExposure:void 0}})},z.createAutoExposureStage=function(){return new R["a"]},z.createBlackAndWhiteStage=function(){return new M["a"]({name:"czm_black_and_white",fragmentShader:S["a"],uniforms:{gradations:5}})},z.createBrightnessStage=function(){return new M["a"]({name:"czm_brightness",fragmentShader:T["a"],uniforms:{brightness:.5}})},z.createNightVisionStage=function(){return new M["a"]({name:"czm_night_vision",fragmentShader:j["a"]})},z.createDepthViewStage=function(){return new M["a"]({name:"czm_depth_view",fragmentShader:E["a"]})},z.createLensFlareStage=function(){return new M["a"]({name:"czm_lens_flare",fragmentShader:C["a"],uniforms:{dirtTexture:Object(f["a"])("Assets/Textures/LensFlare/DirtMask.jpg"),starTexture:Object(f["a"])("Assets/Textures/LensFlare/StarBurst.jpg"),intensity:2,distortion:10,ghostDispersal:.4,haloWidth:.4,dirtAmount:.4,earthRadius:m["a"].WGS84.maximumRadius}})};var Y=z,W=n("18a0"),X=n("c3f4");const G=[];function q(){const e=Y.createFXAAStage(),t=Y.createAmbientOcclusionStage(),n=Y.createBloomStage();this._autoExposureEnabled=!1,this._autoExposure=Y.createAutoExposureStage(),this._tonemapping=void 0,this._tonemapper=void 0,this.tonemapper=X["a"].ACES;const i=this._tonemapping;e.enabled=!1,t.enabled=!1,n.enabled=!1,i.enabled=!1;const s=new W["a"](this),a={},r=G;r.push(e,t,n,i);while(r.length>0){const e=r.pop();a[e.name]=e,e._textureCache=s;const t=e.length;if(Object(o["a"])(t))for(let n=0;n<t;++n)r.push(e.get(n))}this._stages=[],this._activeStages=[],this._previousActiveStages=[],this._randomTexture=void 0;const c=this;t.uniforms.randomTexture=function(){return c._randomTexture},this._ao=t,this._bloom=n,this._fxaa=e,this._aoEnabled=void 0,this._bloomEnabled=void 0,this._tonemappingEnabled=void 0,this._fxaaEnabled=void 0,this._activeStagesChanged=!1,this._stagesRemoved=!1,this._textureCacheDirty=!1,this._stageNames=a,this._textureCache=s}function $(e){if(!e._stagesRemoved)return;e._stagesRemoved=!1;const t=[],n=e._stages,o=n.length;for(let i=0,s=0;i<o;++i){const e=n[i];e&&(e._index=s++,t.push(e))}e._stages=t}function J(e){while(Object(o["a"])(e.length))e=e.get(e.length-1);return e.outputTexture}function K(e,t,n,i,s){if(Object(o["a"])(e.execute))return void e.execute(t,n,i,s);const a=e.length;let r;if(e.inputPreviousStageTexture)for(K(e.get(0),t,n,i,s),r=1;r<a;++r)K(e.get(r),t,J(e.get(r-1)),i,s);else for(r=0;r<a;++r)K(e.get(r),t,n,i,s)}Object.defineProperties(q.prototype,{ready:{get:function(){let e=!1;const t=this._stages,n=t.length;for(let r=n-1;r>=0;--r){const n=t[r];e=e||n.ready&&n.enabled}const o=this._fxaa,i=this._ao,s=this._bloom,a=this._tonemapping;return e=e||o.ready&&o.enabled,e=e||i.ready&&i.enabled,e=e||s.ready&&s.enabled,e=e||a.ready&&a.enabled,e}},fxaa:{get:function(){return this._fxaa}},ambientOcclusion:{get:function(){return this._ao}},bloom:{get:function(){return this._bloom}},length:{get:function(){return $(this),this._stages.length}},outputTexture:{get:function(){const e=this._fxaa;if(e.enabled&&e.ready)return this.getOutputTexture(e.name);const t=this._stages,n=t.length;for(let r=n-1;r>=0;--r){const e=t[r];if(Object(o["a"])(e)&&e.ready&&e.enabled)return this.getOutputTexture(e.name)}const i=this._tonemapping;if(i.enabled&&i.ready)return this.getOutputTexture(i.name);const s=this._bloom;if(s.enabled&&s.ready)return this.getOutputTexture(s.name);const a=this._ao;return a.enabled&&a.ready?this.getOutputTexture(a.name):void 0}},hasSelected:{get:function(){const e=this._stages.slice();while(e.length>0){const t=e.pop();if(!Object(o["a"])(t))continue;if(Object(o["a"])(t.selected))return!0;const n=t.length;if(Object(o["a"])(n))for(let o=0;o<n;++o)e.push(t.get(o))}return!1}},tonemapper:{get:function(){return this._tonemapper},set:function(e){if(this._tonemapper===e)return;Object(o["a"])(this._tonemapping)&&(delete this._stageNames[this._tonemapping.name],this._tonemapping.destroy());const t=this._autoExposureEnabled;let n;switch(e){case X["a"].REINHARD:n=Y.createReinhardTonemappingStage(t);break;case X["a"].MODIFIED_REINHARD:n=Y.createModifiedReinhardTonemappingStage(t);break;case X["a"].FILMIC:n=Y.createFilmicTonemappingStage(t);break;default:n=Y.createAcesTonemappingStage(t);break}if(t){const e=this._autoExposure;n.uniforms.autoExposure=function(){return e.outputTexture}}this._tonemapper=e,this._tonemapping=n,Object(o["a"])(this._stageNames)&&(this._stageNames[n.name]=n,n._textureCache=this._textureCache),this._textureCacheDirty=!0}}}),q.prototype.add=function(e){const t=this._stageNames,n=G;n.push(e);while(n.length>0){const e=n.pop();t[e.name]=e,e._textureCache=this._textureCache;const i=e.length;if(Object(o["a"])(i))for(let t=0;t<i;++t)n.push(e.get(t))}const i=this._stages;return e._index=i.length,i.push(e),this._textureCacheDirty=!0,e},q.prototype.remove=function(e){if(!this.contains(e))return!1;const t=this._stageNames,n=G;n.push(e);while(n.length>0){const e=n.pop();delete t[e.name];const i=e.length;if(Object(o["a"])(i))for(let t=0;t<i;++t)n.push(e.get(t))}return this._stages[e._index]=void 0,this._stagesRemoved=!0,this._textureCacheDirty=!0,e._index=void 0,e._textureCache=void 0,e.destroy(),!0},q.prototype.contains=function(e){return Object(o["a"])(e)&&Object(o["a"])(e._index)&&e._textureCache===this._textureCache},q.prototype.get=function(e){$(this);const t=this._stages;return t[e]},q.prototype.removeAll=function(){const e=this._stages,t=e.length;for(let n=0;n<t;++n)this.remove(e[n]);e.length=0},q.prototype.getStageByName=function(e){return this._stageNames[e]},q.prototype.update=function(e,t,n){$(this);const i=this._activeStages,d=this._activeStages=this._previousActiveStages;this._previousActiveStages=i;const f=this._stages;let _,p,m=d.length=f.length,g=0;for(_=0;_<m;++_)p=f[_],p.ready&&p.enabled&&p._isSupported(e)&&(d[g++]=p);d.length=g;let b=g!==i.length;if(!b)for(_=0;_<g;++_)if(d[_]!==i[_]){b=!0;break}const y=this._ao,S=this._bloom,x=this._autoExposure,T=this._tonemapping,O=this._fxaa;T.enabled=n;const w=y.enabled&&y._isSupported(e),E=S.enabled&&S._isSupported(e),D=T.enabled&&T._isSupported(e),v=O.enabled&&O._isSupported(e);if((b||this._textureCacheDirty||w!==this._aoEnabled||E!==this._bloomEnabled||D!==this._tonemappingEnabled||v!==this._fxaaEnabled)&&(this._textureCache.updateDependencies(),this._aoEnabled=w,this._bloomEnabled=E,this._tonemappingEnabled=D,this._fxaaEnabled=v,this._textureCacheDirty=!1),Object(o["a"])(this._randomTexture)&&!w&&(this._randomTexture.destroy(),this._randomTexture=void 0),!Object(o["a"])(this._randomTexture)&&w){m=196608;const t=new Uint8Array(m);for(_=0;_<m;_+=3)t[_]=Math.floor(255*Math.random());this._randomTexture=new c["a"]({context:e,pixelFormat:s["a"].RGB,pixelDatatype:a["a"].UNSIGNED_BYTE,source:{arrayBufferView:t,width:256,height:256},sampler:new r["a"]({wrapS:h["a"].REPEAT,wrapT:h["a"].REPEAT,minificationFilter:l["a"].NEAREST,magnificationFilter:u["a"].NEAREST})})}for(this._textureCache.update(e),O.update(e,t),y.update(e,t),S.update(e,t),T.update(e,t),this._autoExposureEnabled&&x.update(e,t),m=f.length,_=0;_<m;++_)f[_].update(e,t);for(g=0,_=0;_<m;++_)p=f[_],p.ready&&p.enabled&&p._isSupported(e)&&g++;b=g!==d.length,b&&this.update(e,t,n)},q.prototype.clear=function(e){this._textureCache.clear(e),this._autoExposureEnabled&&this._autoExposure.clear(e)},q.prototype.getOutputTexture=function(e){const t=this.getStageByName(e);if(Object(o["a"])(t))return J(t)},q.prototype.execute=function(e,t,n,o){const i=this._activeStages,s=i.length,a=this._fxaa,r=this._ao,c=this._bloom,u=this._autoExposure,l=this._tonemapping,h=r.enabled&&r._isSupported(e),d=c.enabled&&c._isSupported(e),f=this._autoExposureEnabled,_=l.enabled&&l._isSupported(e),p=a.enabled&&a._isSupported(e);if(!p&&!h&&!d&&!_&&0===s)return;let m=t;h&&r.ready&&(K(r,e,m,n,o),m=J(r)),d&&c.ready&&(K(c,e,m,n,o),m=J(c)),f&&u.ready&&K(u,e,m,n,o),_&&l.ready&&(K(l,e,m,n,o),m=J(l));let g=m;if(s>0){K(i[0],e,m,n,o);for(let t=1;t<s;++t)K(i[t],e,J(i[t-1]),n,o);g=J(i[s-1])}p&&a.ready&&K(a,e,g,n,o)},q.prototype.copy=function(e,t){if(!Object(o["a"])(this._copyColorCommand)){const t=this;this._copyColorCommand=e.createViewportQuadCommand(d["a"],{uniformMap:{colorTexture:function(){return t.outputTexture}},owner:this})}this._copyColorCommand.framebuffer=t,this._copyColorCommand.execute(e)},q.prototype.isDestroyed=function(){return!1},q.prototype.destroy=function(){return this._fxaa.destroy(),this._ao.destroy(),this._bloom.destroy(),this._autoExposure.destroy(),this._tonemapping.destroy(),this.removeAll(),this._textureCache=this._textureCache&&this._textureCache.destroy(),Object(i["a"])(this)};t["a"]=q},f724:function(e,t,n){"use strict";var o=n("71ce"),i=n("535a"),s=n("2f63"),a=n("7d62");function r(e){e=Object(i["a"])(e,i["a"].EMPTY_OBJECT),this._stages=e.stages,this._inputPreviousStageTexture=Object(i["a"])(e.inputPreviousStageTexture,!0);let t=e.name;Object(s["a"])(t)||(t=Object(o["a"])()),this._name=t,this._uniforms=e.uniforms,this._textureCache=void 0,this._index=void 0,this._selected=void 0,this._selectedShadow=void 0,this._parentSelected=void 0,this._parentSelectedShadow=void 0,this._combinedSelected=void 0,this._combinedSelectedShadow=void 0,this._selectedLength=0,this._parentSelectedLength=0,this._selectedDirty=!0}function c(e){let t=Object(s["a"])(e._selected)?e._selected.length:0;const n=Object(s["a"])(e._parentSelected)?e._parentSelected:0;let o=e._selected!==e._selectedShadow||t!==e._selectedLength;if(o=o||e._parentSelected!==e._parentSelectedShadow||n!==e._parentSelectedLength,Object(s["a"])(e._selected)&&Object(s["a"])(e._parentSelected)?e._combinedSelected=e._selected.concat(e._parentSelected):Object(s["a"])(e._parentSelected)?e._combinedSelected=e._parentSelected:e._combinedSelected=e._selected,!o&&Object(s["a"])(e._combinedSelected)){if(!Object(s["a"])(e._combinedSelectedShadow))return!0;t=e._combinedSelected.length;for(let n=0;n<t;++n)if(e._combinedSelected[n]!==e._combinedSelectedShadow[n])return!0}return o}Object.defineProperties(r.prototype,{ready:{get:function(){const e=this._stages,t=e.length;for(let n=0;n<t;++n)if(!e[n].ready)return!1;return!0}},name:{get:function(){return this._name}},enabled:{get:function(){return this._stages[0].enabled},set:function(e){const t=this._stages,n=t.length;for(let o=0;o<n;++o)t[o].enabled=e}},uniforms:{get:function(){return this._uniforms}},inputPreviousStageTexture:{get:function(){return this._inputPreviousStageTexture}},length:{get:function(){return this._stages.length}},selected:{get:function(){return this._selected},set:function(e){this._selected=e}},parentSelected:{get:function(){return this._parentSelected},set:function(e){this._parentSelected=e}}}),r.prototype._isSupported=function(e){const t=this._stages,n=t.length;for(let o=0;o<n;++o)if(!t[o]._isSupported(e))return!1;return!0},r.prototype.get=function(e){return this._stages[e]},r.prototype.update=function(e,t){this._selectedDirty=c(this),this._selectedShadow=this._selected,this._parentSelectedShadow=this._parentSelected,this._combinedSelectedShadow=this._combinedSelected,this._selectedLength=Object(s["a"])(this._selected)?this._selected.length:0,this._parentSelectedLength=Object(s["a"])(this._parentSelected)?this._parentSelected.length:0;const n=this._stages,o=n.length;for(let i=0;i<o;++i){const o=n[i];this._selectedDirty&&(o.parentSelected=this._combinedSelected),o.update(e,t)}},r.prototype.isDestroyed=function(){return!1},r.prototype.destroy=function(){const e=this._stages,t=e.length;for(let n=0;n<t;++n)e[n].destroy();return Object(a["a"])(this)},t["a"]=r}}]);