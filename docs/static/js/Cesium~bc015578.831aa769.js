(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Cesium~bc015578"],{"026e":function(t,e,n){"use strict";var a=n("1da3"),i=n("abab"),o=n("2f63"),r=n("1eae"),s=n("d62b"),c=n("60e0"),u=n("d887"),d=n("1b8d"),_=n("a307"),T=n("f23e"),I=n("ef54"),S=n("a141");const l={};function E(t,e,n,a,i,r){const s=t.shaderBuilder,u=c["a"].getAttributeInfo(e),d=i&&!r;a>1?N(t,e,n,a):A(t,e,n,d),p(s,u,d),b(s,u),Object(o["a"])(e.semantic)&&f(s,e),F(s,u,i),m(s,u,d),R(s,u)}function f(t,e){const n=e.semantic,a=e.setIndex;switch(n){case S["a"].NORMAL:t.addDefine("HAS_NORMALS");break;case S["a"].TANGENT:t.addDefine("HAS_TANGENTS");break;case S["a"].FEATURE_ID:t.addDefine(`HAS${n}_${a}`);break;case S["a"].TEXCOORD:case S["a"].COLOR:t.addDefine(`HAS_${n}_${a}`)}}function A(t,e,n,r){const s=e.quantization;let c,u;Object(o["a"])(s)?(c=s.type,u=s.componentDatatype):(c=e.type,u=e.componentDatatype);const d=e.semantic,_=e.setIndex;d===S["a"].FEATURE_ID&&_>=t.featureIdVertexAttributeSetIndex&&(t.featureIdVertexAttributeSetIndex=_+1);const T=d===S["a"].POSITION,I=T?0:n,l=a["a"].getNumberOfComponents(c),E={index:I,value:Object(o["a"])(e.buffer)?void 0:e.constant,vertexBuffer:e.buffer,count:e.count,componentsPerAttribute:l,componentDatatype:u,offsetInBytes:e.byteOffset,strideInBytes:e.byteStride,normalize:e.normalized};if(t.attributes.push(E),!T||!r)return;const f=t.runtimePrimitive.positionBuffer2D,A={index:n,vertexBuffer:f,count:e.count,componentsPerAttribute:l,componentDatatype:i["a"].FLOAT,offsetInBytes:e.byteOffset,strideInBytes:e.byteStride,normalize:e.normalized};t.attributes.push(A)}function N(t,e,n,r){const s=e.quantization;let c,u;Object(o["a"])(s)?(c=s.type,u=s.componentDatatype):(c=e.type,u=e.componentDatatype);const d=e.normalized,_=a["a"].getNumberOfComponents(c),T=_/r,I=i["a"].getSizeInBytes(u),S=T*I,l=e.byteStride;for(let a=0;a<r;a++){const i=e.byteOffset+a*S,o={index:n+a,vertexBuffer:e.buffer,componentsPerAttribute:T,componentDatatype:u,offsetInBytes:i,strideInBytes:l,normalize:d};t.attributes.push(o)}}function b(t,e){const n=e.variableName;let a,i="v_"+n;"normalMC"===n?(i="v_normalEC",a=e.glslType):"tangentMC"===n?(a="vec3",i="v_tangentEC"):a=e.glslType,t.addVarying(a,i)}function p(t,e,n){const a=e.attribute.semantic,i=e.variableName;let o,r;e.isQuantized?(o="a_quantized_"+i,r=e.quantizedGlslType):(o="a_"+i,r=e.glslType);const s=a===S["a"].POSITION;s?t.setPositionAttribute(r,o):t.addAttribute(r,o),s&&n&&t.addAttribute("vec3","a_position2D")}function F(t,e,n){const a=l.STRUCT_ID_PROCESSED_ATTRIBUTES_VS,i=l.STRUCT_ID_PROCESSED_ATTRIBUTES_FS,o=e.variableName;"tangentMC"===o?(t.addStructField(a,"vec3","tangentMC"),t.addStructField(a,"float","tangentSignMC"),t.addStructField(i,"vec3","tangentEC")):"normalMC"===o?(t.addStructField(a,"vec3","normalMC"),t.addStructField(i,"vec3","normalEC")):(t.addStructField(a,e.glslType,o),t.addStructField(i,e.glslType,o)),"positionMC"===o&&n&&t.addStructField(a,"vec3","position2D")}function m(t,e,n){const a=l.FUNCTION_ID_INITIALIZE_ATTRIBUTES,i=e.variableName,o="positionMC"===i&&n;if(o){const e="attributes.position2D = a_position2D;";t.addFunctionLines(a,[e])}if(e.isQuantized)return;const r=[];"tangentMC"===i?(r.push("attributes.tangentMC = a_tangentMC.xyz;"),r.push("attributes.tangentSignMC = a_tangentMC.w;")):r.push(`attributes.${i} = a_${i};`),t.addFunctionLines(a,r)}function R(t,e){const n=e.attribute.semantic,a=e.attribute.setIndex;if(Object(o["a"])(n)&&!Object(o["a"])(a))return;let i=l.FUNCTION_ID_SET_DYNAMIC_VARYINGS_VS;const r=e.variableName;let s=`v_${r} = attributes.${r};`;t.addFunctionLines(i,[s]),i=l.FUNCTION_ID_SET_DYNAMIC_VARYINGS_FS,s=`attributes.${r} = v_${r};`,t.addFunctionLines(i,[s])}function U(t,e){let n=!1,a=!1;for(let i=0;i<e.length;i++){const t=e[i];t.semantic===S["a"].NORMAL?n=!0:t.semantic===S["a"].TANGENT&&(a=!0)}n&&a&&(t.addDefine("HAS_BITANGENTS"),t.addVarying("vec3","v_bitangentEC"),t.addStructField(l.STRUCT_ID_PROCESSED_ATTRIBUTES_VS,"vec3","bitangentMC"),t.addStructField(l.STRUCT_ID_PROCESSED_ATTRIBUTES_FS,"vec3","bitangentEC"))}l.name="GeometryPipelineStage",l.STRUCT_ID_PROCESSED_ATTRIBUTES_VS="ProcessedAttributesVS",l.STRUCT_ID_PROCESSED_ATTRIBUTES_FS="ProcessedAttributesFS",l.STRUCT_NAME_PROCESSED_ATTRIBUTES="ProcessedAttributes",l.FUNCTION_ID_INITIALIZE_ATTRIBUTES="initializeAttributes",l.FUNCTION_SIGNATURE_INITIALIZE_ATTRIBUTES="void initializeAttributes(out ProcessedAttributes attributes)",l.FUNCTION_ID_SET_DYNAMIC_VARYINGS_VS="setDynamicVaryingsVS",l.FUNCTION_ID_SET_DYNAMIC_VARYINGS_FS="setDynamicVaryingsFS",l.FUNCTION_SIGNATURE_SET_DYNAMIC_VARYINGS="void setDynamicVaryings(inout ProcessedAttributes attributes)",l.process=function(t,e,n){const i=t.shaderBuilder;i.addStruct(l.STRUCT_ID_PROCESSED_ATTRIBUTES_VS,"ProcessedAttributes",I["a"].VERTEX),i.addStruct(l.STRUCT_ID_PROCESSED_ATTRIBUTES_FS,"ProcessedAttributes",I["a"].FRAGMENT),i.addStruct(T["a"].STRUCT_ID_SELECTED_FEATURE,T["a"].STRUCT_NAME_SELECTED_FEATURE,I["a"].BOTH),i.addFunction(l.FUNCTION_ID_INITIALIZE_ATTRIBUTES,l.FUNCTION_SIGNATURE_INITIALIZE_ATTRIBUTES,I["a"].VERTEX),i.addVarying("vec3","v_positionWC"),i.addVarying("vec3","v_positionEC"),i.addStructField(l.STRUCT_ID_PROCESSED_ATTRIBUTES_FS,"vec3","positionWC"),i.addStructField(l.STRUCT_ID_PROCESSED_ATTRIBUTES_FS,"vec3","positionEC"),i.addFunction(l.FUNCTION_ID_SET_DYNAMIC_VARYINGS_VS,l.FUNCTION_SIGNATURE_SET_DYNAMIC_VARYINGS,I["a"].VERTEX),i.addFunction(l.FUNCTION_ID_SET_DYNAMIC_VARYINGS_FS,l.FUNCTION_SIGNATURE_SET_DYNAMIC_VARYINGS,I["a"].FRAGMENT);const c=t.model,f=c.type;f===u["a"].TILE_PNTS&&i.addDefine("HAS_SRGB_COLOR",void 0,I["a"].FRAGMENT);const A=n.mode!==_["a"].SCENE3D&&!n.scene3DOnly&&c._projectTo2D,N=Object(o["a"])(t.runtimeNode.node.instances),b=A&&!N,p=e.attributes.length;for(let o=0;o<p;o++){const n=e.attributes[o],i=a["a"].getAttributeLocationCount(n.type),r=n.semantic===S["a"].POSITION;let s;i>1?(s=t.attributeIndex,t.attributeIndex+=i):s=r&&!b?0:t.attributeIndex++,E(t,n,s,i,A,N)}U(i,e.attributes),e.primitiveType===d["a"].POINTS&&i.addDefine("PRIMITIVE_TYPE_POINTS"),i.addVertexLines([s["a"]]),i.addFragmentLines([r["a"]])},e["a"]=l},"195b":function(t,e,n){"use strict";var a=n("e20d"),i=n("a564"),o=n("d289"),r=n("c1f7"),s=n("ef54"),c=n("9693"),u=n("31ef"),d=n("2f63");const _={name:"CPUStylingPipelineStage",process:function(t,e,n){const _=t.model,T=t.shaderBuilder;T.addVertexLines([a["a"]]),T.addFragmentLines([i["a"]]),T.addDefine("USE_CPU_STYLING",void 0,s["a"].BOTH),Object(d["a"])(_.color)||(T.addUniform("float",u["a"].COLOR_BLEND_UNIFORM_NAME,s["a"].FRAGMENT),t.uniformMap[u["a"].COLOR_BLEND_UNIFORM_NAME]=function(){return r["a"].getColorBlend(_.colorBlendMode,_.colorBlendAmount)}),T.addUniform("bool","model_commandTranslucent",s["a"].BOTH),t.uniformMap.model_commandTranslucent=function(){return t.alphaOptions.pass===o["a"].TRANSLUCENT};const I=_.featureTables[_.featureTableId],S=c["a"].getStyleCommandsNeeded(I.featuresLength,I.batchTexture.translucentFeaturesLength);S===c["a"].ALL_TRANSLUCENT&&(t.alphaOptions.pass=o["a"].TRANSLUCENT),t.styleCommandsNeeded=S}};e["a"]=_},"2f21":function(t,e,n){"use strict";var a=n("2f63"),i=n("a561"),o=n("ef54"),r=n("60e0");const s={};function c(t,e){const n=t.shaderBuilder,a=t.uniformMap,i=e.variableName,r=e.attribute.quantization;if(r.octEncoded){const t="model_normalizationRange_"+i;n.addUniform("float",t,o["a"].VERTEX),a[t]=function(){return r.normalizationRange}}else{const t="model_quantizedVolumeOffset_"+i,s="model_quantizedVolumeStepSize_"+i,c=e.glslType;n.addUniform(c,t,o["a"].VERTEX),n.addUniform(c,s,o["a"].VERTEX);let d=r.quantizedVolumeOffset,_=r.quantizedVolumeStepSize;/^color_\d+$/.test(i)&&(d=u(d,0),_=u(_,1)),a[t]=function(){return d},a[s]=function(){return _}}}function u(t,e){return t instanceof i["a"]?t:new i["a"](t.x,t.y,t.z,e)}function d(t,e){const n=e.variableName,a=e.attribute.quantization;let i;i=a.octEncoded?_(n,a):T(n),t.addFunctionLines(s.FUNCTION_ID_DEQUANTIZATION_STAGE_VS,[i])}function _(t,e){const n="attributes."+t,a="a_quantized_"+t,i="model_normalizationRange_"+t,o=e.octEncodedZXY?".zxy":".xyz";return`${n} = czm_octDecode(${a}, ${i})${o};`}function T(t){const e="attributes."+t,n="a_quantized_"+t,a="model_quantizedVolumeOffset_"+t,i="model_quantizedVolumeStepSize_"+t;return`${e} = ${a} + ${n} * ${i};`}s.name="DequantizationPipelineStage",s.FUNCTION_ID_DEQUANTIZATION_STAGE_VS="dequantizationStage",s.FUNCTION_SIGNATURE_DEQUANTIZATION_STAGE_VS="void dequantizationStage(inout ProcessedAttributes attributes)",s.process=function(t,e,n){const i=t.shaderBuilder;i.addFunction(s.FUNCTION_ID_DEQUANTIZATION_STAGE_VS,s.FUNCTION_SIGNATURE_DEQUANTIZATION_STAGE_VS,o["a"].VERTEX),i.addDefine("USE_DEQUANTIZATION",void 0,o["a"].VERTEX);const u=e.attributes;for(let o=0;o<u.length;o++){const e=u[o],n=e.quantization;if(!Object(a["a"])(n))continue;const s=r["a"].getAttributeInfo(e);d(i,s),c(t,s)}},e["a"]=s},"366d":function(t,e,n){"use strict";var a=n("2bb9"),i=n("2f63"),o=n("b639"),r=n("ef54"),s=n("d289"),c=n("34c5"),u=n("74ac"),d=n("47f3"),_=n("d2b3"),T=n("c7f8"),I=n("60e0");const S={};function l(t){const e={};for(let n=0;n<t.length;n++){const a=t[n],i=I["a"].getAttributeInfo(a);e[i.variableName]=i}return e}S.name="CustomShaderPipelineStage",S.STRUCT_ID_ATTRIBUTES_VS="AttributesVS",S.STRUCT_ID_ATTRIBUTES_FS="AttributesFS",S.STRUCT_NAME_ATTRIBUTES="Attributes",S.STRUCT_ID_VERTEX_INPUT="VertexInput",S.STRUCT_NAME_VERTEX_INPUT="VertexInput",S.STRUCT_ID_FRAGMENT_INPUT="FragmentInput",S.STRUCT_NAME_FRAGMENT_INPUT="FragmentInput",S.FUNCTION_ID_INITIALIZE_INPUT_STRUCT_VS="initializeInputStructVS",S.FUNCTION_SIGNATURE_INITIALIZE_INPUT_STRUCT_VS="void initializeInputStruct(out VertexInput vsInput, ProcessedAttributes attributes)",S.FUNCTION_ID_INITIALIZE_INPUT_STRUCT_FS="initializeInputStructFS",S.FUNCTION_SIGNATURE_INITIALIZE_INPUT_STRUCT_FS="void initializeInputStruct(out FragmentInput fsInput, ProcessedAttributes attributes)",S.process=function(t,e,n){const o=t.shaderBuilder,c=t.model.customShader;Object(i["a"])(c.lightingModel)&&(t.lightingOptions.lightingModel=c.lightingModel);const u=t.alphaOptions;c.isTranslucent?u.pass=s["a"].TRANSLUCENT:u.pass=void 0;const _=R(c,e);if(!_.customShaderEnabled)return;if(D(o,c,_),_.shouldComputePositionWC&&o.addDefine("COMPUTE_POSITION_WC_CUSTOM_SHADER",void 0,r["a"].BOTH),Object(i["a"])(c.vertexShaderText)&&o.addDefine("HAS_CUSTOM_VERTEX_SHADER",void 0,r["a"].VERTEX),Object(i["a"])(c.fragmentShaderText)){o.addDefine("HAS_CUSTOM_FRAGMENT_SHADER",void 0,r["a"].FRAGMENT);const t=d["a"].getDefineName(c.mode);o.addDefine(t,void 0,r["a"].FRAGMENT)}const T=c.uniforms;for(const a in T)if(T.hasOwnProperty(a)){const t=T[a];o.addUniform(t.type,a)}const I=c.varyings;for(const a in I)if(I.hasOwnProperty(a)){const t=I[a];o.addVarying(t,a)}t.uniformMap=Object(a["a"])(t.uniformMap,c.uniformMap)};const E={position:"vec3",normal:"vec3",tangent:"vec3",bitangent:"vec3",texCoord:"vec2",color:"vec4",joints:"ivec4",weights:"vec4"},f={position:"vec3(0.0)",normal:"vec3(0.0, 0.0, 1.0)",tangent:"vec3(1.0, 0.0, 0.0)",bitangent:"vec3(0.0, 1.0, 0.0)",texCoord:"vec2(0.0)",color:"vec4(1.0)",joints:"ivec4(0)",weights:"vec4(0.0)"};function A(t){let e=t.replace(/_[0-9]+$/,"");e=e.replace(/(MC|EC)$/,"");const n=E[e],a=f[e];if(Object(i["a"])(n))return{attributeField:[n,t],value:a}}function N(t,e,n){const a=m(e,t.usedVariablesVertex.attributeSet,!1),o=a.addToShader,r=a.missingAttributes;let s,c;const u=[],d=[];for(s in o)if(o.hasOwnProperty(s)){const t=o[s],e=[t.glslType,s];u.push(e),c=`vsInput.attributes.${s} = attributes.${s};`,d.push(c)}for(let _=0;_<r.length;_++){s=r[_];const t=A(s);if(!Object(i["a"])(t))return void S._oneTimeWarning("CustomShaderPipelineStage.incompatiblePrimitiveVS",`Primitive is missing attribute ${s}, disabling custom vertex shader`);u.push(t.attributeField),c=`vsInput.attributes.${s} = ${t.value};`,d.push(c)}n.enabled=!0,n.attributeFields=u,n.initializationLines=d}function b(t){const e=[],n=[],a=t.usedVariablesFragment.attributeSet;return a.hasOwnProperty("positionWC")&&(e.push(["vec3","positionWC"]),n.push("fsInput.attributes.positionWC = attributes.positionWC;")),a.hasOwnProperty("positionEC")&&(e.push(["vec3","positionEC"]),n.push("fsInput.attributes.positionEC = attributes.positionEC;")),{attributeFields:e,initializationLines:n}}function p(t,e,n){const a=m(e,t.usedVariablesFragment.attributeSet,!0),o=a.addToShader,r=a.missingAttributes;let s,c;const u=[],d=[];for(s in o)if(o.hasOwnProperty(s)){const t=o[s],e=[t.glslType,s];u.push(e),c=`fsInput.attributes.${s} = attributes.${s};`,d.push(c)}for(let T=0;T<r.length;T++){s=r[T];const t=A(s);if(!Object(i["a"])(t))return void S._oneTimeWarning("CustomShaderPipelineStage.incompatiblePrimitiveFS",`Primitive is missing attribute ${s}, disabling custom fragment shader.`);u.push(t.attributeField),c=`fsInput.attributes.${s} = ${t.value};`,d.push(c)}const _=b(t);n.enabled=!0,n.attributeFields=u.concat(_.attributeFields),n.initializationLines=_.initializationLines.concat(d)}const F={positionWC:!0,positionEC:!0};function m(t,e,n){let a,i;const o={};for(i in t)if(t.hasOwnProperty(i)){const r=t[i];a=i,n&&"normalMC"===i?a="normalEC":n&&"tangentMC"===i&&(a="tangentEC"),e.hasOwnProperty(a)&&(o[a]=r)}const r=[];for(i in e)if(e.hasOwnProperty(i)){if(F.hasOwnProperty(i))continue;a=i,n&&"normalEC"===i?a="normalMC":n&&"tangentEC"===i&&(a="tangentMC"),t.hasOwnProperty(a)||r.push(i)}return{addToShader:o,missingAttributes:r}}function R(t,e){const n={enabled:!1},a={enabled:!1},o=l(e.attributes);Object(i["a"])(t.vertexShaderText)&&N(t,o,n),Object(i["a"])(t.fragmentShaderText)&&p(t,o,a);const r=t.usedVariablesFragment.attributeSet,s=r.hasOwnProperty("positionWC")&&a.enabled;return{vertexLines:n,fragmentLines:a,vertexLinesEnabled:n.enabled,fragmentLinesEnabled:a.enabled,customShaderEnabled:n.enabled||a.enabled,shouldComputePositionWC:s}}function U(t,e){let n,a=S.STRUCT_ID_ATTRIBUTES_VS;t.addStruct(a,S.STRUCT_NAME_ATTRIBUTES,r["a"].VERTEX);const i=e.attributeFields;for(n=0;n<i.length;n++){const e=i[n],o=e[0],r=e[1];t.addStructField(a,o,r)}a=S.STRUCT_ID_VERTEX_INPUT,t.addStruct(a,S.STRUCT_NAME_VERTEX_INPUT,r["a"].VERTEX),t.addStructField(a,S.STRUCT_NAME_ATTRIBUTES,"attributes"),t.addStructField(a,_["a"].STRUCT_NAME_FEATURE_IDS,"featureIds"),t.addStructField(a,T["a"].STRUCT_NAME_METADATA,"metadata"),t.addStructField(a,T["a"].STRUCT_NAME_METADATACLASS,"metadataClass");const o=S.FUNCTION_ID_INITIALIZE_INPUT_STRUCT_VS;t.addFunction(o,S.FUNCTION_SIGNATURE_INITIALIZE_INPUT_STRUCT_VS,r["a"].VERTEX);const s=e.initializationLines;t.addFunctionLines(o,s)}function C(t,e){let n,a,i,o,s=S.STRUCT_ID_ATTRIBUTES_FS;t.addStruct(s,S.STRUCT_NAME_ATTRIBUTES,r["a"].FRAGMENT);const c=e.attributeFields;for(n=0;n<c.length;n++)a=c[n],i=a[0],o=a[1],t.addStructField(s,i,o);s=S.STRUCT_ID_FRAGMENT_INPUT,t.addStruct(s,S.STRUCT_NAME_FRAGMENT_INPUT,r["a"].FRAGMENT),t.addStructField(s,S.STRUCT_NAME_ATTRIBUTES,"attributes"),t.addStructField(s,_["a"].STRUCT_NAME_FEATURE_IDS,"featureIds"),t.addStructField(s,T["a"].STRUCT_NAME_METADATA,"metadata"),t.addStructField(s,T["a"].STRUCT_NAME_METADATACLASS,"metadataClass");const u=S.FUNCTION_ID_INITIALIZE_INPUT_STRUCT_FS;t.addFunction(u,S.FUNCTION_SIGNATURE_INITIALIZE_INPUT_STRUCT_FS,r["a"].FRAGMENT);const d=e.initializationLines;t.addFunctionLines(u,d)}function D(t,e,n){const a=n.vertexLines;a.enabled&&(U(t,a),t.addVertexLines(["#line 0",e.vertexShaderText,c["a"]]));const i=n.fragmentLines;i.enabled&&(C(t,i),t.addFragmentLines(["#line 0",e.fragmentShaderText,u["a"]]))}S._oneTimeWarning=o["a"],e["a"]=S},"47f3":function(t,e,n){"use strict";const a={MODIFY_MATERIAL:"MODIFY_MATERIAL",REPLACE_MATERIAL:"REPLACE_MATERIAL",getDefineName:function(t){return"CUSTOM_SHADER_"+t}};e["a"]=Object.freeze(a)},"5ecf":function(t,e,n){"use strict";var a=n("2bb9"),i=n("535a");const o={name:"BatchTexturePipelineStage",process:function(t,e,n){const o=t.shaderBuilder,r={},s=t.model,c=s.featureTables[s.featureTableId],u=c.featuresLength;o.addUniform("int","model_featuresLength"),r.model_featuresLength=function(){return u};const d=c.batchTexture;o.addUniform("sampler2D","model_batchTexture"),r.model_batchTexture=function(){return Object(i["a"])(d.batchTexture,d.defaultTexture)},o.addUniform("vec4","model_textureStep"),r.model_textureStep=function(){return d.textureStep},d.textureDimensions.y>1&&(o.addDefine("MULTILINE_BATCH_TEXTURE"),o.addUniform("vec2","model_textureDimensions"),r.model_textureDimensions=function(){return d.textureDimensions}),t.uniformMap=Object(a["a"])(r,t.uniformMap)}};e["a"]=o},"6f64":function(t,e,n){"use strict";var a=n("535a"),i=n("2f63"),o=n("ef54"),r=n("b7c8"),s=n("d289");const c={name:"AlphaPipelineStage",process:function(t,e,n){const c=t.alphaOptions,u=t.model;c.pass=Object(a["a"])(c.pass,u.opaquePass);const d=t.renderStateOptions;c.pass===s["a"].TRANSLUCENT&&(d.cull.enabled=!1,d.depthMask=!1,d.blending=r["a"].ALPHA_BLEND);const _=t.shaderBuilder,T=t.uniformMap;Object(i["a"])(c.alphaCutoff)&&(_.addDefine("ALPHA_MODE_MASK",void 0,o["a"].FRAGMENT),_.addUniform("float","u_alphaCutoff",o["a"].FRAGMENT),T.u_alphaCutoff=function(){return c.alphaCutoff})}};e["a"]=c},cb84:function(t,e,n){"use strict";var a=n("b08e"),i=n("5679"),o=n("be18"),r=n("9889"),s=n("abab"),c=n("535a"),u=n("2f63"),d=n("fdb7"),_=n("2453"),T=n("52f0"),I=n("21d4"),S=n("8bde"),l=n("60e0"),E=n("fa74"),f=n("a7eb"),A=n("aa13"),N=n("a141");const b={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,FAILED:4},p=S["a"].FeatureIdAttribute;function F(t){t=Object(c["a"])(t,c["a"].EMPTY_OBJECT);const e=t.b3dmResource;let n=t.baseResource;const i=t.arrayBuffer,o=Object(c["a"])(t.byteOffset,0),r=Object(c["a"])(t.releaseGltfJson,!1),s=Object(c["a"])(t.asynchronous,!0),d=Object(c["a"])(t.incrementallyLoadTextures,!0),_=Object(c["a"])(t.upAxis,a["a"].Y),I=Object(c["a"])(t.forwardAxis,a["a"].X),S=Object(c["a"])(t.loadAttributesAsTypedArray,!1),l=Object(c["a"])(t.loadAttributesFor2D,!1),E=Object(c["a"])(t.loadIndicesForWireframe,!1),f=Object(c["a"])(t.loadPrimitiveOutline,!0);n=Object(u["a"])(n)?n:e.clone(),this._b3dmResource=e,this._baseResource=n,this._arrayBuffer=i,this._byteOffset=o,this._releaseGltfJson=r,this._asynchronous=s,this._incrementallyLoadTextures=d,this._upAxis=_,this._forwardAxis=I,this._loadAttributesAsTypedArray=S,this._loadAttributesFor2D=l,this._loadIndicesForWireframe=E,this._loadPrimitiveOutline=f,this._state=b.UNLOADED,this._promise=void 0,this._gltfLoader=void 0,this._batchLength=0,this._propertyTable=void 0,this._batchTable=void 0,this._components=void 0,this._transform=T["a"].IDENTITY}function m(t,e){t.unload(),t._state=b.FAILED;const n="Failed to load b3dm";return e=t.getError(n,e),Promise.reject(e)}function R(t,e){const n=t._batchTable,a=t._batchLength;if(0===a)return;let i;if(Object(u["a"])(n.json))i=Object(E["a"])({count:a,batchTable:n.json,binaryBody:n.binary});else{const t=new f["a"]({name:I["a"].BATCH_TABLE_CLASS_NAME,count:a});i=new d["a"]({schema:{},propertyTables:[t]})}const o=e.scene.nodes,r=o.length;for(let s=0;s<r;s++)U(o[s]);e.structuralMetadata=i}function U(t){const e=t.children.length;for(let a=0;a<e;a++)U(t.children[a]);const n=t.primitives.length;for(let a=0;a<n;a++){const e=t.primitives[a],n=l["a"].getAttributeBySemantic(e,N["a"].FEATURE_ID);if(Object(u["a"])(n)){n.setIndex=0;const t=new p;t.propertyTableId=0,t.setIndex=0,t.positionalLabel="featureId_0",e.featureIds.push(t)}}}Object(u["a"])(Object.create)&&(F.prototype=Object.create(A["a"].prototype),F.prototype.constructor=F),Object.defineProperties(F.prototype,{promise:{get:function(){return this._promise}},texturesLoadedPromise:{get:function(){return this._gltfLoader.texturesLoadedPromise}},cacheKey:{get:function(){}},components:{get:function(){return this._components}}}),F.prototype.load=function(){const t=i["a"].parse(this._arrayBuffer,this._byteOffset);let e=t.batchLength;const n=t.featureTableJson,a=t.featureTableBinary,c=t.batchTableJson,d=t.batchTableBinary,I=new r["a"](n,a);e=I.getGlobalProperty("BATCH_LENGTH"),this._batchLength=e;const S=I.getGlobalProperty("RTC_CENTER",s["a"].FLOAT,3);Object(u["a"])(S)&&(this._transform=T["a"].fromTranslation(o["a"].fromArray(S))),this._batchTable={json:c,binary:d};const l=new _["a"]({typedArray:t.gltf,upAxis:this._upAxis,forwardAxis:this._forwardAxis,gltfResource:this._b3dmResource,baseResource:this._baseResource,releaseGltfJson:this._releaseGltfJson,incrementallyLoadTextures:this._incrementallyLoadTextures,loadAttributesAsTypedArray:this._loadAttributesAsTypedArray,loadAttributesFor2D:this._loadAttributesFor2D,loadIndicesForWireframe:this._loadIndicesForWireframe,loadPrimitiveOutline:this._loadPrimitiveOutline,renameBatchIdSemantic:!0});this._gltfLoader=l,this._state=b.LOADING;const E=this;return l.load(),this._promise=l.promise.then((function(){if(E.isDestroyed())return;const t=l.components;return t.transform=E._transform,R(E,t),E._components=t,E._state=b.READY,E})).catch((function(t){if(!E.isDestroyed())return m(E,t)})),this._promise},F.prototype.process=function(t){this._state===b.LOADING&&(this._state=b.PROCESSING),this._state===b.PROCESSING&&this._gltfLoader.process(t)},F.prototype.unload=function(){Object(u["a"])(this._gltfLoader)&&this._gltfLoader.unload(),this._components=void 0},e["a"]=F},cbd5:function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));var a=n("be18"),i=n("abab"),o=n("535a"),r=n("2f63"),s=n("c52f"),c=n("0123"),u=n("52f0"),d=n("1b8d"),_=n("283e"),T=n("f806"),I=n("1da3"),S=n("53c8"),l=n("5637"),E=n("8bde"),f=n("a7eb"),A=n("aa13"),N=n("fdb7"),b=n("a141"),p=n("f20a"),F=n("8b68");function m(t){t=Object(o["a"])(t,o["a"].EMPTY_OBJECT),this._geoJson=t.geoJson,this._promise=void 0,this._process=function(t,e){},this._components=void 0}function R(){this.lines=void 0,this.properties=void 0}function U(){this.features=[]}function C(t){const e=t[0],n=t[1],i=Object(o["a"])(t[2],0);return new a["a"](e,n,i)}function D(t){const e=t.length,n=new Array(e);for(let i=0;i<e;i++)n[i]=C(t[i]);const a=[n];return a}function O(t){const e=t.length,n=new Array(e);for(let a=0;a<e;a++)n[a]=D(t[a])[0];return n}function h(t){const e=t.length,n=new Array(e);for(let a=0;a<e;a++)n[a]=D(t[a])[0];return n}function y(t){const e=t.length,n=[];for(let a=0;a<e;a++)Array.prototype.push.apply(n,h(t[a]));return n}Object(r["a"])(Object.create)&&(m.prototype=Object.create(A["a"].prototype),m.prototype.constructor=m),Object.defineProperties(m.prototype,{promise:{get:function(){return this._promise}},cacheKey:{get:function(){}},components:{get:function(){return this._components}}}),m.prototype.load=function(){const t=this,e=new Promise((function(e){t._process=function(t,n){Object(r["a"])(t._components)||(t._components=P(t._geoJson,n),t._geoJson=void 0,e(t))}}));return this._promise=e,e},m.prototype.process=function(t){this._process(this,t)};const g={LineString:D,MultiLineString:O,MultiPolygon:y,Polygon:h};function L(t,e){if(!Object(r["a"])(t.geometry))return;const n=t.geometry.type,a=g[n],i=t.geometry.coordinates;if(!Object(r["a"])(a))return;if(!Object(r["a"])(i))return;const o=new R;o.lines=a(i),o.properties=t.properties,e.features.push(o)}function v(t,e){const n=t.features,a=n.length;for(let i=0;i<a;i++)L(n[i],e)}const V={FeatureCollection:v,Feature:L},M=new a["a"];function P(t,e){const n=new U,A=V[t.type];Object(r["a"])(A)&&A(t,n);const m=n.features.length;if(0===m)throw new _["a"]("GeoJSON must have at least one feature");const R={};for(let a=0;a<m;a++){const t=n.features[a],e=Object(o["a"])(t.properties,o["a"].EMPTY_OBJECT);for(const n in e)e.hasOwnProperty(n)&&(Object(r["a"])(R[n])||(R[n]=new Array(m)))}for(let a=0;a<m;a++){const t=n.features[a];for(const e in R)if(R.hasOwnProperty(e)){const n=Object(o["a"])(t.properties[e],"");R[e][a]=n}}const C=new S["a"]({count:m,properties:R}),D=new f["a"]({id:0,count:m,jsonMetadataTable:C}),O=[D],h=new l["a"]({}),y=new N["a"]({schema:h,propertyTables:O}),g=new a["a"](Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),L=new a["a"](Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(let i=0;i<m;i++){const t=n.features[i],e=t.lines.length;for(let n=0;n<e;n++){const e=t.lines[n],i=e.length;for(let t=0;t<i;t++)a["a"].minimumByComponent(g,e[t],g),a["a"].maximumByComponent(L,e[t],L)}}const v=a["a"].midpoint(g,L,new a["a"]),P=a["a"].fromDegrees(v.x,v.y,v.z,s["a"].WGS84,new a["a"]),x=T["a"].eastNorthUpToFixedFrame(P,s["a"].WGS84,new u["a"]),B=u["a"].inverseTransformation(x,new u["a"]);let G=0,j=0;for(let a=0;a<m;a++){const t=n.features[a],e=t.lines.length;for(let n=0;n<e;n++){const e=t.lines[n];G+=e.length,j+=2*(e.length-1)}}const w=new Float32Array(3*G),z=new Float32Array(G),$=c["a"].createTypedArray(G,j),Y=c["a"].fromTypedArray($),Z=new a["a"](Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),W=new a["a"](Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);let X=0,H=0;for(let i=0;i<m;i++){const t=n.features[i],e=t.lines.length;for(let n=0;n<e;n++){const e=t.lines[n],o=e.length;for(let t=0;t<o;t++){const n=e[t],r=a["a"].fromDegrees(n.x,n.y,n.z,s["a"].WGS84,M),c=u["a"].multiplyByPoint(B,r,M);a["a"].minimumByComponent(Z,c,Z),a["a"].maximumByComponent(W,c,W),a["a"].pack(c,w,3*X),z[X]=i,t<o-1&&($[2*H]=X,$[2*H+1]=X+1,H++),X++}}}const q=p["a"].createVertexBuffer({typedArray:w,context:e.context,usage:F["a"].STATIC_DRAW});q.vertexArrayDestroyable=!1;const J=p["a"].createVertexBuffer({typedArray:z,context:e.context,usage:F["a"].STATIC_DRAW});J.vertexArrayDestroyable=!1;const k=p["a"].createIndexBuffer({typedArray:$,context:e.context,usage:F["a"].STATIC_DRAW,indexDatatype:Y});k.vertexArrayDestroyable=!1;const Q=new E["a"].Attribute;Q.semantic=b["a"].POSITION,Q.componentDatatype=i["a"].FLOAT,Q.type=I["a"].VEC3,Q.count=G,Q.min=Z,Q.max=W,Q.buffer=q;const K=new E["a"].Attribute;K.semantic=b["a"].FEATURE_ID,K.setIndex=0,K.componentDatatype=i["a"].FLOAT,K.type=I["a"].SCALAR,K.count=G,K.buffer=J;const tt=[Q,K],et=new E["a"].Material;et.unlit=!0;const nt=new E["a"].Indices;nt.indexDatatype=Y,nt.count=$.length,nt.buffer=k;const at=new E["a"].FeatureIdAttribute;at.featureCount=m,at.propertyTableId=0,at.setIndex=0,at.positionalLabel="featureId_0";const it=[at],ot=new E["a"].Primitive;ot.attributes=tt,ot.indices=nt,ot.featureIds=it,ot.primitiveType=d["a"].LINES,ot.material=et;const rt=[ot],st=new E["a"].Node;st.index=0,st.primitives=rt;const ct=[st],ut=new E["a"].Scene;ut.nodes=ct;const dt=new E["a"].Components;return dt.scene=ut,dt.nodes=ct,dt.transform=x,dt.structuralMetadata=y,dt}m.prototype.unload=function(){this._components=void 0}},d2b3:function(t,e,n){"use strict";var a=n("abab"),i=n("535a"),o=n("2f63"),r=n("ef54"),s=n("f20a"),c=n("8b68"),u=n("60e0"),d=n("a141"),_=n("8bde"),T=n("379d"),I=n("d47a");const S={};function l(t){t.addStruct(S.STRUCT_ID_FEATURE_IDS_VS,S.STRUCT_NAME_FEATURE_IDS,r["a"].VERTEX),t.addStruct(S.STRUCT_ID_FEATURE_IDS_FS,S.STRUCT_NAME_FEATURE_IDS,r["a"].FRAGMENT),t.addFunction(S.FUNCTION_ID_INITIALIZE_FEATURE_IDS_VS,S.FUNCTION_SIGNATURE_INITIALIZE_FEATURE_IDS,r["a"].VERTEX),t.addFunction(S.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS,S.FUNCTION_SIGNATURE_INITIALIZE_FEATURE_IDS,r["a"].FRAGMENT),t.addFunction(S.FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_VS,S.FUNCTION_SIGNATURE_INITIALIZE_FEATURE_ID_ALIASES,r["a"].VERTEX),t.addFunction(S.FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_FS,S.FUNCTION_SIGNATURE_INITIALIZE_FEATURE_ID_ALIASES,r["a"].FRAGMENT),t.addFunction(S.FUNCTION_ID_SET_FEATURE_ID_VARYINGS,S.FUNCTION_SIGNATURE_SET_FEATURE_ID_VARYINGS,r["a"].VERTEX)}function E(t,e,n){const a=e.featureIds,i=e.attributes[0].count;for(let s=0;s<a.length;s++){const e=a[s],c=e.positionalLabel;if(e instanceof _["a"].FeatureIdAttribute)A(t,e,c);else{const a=1;b(t,e,c,i,a,n)}const u=e.label;Object(o["a"])(u)&&F(t,c,u,r["a"].BOTH)}}function f(t,e,n){const a=e.featureIds,i=u["a"].getAttributeBySemantic(e,d["a"].POSITION),s=i.count;for(let c=0;c<a.length;c++){const e=a[c],i=e.positionalLabel;let u=r["a"].BOTH;e instanceof _["a"].FeatureIdAttribute?N(t,e,i):e instanceof _["a"].FeatureIdImplicitRange?b(t,e,i,s,void 0,n):(p(t,e,i,c,n),u=r["a"].FRAGMENT);const d=e.label;Object(o["a"])(d)&&F(t,i,d,u)}}function A(t,e,n){const a=t.shaderBuilder;a.addStructField(S.STRUCT_ID_FEATURE_IDS_VS,"int",n),a.addStructField(S.STRUCT_ID_FEATURE_IDS_FS,"int",n);const i=e.setIndex,o=n.replace(/_\d+$/,"_"),r=`a_${o}${i}`,s=`v_${o}${i}`,c=`featureIds.${n} = int(czm_round(${r}));`,u=`featureIds.${n} = int(czm_round(${s}));`;a.addFunctionLines(S.FUNCTION_ID_INITIALIZE_FEATURE_IDS_VS,[c]),a.addFunctionLines(S.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS,[u]),a.addVarying("float",s),a.addFunctionLines(S.FUNCTION_ID_SET_FEATURE_ID_VARYINGS,[`${s} = ${r};`])}function N(t,e,n){const a=t.shaderBuilder;a.addStructField(S.STRUCT_ID_FEATURE_IDS_VS,"int",n),a.addStructField(S.STRUCT_ID_FEATURE_IDS_FS,"int",n);const i=e.setIndex,o=n.replace(/_\d+$/,"_"),r=[`featureIds.${n} = int(czm_round(attributes.${o}${i}));`];a.addFunctionLines(S.FUNCTION_ID_INITIALIZE_FEATURE_IDS_VS,r),a.addFunctionLines(S.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS,r)}function b(t,e,n,a,i,o){m(t,e,a,i,o);const r=t.shaderBuilder,s="a_implicit_"+n;r.addAttribute("float",s);const c="v_implicit_"+n;r.addVarying("float",c),r.addStructField(S.STRUCT_ID_FEATURE_IDS_VS,"int",n),r.addStructField(S.STRUCT_ID_FEATURE_IDS_FS,"int",n),r.addFunctionLines(S.FUNCTION_ID_SET_FEATURE_ID_VARYINGS,[`${c} = ${s};`]),r.addFunctionLines(S.FUNCTION_ID_INITIALIZE_FEATURE_IDS_VS,[`featureIds.${n} = int(czm_round(${s}));`]),r.addFunctionLines(S.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS,[`featureIds.${n} = int(czm_round(${c}));`])}function p(t,e,n,a,o){const s="u_featureIdTexture_"+a,c=t.uniformMap,u=e.textureReader;c[s]=function(){return Object(i["a"])(u.texture,o.context.defaultTexture)};const d=u.channels,_=t.shaderBuilder;_.addStructField(S.STRUCT_ID_FEATURE_IDS_FS,"int",n),_.addUniform("sampler2D",s,r["a"].FRAGMENT);const T="v_texCoord_"+u.texCoord,I=`texture2D(${s}, ${T}).${d}`,l=`featureIds.${n} = czm_unpackUint(${I});`;_.addFunctionLines(S.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS,[l])}function F(t,e,n,a){const i=t.shaderBuilder,o=r["a"].includesVertexShader(a);o&&i.addStructField(S.STRUCT_ID_FEATURE_IDS_VS,"int",n),i.addStructField(S.STRUCT_ID_FEATURE_IDS_FS,"int",n);const s=[`featureIds.${n} = featureIds.${e};`];o&&i.addFunctionLines(S.FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_VS,s),i.addFunctionLines(S.FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_FS,s)}function m(t,e,n,i,r){const u=t.model;let d,_;if(Object(o["a"])(e.repeat)){const t=R(e,n);d=s["a"].createVertexBuffer({context:r.context,typedArray:t,usage:c["a"].STATIC_DRAW}),d.vertexArrayDestroyable=!1,u._pipelineResources.push(d);const a=!1;u.statistics.addBuffer(d,a)}else _=[e.offset];const T={index:t.attributeIndex++,instanceDivisor:i,value:_,vertexBuffer:d,normalize:!1,componentsPerAttribute:1,componentDatatype:a["a"].FLOAT,strideInBytes:a["a"].getSizeInBytes(a["a"].FLOAT),offsetInBytes:0};t.attributes.push(T)}function R(t,e){const n=t.offset,a=t.repeat,i=new Float32Array(e);for(let o=0;o<e;o++)i[o]=n+Math.floor(o/a);return i}S.name="FeatureIdPipelineStage",S.STRUCT_ID_FEATURE_IDS_VS="FeatureIdsVS",S.STRUCT_ID_FEATURE_IDS_FS="FeatureIdsFS",S.STRUCT_NAME_FEATURE_IDS="FeatureIds",S.FUNCTION_ID_INITIALIZE_FEATURE_IDS_VS="initializeFeatureIdsVS",S.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS="initializeFeatureIdsFS",S.FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_VS="initializeFeatureIdAliasesVS",S.FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_FS="initializeFeatureIdAliasesFS",S.FUNCTION_SIGNATURE_INITIALIZE_FEATURE_IDS="void initializeFeatureIds(out FeatureIds featureIds, ProcessedAttributes attributes)",S.FUNCTION_SIGNATURE_INITIALIZE_FEATURE_ID_ALIASES="void initializeFeatureIdAliases(inout FeatureIds featureIds)",S.FUNCTION_ID_SET_FEATURE_ID_VARYINGS="setFeatureIdVaryings",S.FUNCTION_SIGNATURE_SET_FEATURE_ID_VARYINGS="void setFeatureIdVaryings()",S.process=function(t,e,n){const a=t.shaderBuilder;l(a);const i=t.runtimeNode.node.instances;Object(o["a"])(i)&&E(t,i,n),f(t,e,n),a.addVertexLines([I["a"]]),a.addFragmentLines([T["a"]])},e["a"]=S}}]);