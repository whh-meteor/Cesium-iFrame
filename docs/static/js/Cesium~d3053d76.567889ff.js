(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Cesium~d3053d76"],{"9dbf":function(t,o,i){"use strict";var a=i("cef5"),e=i("670c"),n=i("be18"),s=i("a561"),r=i("bef8"),c=i("535a"),u=i("2f63"),h=i("55f9"),l=i("c52f"),d=i("1e13"),m=i("21d7"),p=i("ddf7"),f=i("4f77"),_=i("8dd9"),g=i("66bf"),C=i("5410"),T=i("93da"),y=i("df07"),O=i("52f0"),E=i("713f"),w=i("4e1a"),W=i("0260"),I=i("2ac3"),b=i("eace"),v=i("f806"),P=i("b137"),j=i("482f"),x=i("a307");function M(t){this._scene=t,this._transform=O["a"].clone(O["a"].IDENTITY),this._invTransform=O["a"].clone(O["a"].IDENTITY),this._actualTransform=O["a"].clone(O["a"].IDENTITY),this._actualInvTransform=O["a"].clone(O["a"].IDENTITY),this._transformChanged=!1,this.position=new n["a"],this._position=new n["a"],this._positionWC=new n["a"],this._positionCartographic=new r["a"],this._oldPositionWC=void 0,this.positionWCDeltaMagnitude=0,this.positionWCDeltaMagnitudeLastFrame=0,this.timeSinceMoved=0,this._lastMovedTimestamp=0,this.direction=new n["a"],this._direction=new n["a"],this._directionWC=new n["a"],this.up=new n["a"],this._up=new n["a"],this._upWC=new n["a"],this.right=new n["a"],this._right=new n["a"],this._rightWC=new n["a"],this.frustum=new w["a"],this.frustum.aspectRatio=t.drawingBufferWidth/t.drawingBufferHeight,this.frustum.fov=T["a"].toRadians(60),this.defaultMoveAmount=1e5,this.defaultLookAmount=Math.PI/60,this.defaultRotateAmount=Math.PI/3600,this.defaultZoomAmount=1e5,this.constrainedAxis=void 0,this.maximumZoomFactor=1.5,this._moveStart=new m["a"],this._moveEnd=new m["a"],this._changed=new m["a"],this._changedPosition=void 0,this._changedDirection=void 0,this._changedFrustum=void 0,this._changedHeading=void 0,this.percentageChanged=.5,this._viewMatrix=new O["a"],this._invViewMatrix=new O["a"],N(this),this._mode=x["a"].SCENE3D,this._modeChanged=!0;const o=t.mapProjection;this._projection=o,this._maxCoord=o.project(new r["a"](Math.PI,T["a"].PI_OVER_TWO)),this._max2Dfrustum=void 0,to(this,M.DEFAULT_VIEW_RECTANGLE,this.position,!0);let i=n["a"].magnitude(this.position);i+=i*M.DEFAULT_VIEW_FACTOR,n["a"].normalize(this.position,this.position),n["a"].multiplyByScalar(this.position,i,this.position)}function N(t){O["a"].computeView(t._position,t._direction,t._up,t._right,t._viewMatrix),O["a"].multiply(t._viewMatrix,t._actualInvTransform,t._viewMatrix),O["a"].inverseTransformation(t._viewMatrix,t._invViewMatrix)}function S(t){if(Object(u["a"])(t._oldPositionWC)){t.positionWCDeltaMagnitudeLastFrame=t.positionWCDeltaMagnitude;const o=n["a"].subtract(t.positionWC,t._oldPositionWC,t._oldPositionWC);t.positionWCDeltaMagnitude=n["a"].magnitude(o),t._oldPositionWC=n["a"].clone(t.positionWC,t._oldPositionWC),t.positionWCDeltaMagnitude>0?(t.timeSinceMoved=0,t._lastMovedTimestamp=Object(p["a"])()):t.timeSinceMoved=Math.max(Object(p["a"])()-t._lastMovedTimestamp,0)/1e3}else t._oldPositionWC=n["a"].clone(t.positionWC,t._oldPositionWC)}function R(t){v["a"].basisTo2D(t._projection,t._transform,t._actualTransform)}M.TRANSFORM_2D=new O["a"](0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1),M.TRANSFORM_2D_INVERSE=O["a"].inverseTransformation(M.TRANSFORM_2D,new O["a"]),M.DEFAULT_VIEW_RECTANGLE=b["a"].fromDegrees(-95,-20,-70,90),M.DEFAULT_VIEW_FACTOR=.5,M.DEFAULT_OFFSET=new f["a"](0,-T["a"].PI_OVER_FOUR,0),M.prototype.canPreloadFlight=function(){return Object(u["a"])(this._currentFlight)&&this._mode!==x["a"].SCENE2D},M.prototype._updateCameraChanged=function(){const t=this;if(S(t),0===t._changed.numberOfListeners)return;const o=t.percentageChanged,i=t.heading;Object(u["a"])(t._changedHeading)||(t._changedHeading=i);let a=Math.abs(t._changedHeading-i)%T["a"].TWO_PI;a=a>T["a"].PI?T["a"].TWO_PI-a:a;const e=a/Math.PI;if(e>o&&(t._changed.raiseEvent(e),t._changedHeading=i),t._mode===x["a"].SCENE2D){if(!Object(u["a"])(t._changedFrustum))return t._changedPosition=n["a"].clone(t.position,t._changedPosition),void(t._changedFrustum=t.frustum.clone());const i=t.position,a=t._changedPosition,e=t.frustum,s=t._changedFrustum,r=i.x+e.left,c=i.x+e.right,h=a.x+s.left,l=a.x+s.right,d=i.y+e.bottom,m=i.y+e.top,p=a.y+s.bottom,f=a.y+s.top,_=Math.max(r,h),g=Math.min(c,l),C=Math.max(d,p),T=Math.min(m,f);let y;if(_>=g||C>=m)y=1;else{let t=s;r<h&&c>l&&d<p&&m>f&&(t=e),y=1-(g-_)*(T-C)/((t.right-t.left)*(t.top-t.bottom))}return void(y>o&&(t._changed.raiseEvent(y),t._changedPosition=n["a"].clone(t.position,t._changedPosition),t._changedFrustum=t.frustum.clone(t._changedFrustum)))}if(!Object(u["a"])(t._changedDirection))return t._changedPosition=n["a"].clone(t.positionWC,t._changedPosition),void(t._changedDirection=n["a"].clone(t.directionWC,t._changedDirection));const s=T["a"].acosClamped(n["a"].dot(t.directionWC,t._changedDirection));let r;r=Object(u["a"])(t.frustum.fovy)?s/(.5*t.frustum.fovy):s;const c=n["a"].distance(t.positionWC,t._changedPosition),h=c/t.positionCartographic.height;(r>o||h>o)&&(t._changed.raiseEvent(Math.max(r,h)),t._changedPosition=n["a"].clone(t.positionWC,t._changedPosition),t._changedDirection=n["a"].clone(t.directionWC,t._changedDirection))};const A=new r["a"],D=new n["a"],F=new n["a"],V=new s["a"],B=new s["a"],z=new s["a"],L=new s["a"],U=new s["a"];function k(t){const o=t._projection,i=o.ellipsoid,a=O["a"].getColumn(t._transform,3,V),e=i.cartesianToCartographic(a,A),r=o.project(e,D),c=B;c.x=r.z,c.y=r.x,c.z=r.y,c.w=1;const u=s["a"].clone(s["a"].UNIT_X,U),h=s["a"].add(O["a"].getColumn(t._transform,0,F),a,F);i.cartesianToCartographic(h,e),o.project(e,r);const l=z;l.x=r.z,l.y=r.x,l.z=r.y,l.w=0,n["a"].subtract(l,c,l),l.x=0;const d=L;if(n["a"].magnitudeSquared(l)>T["a"].EPSILON10)n["a"].cross(u,l,d);else{const u=s["a"].add(O["a"].getColumn(t._transform,1,F),a,F);i.cartesianToCartographic(u,e),o.project(e,r),d.x=r.z,d.y=r.x,d.z=r.y,d.w=0,n["a"].subtract(d,c,d),d.x=0,n["a"].magnitudeSquared(d)<T["a"].EPSILON10&&(s["a"].clone(s["a"].UNIT_Y,l),s["a"].clone(s["a"].UNIT_Z,d))}n["a"].cross(d,u,l),n["a"].normalize(l,l),n["a"].cross(u,l,d),n["a"].normalize(d,d),O["a"].setColumn(t._actualTransform,0,l,t._actualTransform),O["a"].setColumn(t._actualTransform,1,d,t._actualTransform),O["a"].setColumn(t._actualTransform,2,u,t._actualTransform),O["a"].setColumn(t._actualTransform,3,c,t._actualTransform)}const H=new n["a"];function Y(t){const o=t._mode;let i=!1,a=0;o===x["a"].SCENE2D&&(a=t.frustum.right-t.frustum.left,i=a!==t._positionCartographic.height);let e=t._position;const s=!n["a"].equals(e,t.position)||i;s&&(e=n["a"].clone(t.position,t._position));let r=t._direction;const c=!n["a"].equals(r,t.direction);c&&(n["a"].normalize(t.direction,t.direction),r=n["a"].clone(t.direction,t._direction));let u=t._up;const h=!n["a"].equals(u,t.up);h&&(n["a"].normalize(t.up,t.up),u=n["a"].clone(t.up,t._up));let l=t._right;const d=!n["a"].equals(l,t.right);d&&(n["a"].normalize(t.right,t.right),l=n["a"].clone(t.right,t._right));const m=t._transformChanged||t._modeChanged;t._transformChanged=!1,m&&(O["a"].inverseTransformation(t._transform,t._invTransform),t._mode===x["a"].COLUMBUS_VIEW||t._mode===x["a"].SCENE2D?O["a"].equals(O["a"].IDENTITY,t._transform)?O["a"].clone(M.TRANSFORM_2D,t._actualTransform):t._mode===x["a"].COLUMBUS_VIEW?R(t):k(t):O["a"].clone(t._transform,t._actualTransform),O["a"].inverseTransformation(t._actualTransform,t._actualInvTransform),t._modeChanged=!1);const p=t._actualTransform;if(s||m)if(t._positionWC=O["a"].multiplyByPoint(p,e,t._positionWC),o===x["a"].SCENE3D||o===x["a"].MORPHING)t._positionCartographic=t._projection.ellipsoid.cartesianToCartographic(t._positionWC,t._positionCartographic);else{const i=H;i.x=t._positionWC.y,i.y=t._positionWC.z,i.z=t._positionWC.x,o===x["a"].SCENE2D&&(i.z=a),t._projection.unproject(i,t._positionCartographic)}if(c||h||d){const o=n["a"].dot(r,n["a"].cross(u,l,H));if(Math.abs(1-o)>T["a"].EPSILON2){const o=1/n["a"].magnitudeSquared(u),i=n["a"].dot(u,r)*o,a=n["a"].multiplyByScalar(r,i,H);u=n["a"].normalize(n["a"].subtract(u,a,t._up),t._up),n["a"].clone(u,t.up),l=n["a"].cross(r,u,t._right),n["a"].clone(l,t.right)}}(c||m)&&(t._directionWC=O["a"].multiplyByPointAsVector(p,r,t._directionWC),n["a"].normalize(t._directionWC,t._directionWC)),(h||m)&&(t._upWC=O["a"].multiplyByPointAsVector(p,u,t._upWC),n["a"].normalize(t._upWC,t._upWC)),(d||m)&&(t._rightWC=O["a"].multiplyByPointAsVector(p,l,t._rightWC),n["a"].normalize(t._rightWC,t._rightWC)),(s||c||h||d||m)&&N(t)}function q(t,o){let i;return i=T["a"].equalsEpsilon(Math.abs(t.z),1,T["a"].EPSILON3)?Math.atan2(o.y,o.x)-T["a"].PI_OVER_TWO:Math.atan2(t.y,t.x)-T["a"].PI_OVER_TWO,T["a"].TWO_PI-T["a"].zeroToTwoPi(i)}function Z(t){return T["a"].PI_OVER_TWO-T["a"].acosClamped(t.z)}function G(t,o,i){let a=0;return T["a"].equalsEpsilon(Math.abs(t.z),1,T["a"].EPSILON3)||(a=Math.atan2(-i.z,o.z),a=T["a"].zeroToTwoPi(a+T["a"].TWO_PI)),a}const X=new O["a"],J=new O["a"];Object.defineProperties(M.prototype,{transform:{get:function(){return this._transform}},inverseTransform:{get:function(){return Y(this),this._invTransform}},viewMatrix:{get:function(){return Y(this),this._viewMatrix}},inverseViewMatrix:{get:function(){return Y(this),this._invViewMatrix}},positionCartographic:{get:function(){return Y(this),this._positionCartographic}},positionWC:{get:function(){return Y(this),this._positionWC}},directionWC:{get:function(){return Y(this),this._directionWC}},upWC:{get:function(){return Y(this),this._upWC}},rightWC:{get:function(){return Y(this),this._rightWC}},heading:{get:function(){if(this._mode!==x["a"].MORPHING){const t=this._projection.ellipsoid,o=O["a"].clone(this._transform,X),i=v["a"].eastNorthUpToFixedFrame(this.positionWC,t,J);this._setTransform(i);const a=q(this.direction,this.up);return this._setTransform(o),a}}},pitch:{get:function(){if(this._mode!==x["a"].MORPHING){const t=this._projection.ellipsoid,o=O["a"].clone(this._transform,X),i=v["a"].eastNorthUpToFixedFrame(this.positionWC,t,J);this._setTransform(i);const a=Z(this.direction);return this._setTransform(o),a}}},roll:{get:function(){if(this._mode!==x["a"].MORPHING){const t=this._projection.ellipsoid,o=O["a"].clone(this._transform,X),i=v["a"].eastNorthUpToFixedFrame(this.positionWC,t,J);this._setTransform(i);const a=G(this.direction,this.up,this.right);return this._setTransform(o),a}}},moveStart:{get:function(){return this._moveStart}},moveEnd:{get:function(){return this._moveEnd}},changed:{get:function(){return this._changed}}}),M.prototype.update=function(t){let o=!1;if(t!==this._mode&&(this._mode=t,this._modeChanged=t!==x["a"].MORPHING,o=this._mode===x["a"].SCENE2D),o){const t=this._max2Dfrustum=this.frustum.clone(),o=2,i=t.top/t.right;t.right=this._maxCoord.x*o,t.left=-t.right,t.top=i*t.right,t.bottom=-t.top}this._mode===x["a"].SCENE2D&&Ot(this,this.position)};const Q=new n["a"],K=new n["a"],$=new n["a"];M.prototype._setTransform=function(t){const o=n["a"].clone(this.positionWC,Q),i=n["a"].clone(this.upWC,K),a=n["a"].clone(this.directionWC,$);O["a"].clone(t,this._transform),this._transformChanged=!0,Y(this);const e=this._actualInvTransform;O["a"].multiplyByPoint(e,o,this.position),O["a"].multiplyByPointAsVector(e,a,this.direction),O["a"].multiplyByPointAsVector(e,i,this.up),n["a"].cross(this.direction,this.up,this.right),Y(this)};const tt=new e["a"],ot=new I["a"],it=new n["a"],at=new n["a"];function et(t){if(!O["a"].equals(O["a"].IDENTITY,t.transform))return n["a"].magnitude(t.position);const o=t._scene,i=o.globe,a=tt;let e,s,r;if(a.x=o.drawingBufferWidth/2,a.y=o.drawingBufferHeight/2,Object(u["a"])(i)){const n=t.getPickRay(a,ot);e=i.pickWorldCoordinates(n,o,!0,it)}if(o.pickPositionSupported&&(s=o.pickPositionWorldCoordinates(a,at)),Object(u["a"])(e)||Object(u["a"])(s)){const o=Object(u["a"])(s)?n["a"].distance(s,t.positionWC):Number.POSITIVE_INFINITY,i=Object(u["a"])(e)?n["a"].distance(e,t.positionWC):Number.POSITIVE_INFINITY;r=Math.min(o,i)}else r=Math.max(t.positionCartographic.height,0);return r}M.prototype._adjustOrthographicFrustum=function(t){this.frustum instanceof E["a"]&&(!t&&this._positionCartographic.height<15e4||(this.frustum.width=et(this)))};const nt=new n["a"],st=new O["a"],rt=new O["a"],ct=new W["a"],ut=new y["a"],ht=new r["a"];function lt(t,o,i){const a=O["a"].clone(t.transform,st),e=v["a"].eastNorthUpToFixedFrame(o,t._projection.ellipsoid,rt);t._setTransform(e),n["a"].clone(n["a"].ZERO,t.position),i.heading=i.heading-T["a"].PI_OVER_TWO;const s=W["a"].fromHeadingPitchRoll(i,ct),r=y["a"].fromQuaternion(s,ut);y["a"].getColumn(r,0,t.direction),y["a"].getColumn(r,2,t.up),n["a"].cross(t.direction,t.up,t.right),t._setTransform(a),t._adjustOrthographicFrustum(!0)}function dt(t,o,i,a){const e=O["a"].clone(t.transform,st);if(t._setTransform(O["a"].IDENTITY),!n["a"].equals(o,t.positionWC)){if(a){const i=t._projection,a=i.ellipsoid.cartesianToCartographic(o,ht);o=i.project(a,nt)}n["a"].clone(o,t.position)}i.heading=i.heading-T["a"].PI_OVER_TWO;const s=W["a"].fromHeadingPitchRoll(i,ct),r=y["a"].fromQuaternion(s,ut);y["a"].getColumn(r,0,t.direction),y["a"].getColumn(r,2,t.up),n["a"].cross(t.direction,t.up,t.right),t._setTransform(e),t._adjustOrthographicFrustum(!0)}function mt(t,o,i,a){const s=O["a"].clone(t.transform,st);if(t._setTransform(O["a"].IDENTITY),!n["a"].equals(o,t.positionWC)){if(a){const i=t._projection,a=i.ellipsoid.cartesianToCartographic(o,ht);o=i.project(a,nt)}e["a"].clone(o,t.position);const i=.5*-o.z,n=-i,s=t.frustum;if(n>i){const t=s.top/s.right;s.right=n,s.left=i,s.top=s.right*t,s.bottom=-s.top}}if(t._scene.mapMode2D===j["a"].ROTATE){i.heading=i.heading-T["a"].PI_OVER_TWO,i.pitch=-T["a"].PI_OVER_TWO,i.roll=0;const o=W["a"].fromHeadingPitchRoll(i,ct),a=y["a"].fromQuaternion(o,ut);y["a"].getColumn(a,2,t.up),n["a"].cross(t.direction,t.up,t.right)}t._setTransform(s)}const pt=new n["a"],ft=new n["a"],_t=new n["a"];function gt(t,o,i,a){const e=n["a"].clone(i.direction,pt),s=n["a"].clone(i.up,ft);if(t._scene.mode===x["a"].SCENE3D){const i=t._projection.ellipsoid,a=v["a"].eastNorthUpToFixedFrame(o,i,X),n=O["a"].inverseTransformation(a,J);O["a"].multiplyByPointAsVector(n,e,e),O["a"].multiplyByPointAsVector(n,s,s)}const r=n["a"].cross(e,s,_t);return a.heading=q(e,s),a.pitch=Z(e),a.roll=G(e,s,r),a}const Ct={destination:void 0,orientation:{direction:void 0,up:void 0,heading:void 0,pitch:void 0,roll:void 0},convert:void 0,endTransform:void 0},Tt=new _["a"];M.prototype.setView=function(t){t=Object(c["a"])(t,c["a"].EMPTY_OBJECT);let o=Object(c["a"])(t.orientation,c["a"].EMPTY_OBJECT);const i=this._mode;if(i===x["a"].MORPHING)return;Object(u["a"])(t.endTransform)&&this._setTransform(t.endTransform);let a=Object(c["a"])(t.convert,!0),e=Object(c["a"])(t.destination,n["a"].clone(this.positionWC,nt));Object(u["a"])(e)&&Object(u["a"])(e.west)&&(e=this.getRectangleCameraCoordinates(e,nt),a=!1),Object(u["a"])(o.direction)&&(o=gt(this,e,o,Ct.orientation)),Tt.heading=Object(c["a"])(o.heading,0),Tt.pitch=Object(c["a"])(o.pitch,-T["a"].PI_OVER_TWO),Tt.roll=Object(c["a"])(o.roll,0),i===x["a"].SCENE3D?lt(this,e,Tt):i===x["a"].SCENE2D?mt(this,e,Tt,a):dt(this,e,Tt,a)};const yt=new n["a"];function Ot(t,o){const i=t._scene.mapMode2D===j["a"].ROTATE,a=t._maxCoord.x,e=t._maxCoord.y;let n,s;i?(s=a,n=-s):(s=o.x-2*a,n=o.x+2*a),o.x>a&&(o.x=s),o.x<-a&&(o.x=n),o.y>e&&(o.y=e),o.y<-e&&(o.y=-e)}M.prototype.flyHome=function(t){const o=this._mode;if(o===x["a"].MORPHING&&this._scene.completeMorph(),o===x["a"].SCENE2D)this.flyTo({destination:M.DEFAULT_VIEW_RECTANGLE,duration:t,endTransform:O["a"].IDENTITY});else if(o===x["a"].SCENE3D){const o=this.getRectangleCameraCoordinates(M.DEFAULT_VIEW_RECTANGLE);let i=n["a"].magnitude(o);i+=i*M.DEFAULT_VIEW_FACTOR,n["a"].normalize(o,o),n["a"].multiplyByScalar(o,i,o),this.flyTo({destination:o,duration:t,endTransform:O["a"].IDENTITY})}else if(o===x["a"].COLUMBUS_VIEW){const o=this._projection.ellipsoid.maximumRadius;let i=new n["a"](0,-1,1);i=n["a"].multiplyByScalar(n["a"].normalize(i,i),5*o,i),this.flyTo({destination:i,duration:t,orientation:{heading:0,pitch:-Math.acos(n["a"].normalize(i,yt).z),roll:0},endTransform:O["a"].IDENTITY,convert:!1})}},M.prototype.worldToCameraCoordinates=function(t,o){return Object(u["a"])(o)||(o=new s["a"]),Y(this),O["a"].multiplyByVector(this._actualInvTransform,t,o)},M.prototype.worldToCameraCoordinatesPoint=function(t,o){return Object(u["a"])(o)||(o=new n["a"]),Y(this),O["a"].multiplyByPoint(this._actualInvTransform,t,o)},M.prototype.worldToCameraCoordinatesVector=function(t,o){return Object(u["a"])(o)||(o=new n["a"]),Y(this),O["a"].multiplyByPointAsVector(this._actualInvTransform,t,o)},M.prototype.cameraToWorldCoordinates=function(t,o){return Object(u["a"])(o)||(o=new s["a"]),Y(this),O["a"].multiplyByVector(this._actualTransform,t,o)},M.prototype.cameraToWorldCoordinatesPoint=function(t,o){return Object(u["a"])(o)||(o=new n["a"]),Y(this),O["a"].multiplyByPoint(this._actualTransform,t,o)},M.prototype.cameraToWorldCoordinatesVector=function(t,o){return Object(u["a"])(o)||(o=new n["a"]),Y(this),O["a"].multiplyByPointAsVector(this._actualTransform,t,o)};const Et=new n["a"];M.prototype.move=function(t,o){const i=this.position;n["a"].multiplyByScalar(t,o,Et),n["a"].add(i,Et,i),this._mode===x["a"].SCENE2D&&Ot(this,i),this._adjustOrthographicFrustum(!0)},M.prototype.moveForward=function(t){t=Object(c["a"])(t,this.defaultMoveAmount),this._mode===x["a"].SCENE2D?St(this,t):this.move(this.direction,t)},M.prototype.moveBackward=function(t){t=Object(c["a"])(t,this.defaultMoveAmount),this._mode===x["a"].SCENE2D?St(this,-t):this.move(this.direction,-t)},M.prototype.moveUp=function(t){t=Object(c["a"])(t,this.defaultMoveAmount),this.move(this.up,t)},M.prototype.moveDown=function(t){t=Object(c["a"])(t,this.defaultMoveAmount),this.move(this.up,-t)},M.prototype.moveRight=function(t){t=Object(c["a"])(t,this.defaultMoveAmount),this.move(this.right,t)},M.prototype.moveLeft=function(t){t=Object(c["a"])(t,this.defaultMoveAmount),this.move(this.right,-t)},M.prototype.lookLeft=function(t){t=Object(c["a"])(t,this.defaultLookAmount),this._mode!==x["a"].SCENE2D&&this.look(this.up,-t)},M.prototype.lookRight=function(t){t=Object(c["a"])(t,this.defaultLookAmount),this._mode!==x["a"].SCENE2D&&this.look(this.up,t)},M.prototype.lookUp=function(t){t=Object(c["a"])(t,this.defaultLookAmount),this._mode!==x["a"].SCENE2D&&this.look(this.right,-t)},M.prototype.lookDown=function(t){t=Object(c["a"])(t,this.defaultLookAmount),this._mode!==x["a"].SCENE2D&&this.look(this.right,t)};const wt=new W["a"],Wt=new y["a"];M.prototype.look=function(t,o){const i=Object(c["a"])(o,this.defaultLookAmount),a=W["a"].fromAxisAngle(t,-i,wt),e=y["a"].fromQuaternion(a,Wt),n=this.direction,s=this.up,r=this.right;y["a"].multiplyByVector(e,n,n),y["a"].multiplyByVector(e,s,s),y["a"].multiplyByVector(e,r,r)},M.prototype.twistLeft=function(t){t=Object(c["a"])(t,this.defaultLookAmount),this.look(this.direction,t)},M.prototype.twistRight=function(t){t=Object(c["a"])(t,this.defaultLookAmount),this.look(this.direction,-t)};const It=new W["a"],bt=new y["a"];M.prototype.rotate=function(t,o){const i=Object(c["a"])(o,this.defaultRotateAmount),a=W["a"].fromAxisAngle(t,-i,It),e=y["a"].fromQuaternion(a,bt);y["a"].multiplyByVector(e,this.position,this.position),y["a"].multiplyByVector(e,this.direction,this.direction),y["a"].multiplyByVector(e,this.up,this.up),n["a"].cross(this.direction,this.up,this.right),n["a"].cross(this.right,this.direction,this.up),this._adjustOrthographicFrustum(!1)},M.prototype.rotateDown=function(t){t=Object(c["a"])(t,this.defaultRotateAmount),Mt(this,t)},M.prototype.rotateUp=function(t){t=Object(c["a"])(t,this.defaultRotateAmount),Mt(this,-t)};const vt=new n["a"],Pt=new n["a"],jt=new n["a"],xt=new n["a"];function Mt(t,o){const i=t.position;if(Object(u["a"])(t.constrainedAxis)&&!n["a"].equalsEpsilon(t.position,n["a"].ZERO,T["a"].EPSILON2)){const a=n["a"].normalize(i,vt),e=n["a"].equalsEpsilon(a,t.constrainedAxis,T["a"].EPSILON2),s=n["a"].equalsEpsilon(a,n["a"].negate(t.constrainedAxis,xt),T["a"].EPSILON2);if(e||s)(e&&o<0||s&&o>0)&&t.rotate(t.right,o);else{const i=n["a"].normalize(t.constrainedAxis,Pt);let e=n["a"].dot(a,i),s=T["a"].acosClamped(e);o>0&&o>s&&(o=s-T["a"].EPSILON4),e=n["a"].dot(a,n["a"].negate(i,xt)),s=T["a"].acosClamped(e),o<0&&-o>s&&(o=-s+T["a"].EPSILON4);const r=n["a"].cross(i,a,jt);t.rotate(r,o)}}else t.rotate(t.right,o)}function Nt(t,o){Object(u["a"])(t.constrainedAxis)?t.rotate(t.constrainedAxis,o):t.rotate(t.up,o)}function St(t,o){const i=t.frustum;let a;if(o*=.5,Math.abs(i.top)+Math.abs(i.bottom)>Math.abs(i.left)+Math.abs(i.right)){let e=i.top-o,n=i.bottom+o,s=t._maxCoord.y;t._scene.mapMode2D===j["a"].ROTATE&&(s*=t.maximumZoomFactor),n>s&&(n=s,e=-s),e<=n&&(e=1,n=-1),a=i.right/i.top,i.top=e,i.bottom=n,i.right=i.top*a,i.left=-i.right}else{let e=i.right-o,n=i.left+o,s=t._maxCoord.x;t._scene.mapMode2D===j["a"].ROTATE&&(s*=t.maximumZoomFactor),e>s&&(e=s,n=-s),e<=n&&(e=1,n=-1),a=i.top/i.right,i.right=e,i.left=n,i.top=i.right*a,i.bottom=-i.top}}function Rt(t,o){t.move(t.direction,o)}M.prototype.rotateRight=function(t){t=Object(c["a"])(t,this.defaultRotateAmount),Nt(this,-t)},M.prototype.rotateLeft=function(t){t=Object(c["a"])(t,this.defaultRotateAmount),Nt(this,t)},M.prototype.zoomIn=function(t){t=Object(c["a"])(t,this.defaultZoomAmount),this._mode===x["a"].SCENE2D?St(this,t):Rt(this,t)},M.prototype.zoomOut=function(t){t=Object(c["a"])(t,this.defaultZoomAmount),this._mode===x["a"].SCENE2D?St(this,-t):Rt(this,-t)},M.prototype.getMagnitude=function(){return this._mode===x["a"].SCENE3D?n["a"].magnitude(this.position):this._mode===x["a"].COLUMBUS_VIEW?Math.abs(this.position.z):this._mode===x["a"].SCENE2D?Math.max(this.frustum.right-this.frustum.left,this.frustum.top-this.frustum.bottom):void 0};const At=new O["a"];M.prototype.lookAt=function(t,o){const i=v["a"].eastNorthUpToFixedFrame(t,l["a"].WGS84,At);this.lookAtTransform(i,o)};const Dt=new n["a"],Ft=new W["a"],Vt=new W["a"],Bt=new y["a"];function zt(t,o,i){o=T["a"].clamp(o,-T["a"].PI_OVER_TWO,T["a"].PI_OVER_TWO),t=T["a"].zeroToTwoPi(t)-T["a"].PI_OVER_TWO;const a=W["a"].fromAxisAngle(n["a"].UNIT_Y,-o,Ft),e=W["a"].fromAxisAngle(n["a"].UNIT_Z,-t,Vt),s=W["a"].multiply(e,a,e),r=y["a"].fromQuaternion(s,Bt),c=n["a"].clone(n["a"].UNIT_X,Dt);return y["a"].multiplyByVector(r,c,c),n["a"].negate(c,c),n["a"].multiplyByScalar(c,i,c),c}M.prototype.lookAtTransform=function(t,o){if(this._setTransform(t),!Object(u["a"])(o))return;let i;if(i=Object(u["a"])(o.heading)?zt(o.heading,o.pitch,o.range):o,this._mode===x["a"].SCENE2D){e["a"].clone(e["a"].ZERO,this.position),n["a"].negate(i,this.up),this.up.z=0,n["a"].magnitudeSquared(this.up)<T["a"].EPSILON10&&n["a"].clone(n["a"].UNIT_Y,this.up),n["a"].normalize(this.up,this.up),this._setTransform(O["a"].IDENTITY),n["a"].negate(n["a"].UNIT_Z,this.direction),n["a"].cross(this.direction,this.up,this.right),n["a"].normalize(this.right,this.right);const o=this.frustum,a=o.top/o.right;return o.right=.5*n["a"].magnitude(i),o.left=-o.right,o.top=a*o.right,o.bottom=-o.top,void this._setTransform(t)}n["a"].clone(i,this.position),n["a"].negate(this.position,this.direction),n["a"].normalize(this.direction,this.direction),n["a"].cross(this.direction,n["a"].UNIT_Z,this.right),n["a"].magnitudeSquared(this.right)<T["a"].EPSILON10&&n["a"].clone(n["a"].UNIT_X,this.right),n["a"].normalize(this.right,this.right),n["a"].cross(this.right,this.direction,this.up),n["a"].normalize(this.up,this.up),this._adjustOrthographicFrustum(!0)};const Lt=new r["a"],Ut=new r["a"],kt=new n["a"],Ht=new n["a"],Yt=new n["a"],qt=new n["a"],Zt=new n["a"],Gt=new n["a"],Xt=new n["a"],Jt=new n["a"],Qt={direction:new n["a"],right:new n["a"],up:new n["a"]};let Kt;function $t(t,o,i,a){const e=Math.abs(n["a"].dot(o,i));return e/a-n["a"].dot(t,i)}function to(t,o,i,a){const e=t._projection.ellipsoid,s=a?t:Qt,r=o.north,c=o.south;let h=o.east;const l=o.west;l>h&&(h+=T["a"].TWO_PI);const m=.5*(l+h);let p;if(c<-T["a"].PI_OVER_TWO+T["a"].RADIANS_PER_DEGREE&&r>T["a"].PI_OVER_TWO-T["a"].RADIANS_PER_DEGREE)p=0;else{const t=Lt;t.longitude=m,t.latitude=r,t.height=0;const o=Ut;o.longitude=m,o.latitude=c,o.height=0;let i=Kt;Object(u["a"])(i)&&i.ellipsoid===e||(Kt=i=new d["a"](void 0,void 0,e)),i.setEndPoints(t,o),p=i.interpolateUsingFraction(.5,Lt).latitude}const f=Lt;f.longitude=m,f.latitude=p,f.height=0;const _=e.cartographicToCartesian(f,Xt),g=Lt;g.longitude=h,g.latitude=r;const C=e.cartographicToCartesian(g,kt);g.longitude=l;const y=e.cartographicToCartesian(g,Yt);g.longitude=m;const O=e.cartographicToCartesian(g,Zt);g.latitude=c;const w=e.cartographicToCartesian(g,Gt);g.longitude=h;const W=e.cartographicToCartesian(g,qt);g.longitude=l;const I=e.cartographicToCartesian(g,Ht);n["a"].subtract(y,_,y),n["a"].subtract(W,_,W),n["a"].subtract(C,_,C),n["a"].subtract(I,_,I),n["a"].subtract(O,_,O),n["a"].subtract(w,_,w);const b=e.geodeticSurfaceNormal(_,s.direction);n["a"].negate(b,b);const v=n["a"].cross(b,n["a"].UNIT_Z,s.right);n["a"].normalize(v,v);const P=n["a"].cross(v,b,s.up);let j;if(t.frustum instanceof E["a"]){const o=Math.max(n["a"].distance(C,y),n["a"].distance(W,I)),i=Math.max(n["a"].distance(C,W),n["a"].distance(y,I));let a,e;const s=t.frustum._offCenterFrustum.right/t.frustum._offCenterFrustum.top,r=i*s;o>r?(a=o,e=a/s):(e=i,a=r),j=Math.max(a,e)}else{const o=Math.tan(.5*t.frustum.fovy),i=t.frustum.aspectRatio*o;if(j=Math.max($t(b,P,y,o),$t(b,P,W,o),$t(b,P,C,o),$t(b,P,I,o),$t(b,P,O,o),$t(b,P,w,o),$t(b,v,y,i),$t(b,v,W,i),$t(b,v,C,i),$t(b,v,I,i),$t(b,v,O,i),$t(b,v,w,i)),c<0&&r>0){const t=Lt;t.longitude=l,t.latitude=0,t.height=0;let a=e.cartographicToCartesian(t,Jt);n["a"].subtract(a,_,a),j=Math.max(j,$t(b,P,a,o),$t(b,v,a,i)),t.longitude=h,a=e.cartographicToCartesian(t,Jt),n["a"].subtract(a,_,a),j=Math.max(j,$t(b,P,a,o),$t(b,v,a,i))}}return n["a"].add(_,n["a"].multiplyByScalar(b,-j,Jt),i)}const oo=new r["a"],io=new n["a"],ao=new n["a"];function eo(t,o,i){const a=t._projection;o.west>o.east&&(o=b["a"].MAX_VALUE);const e=t._actualTransform,n=t._actualInvTransform,s=oo;s.longitude=o.east,s.latitude=o.north;const r=a.project(s,io);O["a"].multiplyByPoint(e,r,r),O["a"].multiplyByPoint(n,r,r),s.longitude=o.west,s.latitude=o.south;const c=a.project(s,ao);if(O["a"].multiplyByPoint(e,c,c),O["a"].multiplyByPoint(n,c,c),i.x=.5*(r.x-c.x)+c.x,i.y=.5*(r.y-c.y)+c.y,Object(u["a"])(t.frustum.fovy)){const o=Math.tan(.5*t.frustum.fovy),a=t.frustum.aspectRatio*o;i.z=.5*Math.max((r.x-c.x)/a,(r.y-c.y)/o)}else{const t=r.x-c.x,o=r.y-c.y;i.z=Math.max(t,o)}return i}const no=new r["a"],so=new n["a"],ro=new n["a"];function co(t,o,i){const a=t._projection;let e=o.east;o.west>o.east&&(t._scene.mapMode2D===j["a"].INFINITE_SCROLL?e+=T["a"].TWO_PI:(o=b["a"].MAX_VALUE,e=o.east));let n=no;n.longitude=e,n.latitude=o.north;const s=a.project(n,so);n.longitude=o.west,n.latitude=o.south;const r=a.project(n,ro),c=.5*Math.abs(s.x-r.x);let u,h,l=.5*Math.abs(s.y-r.y);const d=t.frustum.right/t.frustum.top,m=l*d;return c>m?(u=c,h=u/d):(h=l,u=m),l=Math.max(2*u,2*h),i.x=.5*(s.x-r.x)+r.x,i.y=.5*(s.y-r.y)+r.y,n=a.unproject(i,n),n.height=l,i=a.project(n,i),i}M.prototype.getRectangleCameraCoordinates=function(t,o){const i=this._mode;return Object(u["a"])(o)||(o=new n["a"]),i===x["a"].SCENE3D?to(this,t,o):i===x["a"].COLUMBUS_VIEW?eo(this,t,o):i===x["a"].SCENE2D?co(this,t,o):void 0};const uo=new I["a"];function ho(t,o,i,a){i=Object(c["a"])(i,l["a"].WGS84);const e=t.getPickRay(o,uo),n=C["a"].rayEllipsoid(e,i);if(!n)return;const s=n.start>0?n.start:n.stop;return I["a"].getPoint(e,s,a)}const lo=new I["a"];function mo(t,o,i,a){const e=t.getPickRay(o,lo);let s=e.origin;s=n["a"].fromElements(s.y,s.z,0,s);const r=i.unproject(s);if(!(r.latitude<-T["a"].PI_OVER_TWO||r.latitude>T["a"].PI_OVER_TWO))return i.ellipsoid.cartographicToCartesian(r,a)}const po=new I["a"];function fo(t,o,i,a){const e=t.getPickRay(o,po),s=-e.origin.x/e.direction.x;I["a"].getPoint(e,s,a);const r=i.unproject(new n["a"](a.y,a.z,0));if(!(r.latitude<-T["a"].PI_OVER_TWO||r.latitude>T["a"].PI_OVER_TWO||r.longitude<-Math.PI||r.longitude>Math.PI))return i.ellipsoid.cartographicToCartesian(r,a)}M.prototype.pickEllipsoid=function(t,o,i){const a=this._scene.canvas;if(0!==a.clientWidth&&0!==a.clientHeight){if(Object(u["a"])(i)||(i=new n["a"]),o=Object(c["a"])(o,l["a"].WGS84),this._mode===x["a"].SCENE3D)i=ho(this,t,o,i);else if(this._mode===x["a"].SCENE2D)i=mo(this,t,this._projection,i);else{if(this._mode!==x["a"].COLUMBUS_VIEW)return;i=fo(this,t,this._projection,i)}return i}};const _o=new n["a"],go=new n["a"],Co=new n["a"];function To(t,o,i){const a=t._scene.canvas,e=a.clientWidth,s=a.clientHeight,r=Math.tan(.5*t.frustum.fovy),c=t.frustum.aspectRatio*r,u=t.frustum.near,h=2/e*o.x-1,l=2/s*(s-o.y)-1,d=t.positionWC;n["a"].clone(d,i.origin);const m=n["a"].multiplyByScalar(t.directionWC,u,_o);n["a"].add(d,m,m);const p=n["a"].multiplyByScalar(t.rightWC,h*u*c,go),f=n["a"].multiplyByScalar(t.upWC,l*u*r,Co),_=n["a"].add(m,p,i.direction);return n["a"].add(_,f,_),n["a"].subtract(_,d,_),n["a"].normalize(_,_),i}const yo=new n["a"];function Oo(t,o,i){const a=t._scene.canvas,e=a.clientWidth,s=a.clientHeight;let r=t.frustum;Object(u["a"])(r._offCenterFrustum)&&(r=r._offCenterFrustum);let c=2/e*o.x-1;c*=.5*(r.right-r.left);let h=2/s*(s-o.y)-1;h*=.5*(r.top-r.bottom);const l=i.origin;return n["a"].clone(t.position,l),n["a"].multiplyByScalar(t.right,c,yo),n["a"].add(yo,l,l),n["a"].multiplyByScalar(t.up,h,yo),n["a"].add(yo,l,l),n["a"].clone(t.directionWC,i.direction),t._mode!==x["a"].COLUMBUS_VIEW&&t._mode!==x["a"].SCENE2D||n["a"].fromElements(i.origin.z,i.origin.x,i.origin.y,i.origin),i}M.prototype.getPickRay=function(t,o){Object(u["a"])(o)||(o=new I["a"]);const i=this._scene.canvas;if(i.clientWidth<=0||i.clientHeight<=0)return;const a=this.frustum;return Object(u["a"])(a.aspectRatio)&&Object(u["a"])(a.fov)&&Object(u["a"])(a.near)?To(this,t,o):Oo(this,t,o)};const Eo=new n["a"],wo=new n["a"];M.prototype.distanceToBoundingSphere=function(t){const o=n["a"].subtract(this.positionWC,t.center,Eo),i=n["a"].multiplyByScalar(this.directionWC,n["a"].dot(o,this.directionWC),wo);return Math.max(0,n["a"].magnitude(i)-t.radius)};const Wo=new e["a"];function Io(t,o,i,a,e,s){const r=n["a"].clone(o);function c(i){const a=n["a"].lerp(o,r,i.time,new n["a"]);t.worldToCameraCoordinatesPoint(a,t.position)}return i.y>a?r.y-=i.y-a:i.y<-a&&(r.y+=-a-i.y),i.z>e?r.z-=i.z-e:i.z<-e&&(r.z+=-e-i.z),{easingFunction:h["a"].EXPONENTIAL_OUT,startObject:{time:0},stopObject:{time:1},duration:s,update:c}}M.prototype.getPixelSize=function(t,o,i){const a=this.distanceToBoundingSphere(t),e=this.frustum.getPixelDimensions(o,i,a,this._scene.pixelRatio,Wo);return Math.max(e.x,e.y)};const bo=new n["a"],vo=new n["a"],Po=new n["a"],jo=new n["a"];function xo(t,o){let i=t.position;const a=t.direction,e=t.worldToCameraCoordinatesVector(n["a"].UNIT_X,bo),s=-n["a"].dot(e,i)/n["a"].dot(e,a),r=n["a"].add(i,n["a"].multiplyByScalar(a,s,vo),vo);t.cameraToWorldCoordinatesPoint(r,r),i=t.cameraToWorldCoordinatesPoint(t.position,Po);const c=Math.tan(.5*t.frustum.fovy),u=t.frustum.aspectRatio*c,h=n["a"].magnitude(n["a"].subtract(i,r,jo)),l=u*h,d=c*h,m=t._maxCoord.x,p=t._maxCoord.y,f=Math.max(l-m,m),_=Math.max(d-p,p);if(i.z<-f||i.z>f||i.y<-_||i.y>_){const a=r.y<-f||r.y>f,e=r.z<-_||r.z>_;if(a||e)return Io(t,i,r,f,_,o)}}M.prototype.createCorrectPositionTween=function(t){if(this._mode===x["a"].COLUMBUS_VIEW)return xo(this,t)};const Mo=new n["a"],No={destination:void 0,heading:void 0,pitch:void 0,roll:void 0,duration:void 0,complete:void 0,cancel:void 0,endTransform:void 0,maximumHeight:void 0,easingFunction:void 0};function So(t,o){const i=t.frustum,a=Math.tan(.5*i.fovy),e=i.aspectRatio*a;return Math.max(o/e,o/a)}function Ro(t,o){let i,a,e=t.frustum;Object(u["a"])(e._offCenterFrustum)&&(e=e._offCenterFrustum);const n=e.right/e.top,s=o*n;return o>s?(i=o,a=i/n):(a=o,i=s),1.5*Math.max(i,a)}M.prototype.cancelFlight=function(){Object(u["a"])(this._currentFlight)&&(this._currentFlight.cancelTween(),this._currentFlight=void 0)},M.prototype.completeFlight=function(){if(Object(u["a"])(this._currentFlight)){this._currentFlight.cancelTween();const t={destination:void 0,orientation:{heading:void 0,pitch:void 0,roll:void 0}};t.destination=No.destination,t.orientation.heading=No.heading,t.orientation.pitch=No.pitch,t.orientation.roll=No.roll,this.setView(t),Object(u["a"])(this._currentFlight.complete)&&this._currentFlight.complete(),this._currentFlight=void 0}},M.prototype.flyTo=function(t){t=Object(c["a"])(t,c["a"].EMPTY_OBJECT);let o=t.destination;const i=this._mode;if(i===x["a"].MORPHING)return;this.cancelFlight();let a=Object(c["a"])(t.orientation,c["a"].EMPTY_OBJECT);if(Object(u["a"])(a.direction)&&(a=gt(this,o,a,Ct.orientation)),Object(u["a"])(t.duration)&&t.duration<=0){const o=Ct;return o.destination=t.destination,o.orientation.heading=a.heading,o.orientation.pitch=a.pitch,o.orientation.roll=a.roll,o.convert=t.convert,o.endTransform=t.endTransform,this.setView(o),void("function"===typeof t.complete&&t.complete())}const e=Object(u["a"])(o.west);e&&(o=this.getRectangleCameraCoordinates(o,Mo));const n=this;let s;No.destination=o,No.heading=a.heading,No.pitch=a.pitch,No.roll=a.roll,No.duration=t.duration,No.complete=function(){s===n._currentFlight&&(n._currentFlight=void 0),Object(u["a"])(t.complete)&&t.complete()},No.cancel=t.cancel,No.endTransform=t.endTransform,No.convert=!e&&t.convert,No.maximumHeight=t.maximumHeight,No.pitchAdjustHeight=t.pitchAdjustHeight,No.flyOverLongitude=t.flyOverLongitude,No.flyOverLongitudeWeight=t.flyOverLongitudeWeight,No.easingFunction=t.easingFunction;const r=this._scene,h=P["a"].createTween(r,No);if(0===h.duration)return void("function"===typeof h.complete&&h.complete());s=r.tweens.add(h),this._currentFlight=s;let l=this._scene.preloadFlightCamera;this._mode!==x["a"].SCENE2D&&(Object(u["a"])(l)||(l=M.clone(this)),l.setView({destination:o,orientation:a}),this._scene.preloadFlightCullingVolume=l.frustum.computeCullingVolume(l.positionWC,l.directionWC,l.upWC))};const Ao=100;function Do(t,o,i){i=f["a"].clone(Object(u["a"])(i)?i:M.DEFAULT_OFFSET);const a=t._scene.screenSpaceCameraController.minimumZoomDistance,e=t._scene.screenSpaceCameraController.maximumZoomDistance,n=i.range;if(!Object(u["a"])(n)||0===n){const n=o.radius;0===n?i.range=Ao:t.frustum instanceof E["a"]||t._mode===x["a"].SCENE2D?i.range=Ro(t,n):i.range=So(t,n),i.range=T["a"].clamp(i.range,a,e)}return i}M.prototype.viewBoundingSphere=function(t,o){o=Do(this,t,o),this.lookAt(t.center,o)};const Fo=new O["a"],Vo=new n["a"],Bo=new n["a"],zo=new n["a"],Lo=new n["a"],Uo=new s["a"],ko=new W["a"],Ho=new y["a"];M.prototype.flyToBoundingSphere=function(t,o){o=Object(c["a"])(o,c["a"].EMPTY_OBJECT);const i=this._mode===x["a"].SCENE2D||this._mode===x["a"].COLUMBUS_VIEW;this._setTransform(O["a"].IDENTITY);const a=Do(this,t,o.offset);let e;e=i?n["a"].multiplyByScalar(n["a"].UNIT_Z,a.range,Vo):zt(a.heading,a.pitch,a.range);const s=v["a"].eastNorthUpToFixedFrame(t.center,l["a"].WGS84,Fo);let r,u;if(O["a"].multiplyByPoint(s,e,e),!i){if(r=n["a"].subtract(t.center,e,Bo),n["a"].normalize(r,r),u=O["a"].multiplyByPointAsVector(s,n["a"].UNIT_Z,zo),1-Math.abs(n["a"].dot(r,u))<T["a"].EPSILON6){const t=W["a"].fromAxisAngle(r,a.heading,ko),o=y["a"].fromQuaternion(t,Ho);n["a"].fromCartesian4(O["a"].getColumn(s,1,Uo),u),y["a"].multiplyByVector(o,u,u)}const o=n["a"].cross(r,u,Lo);n["a"].cross(o,r,u),n["a"].normalize(u,u)}this.flyTo({destination:e,orientation:{direction:r,up:u},duration:o.duration,complete:o.complete,cancel:o.cancel,endTransform:o.endTransform,maximumHeight:o.maximumHeight,easingFunction:o.easingFunction,flyOverLongitude:o.flyOverLongitude,flyOverLongitudeWeight:o.flyOverLongitudeWeight,pitchAdjustHeight:o.pitchAdjustHeight})};const Yo=new n["a"],qo=new n["a"],Zo=new n["a"],Go=new n["a"],Xo=[new n["a"],new n["a"],new n["a"],new n["a"]];function Jo(t,o){const i=o.radii,a=t.positionWC,e=n["a"].multiplyComponents(o.oneOverRadii,a,Yo),s=n["a"].magnitude(e),r=n["a"].normalize(e,qo);let c,u;n["a"].equalsEpsilon(r,n["a"].UNIT_Z,T["a"].EPSILON10)?(c=new n["a"](0,1,0),u=new n["a"](0,0,1)):(c=n["a"].normalize(n["a"].cross(n["a"].UNIT_Z,r,Zo),Zo),u=n["a"].normalize(n["a"].cross(r,c,Go),Go));const h=Math.sqrt(n["a"].magnitudeSquared(e)-1),l=n["a"].multiplyByScalar(r,1/s,Yo),d=h/s,m=n["a"].multiplyByScalar(c,d,qo),p=n["a"].multiplyByScalar(u,d,Zo),f=n["a"].add(l,p,Xo[0]);n["a"].subtract(f,m,f),n["a"].multiplyComponents(i,f,f);const _=n["a"].subtract(l,p,Xo[1]);n["a"].subtract(_,m,_),n["a"].multiplyComponents(i,_,_);const g=n["a"].subtract(l,p,Xo[2]);n["a"].add(g,m,g),n["a"].multiplyComponents(i,g,g);const C=n["a"].add(l,p,Xo[3]);return n["a"].add(C,m,C),n["a"].multiplyComponents(i,C,C),Xo}const Qo=new e["a"],Ko=new n["a"],$o=[new r["a"],new r["a"],new r["a"],new r["a"]];function ti(t,o,i,a,e,n){Qo.x=t,Qo.y=o;const s=a.pickEllipsoid(Qo,e,Ko);return Object(u["a"])(s)?($o[i]=e.cartesianToCartographic(s,$o[i]),1):($o[i]=e.cartesianToCartographic(n[i],$o[i]),0)}M.prototype.computeViewRectangle=function(t,o){t=Object(c["a"])(t,l["a"].WGS84);const i=this.frustum.computeCullingVolume(this.positionWC,this.directionWC,this.upWC),e=new a["a"](n["a"].ZERO,t.maximumRadius),s=i.computeVisibility(e);if(s===g["a"].OUTSIDE)return;const r=this._scene.canvas,u=r.clientWidth,h=r.clientHeight;let d=0;const m=Jo(this,t);if(d+=ti(0,0,0,this,t,m),d+=ti(0,h,1,this,t,m),d+=ti(u,h,2,this,t,m),d+=ti(u,0,3,this,t,m),d<2)return b["a"].MAX_VALUE;o=b["a"].fromCartographicArray($o,o);let p=0,f=$o[3].longitude;for(let a=0;a<4;++a){const t=$o[a].longitude,o=Math.abs(t-f);o>T["a"].PI?p+=T["a"].TWO_PI-o:p+=o,f=t}return T["a"].equalsEpsilon(Math.abs(p),T["a"].TWO_PI,T["a"].EPSILON9)&&(o.west=-T["a"].PI,o.east=T["a"].PI,$o[0].latitude>=0?o.north=T["a"].PI_OVER_TWO:o.south=-T["a"].PI_OVER_TWO),o},M.prototype.switchToPerspectiveFrustum=function(){if(this._mode===x["a"].SCENE2D||this.frustum instanceof w["a"])return;const t=this._scene;this.frustum=new w["a"],this.frustum.aspectRatio=t.drawingBufferWidth/t.drawingBufferHeight,this.frustum.fov=T["a"].toRadians(60)},M.prototype.switchToOrthographicFrustum=function(){if(this._mode===x["a"].SCENE2D||this.frustum instanceof E["a"])return;const t=et(this),o=this._scene;this.frustum=new E["a"],this.frustum.aspectRatio=o.drawingBufferWidth/o.drawingBufferHeight,this.frustum.width=t},M.clone=function(t,o){return Object(u["a"])(o)||(o=new M(t._scene)),n["a"].clone(t.position,o.position),n["a"].clone(t.direction,o.direction),n["a"].clone(t.up,o.up),n["a"].clone(t.right,o.right),O["a"].clone(t._transform,o.transform),o._transformChanged=!0,o.frustum=t.frustum.clone(),o},o["a"]=M}}]);