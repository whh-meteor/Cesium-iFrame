(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Cesium~b286205d"],{"0a70":function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var a=n("2f63"),r=n("7d62"),s=n("de66"),o=n("75b2"),i=n("8a39"),u=n("b82e"),c=n("283e"),l=n("7d93"),d=n("5457"),h=n("9c94"),m=n("9a79"),_=n("80f9"),p=n("40ef");function f(t,e,n,r){this._tileset=t,this._tile=e,this._tilesetResource=n,this._contents=[],this._contentsCreated=!1;const s=Object(a["a"])(r.contents)?r.contents:r.content;this._innerContentHeaders=s,this._requestsInFlight=0,this._cancelCount=0;const i=this._innerContentHeaders.length;this._arrayFetchPromises=new Array(i),this._requests=new Array(i),this._innerContentResources=new Array(i),this._serverKeys=new Array(i);for(let a=0;a<i;a++){const t=n.getDerivedResource({url:s[a].uri}),e=o["a"].getServerKey(t.getUrlComponent());this._innerContentResources[a]=t,this._serverKeys[a]=e}this._contentsFetchedPromise=void 0}function C(t,e){t._requestsInFlight+=e,t.tileset.statistics.numberOfPendingRequests+=e}function g(t,e){t._cancelCount++,t._tile._contentState=e;const n=t.tileset.statistics;n.numberOfPendingRequests-=t._requestsInFlight,n.numberOfAttemptedRequests+=t._requestsInFlight,t._requestsInFlight=0;const a=t._innerContentHeaders.length;t._arrayFetchPromises=new Array(a)}function T(t){const e={};for(let n=0;n<t.length;n++){const r=t[n];Object(a["a"])(e[r])?e[r]++:e[r]=1}for(const n in e)if(e.hasOwnProperty(n)&&!o["a"].serverHasOpenSlots(n,e[n]))return!1;return o["a"].heapHasOpenSlots(t.length)}function S(t,e,n,r){const o=t._innerContentResources[e].clone(),c=t.tile,l=function(){return c._priority},d=t._serverKeys[e],h=new s["a"]({throttle:!0,throttleByServer:!0,type:u["a"].TILES3D,priorityFunction:l,serverKey:d});o.request=h,t._requests[e]=h;const m=o.fetchArrayBuffer();return Object(a["a"])(m)?m.then((function(e){if(!(n<t._cancelCount))return C(t,-1),e})).catch((function(a){n<t._cancelCount||(o.request.state!==i["a"].CANCELLED?(C(t,-1),w(t,e,a)):g(t,r))})):Promise.resolve(void 0)}function b(t){const e=t._cancelCount;return Promise.all(t._arrayFetchPromises).then((function(n){if(e<t._cancelCount)return;const r=n.map((function(e,n){if(Object(a["a"])(e))return O(t,e,n)}));t._contentsCreated=!0,t._contents=r.filter(a["a"])}))}function O(t,e,n){const r=Object(p["a"])(e);if(r.contentType===d["a"].EXTERNAL_TILESET){const e=new c["a"]("External tilesets are disallowed inside multiple contents");return w(t,n,e)}t._disableSkipLevelOfDetail=t._disableSkipLevelOfDetail||r.contentType===d["a"].GEOMETRY||r.contentType===d["a"].VECTOR;const s=t._tileset,o=t._innerContentResources[n],i=t._tile;let u;const f=h["a"][r.contentType];u=Object(a["a"])(r.binaryPayload)?f(s,i,o,r.binaryPayload.buffer,0):f(s,i,o,r.jsonPayload);const C=t._innerContentHeaders[n];if(i.hasImplicitContentMetadata){const t=i.implicitSubtree,e=i.implicitCoordinates;u.metadata=t.getContentMetadataView(e,n)}else i.hasImplicitContent||(u.metadata=Object(m["a"])(s,C));const g=Object(_["a"])(s,C);return Object(a["a"])(g)&&(u.group=new l["a"]({metadata:g})),u}function w(t,e,n){const r=t._tileset,s=t._innerContentResources[e].url,o=Object(a["a"])(n.message)?n.message:n.toString();r.tileFailed.numberOfListeners>0?r.tileFailed.raiseEvent({url:s,message:o}):(console.log("A content failed to load: "+s),console.log("Error: "+o))}Object.defineProperties(f.prototype,{featurePropertiesDirty:{get:function(){const t=this._contents,e=t.length;for(let n=0;n<e;++n)if(t[n].featurePropertiesDirty)return!0;return!1},set:function(t){const e=this._contents,n=e.length;for(let a=0;a<n;++a)e[a].featurePropertiesDirty=t}},featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){return this._contents}},readyPromise:{get:function(){if(!this._contentsCreated)return;const t=this._contents.map((function(t){return t.readyPromise})),e=this;return Promise.all(t).then((function(){return e}))}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){}},metadata:{get:function(){},set:function(){}},batchTable:{get:function(){}},group:{get:function(){},set:function(){}},innerContentUrls:{get:function(){return this._innerContentHeaders.map((function(t){return t.uri}))}},contentsFetchedPromise:{get:function(){return this._contentsFetchedPromise}}}),f.prototype.requestInnerContents=function(){if(!T(this._serverKeys))return this._serverKeys.length;const t=this._innerContentHeaders;C(this,t.length);for(let e=0;e<t.length;e++)this._arrayFetchPromises[e]=S(this,e,this._cancelCount,this._tile._contentState);return this._contentsFetchedPromise=b(this),0},f.prototype.cancelRequests=function(){for(let t=0;t<this._requests.length;t++){const e=this._requests[t];Object(a["a"])(e)&&e.cancel()}},f.prototype.hasProperty=function(t,e){return!1},f.prototype.getFeature=function(t){},f.prototype.applyDebugSettings=function(t,e){const n=this._contents,a=n.length;for(let r=0;r<a;++r)n[r].applyDebugSettings(t,e)},f.prototype.applyStyle=function(t){const e=this._contents,n=e.length;for(let a=0;a<n;++a)e[a].applyStyle(t)},f.prototype.update=function(t,e){const n=this._contents,a=n.length;for(let r=0;r<a;++r)n[r].update(t,e)},f.prototype.isDestroyed=function(){return!1},f.prototype.destroy=function(){const t=this._contents,e=t.length;for(let n=0;n<e;++n)t[n].destroy();return Object(r["a"])(this)}},dd7f:function(t,e,n){"use strict";var a=n("77af"),r=n("bd8d"),s=n("2f63"),o=n("7d62"),i=n("e42d"),u=n("daa2"),c=n("f845"),l=n("a894"),d=n("f630"),h=n("6ef5"),m=n("6dc0"),_=n("5770"),p=n("a913"),f=n("461c"),C=n("5950"),g=n("6f00"),T=n("30d2");function S(t){this._numSamples=1,this._translucentMultipassSupport=!1,this._translucentMRTSupport=!1;const e=t.colorBufferFloat&&t.depthTexture&&t.floatBlend;this._translucentMRTSupport=t.drawBuffers&&e,this._translucentMultipassSupport=!this._translucentMRTSupport&&e,this._opaqueFBO=void 0,this._opaqueTexture=void 0,this._depthStencilTexture=void 0,this._accumulationTexture=void 0,this._translucentFBO=new d["a"]({colorAttachmentsLength:this._translucentMRTSupport?2:1,createColorAttachments:!1,createDepthAttachments:!1,depth:!0}),this._alphaFBO=new d["a"]({createColorAttachments:!1,createDepthAttachments:!1,depth:!0}),this._adjustTranslucentFBO=new d["a"]({colorAttachmentsLength:this._translucentMRTSupport?2:1,createColorAttachments:!1}),this._adjustAlphaFBO=new d["a"]({createColorAttachments:!1}),this._opaqueClearCommand=new c["a"]({color:new r["a"](0,0,0,0),owner:this}),this._translucentMRTClearCommand=new c["a"]({color:new r["a"](0,0,0,1),owner:this}),this._translucentMultipassClearCommand=new c["a"]({color:new r["a"](0,0,0,0),owner:this}),this._alphaClearCommand=new c["a"]({color:new r["a"](1,1,1,1),owner:this}),this._translucentRenderStateCache={},this._alphaRenderStateCache={},this._compositeCommand=void 0,this._adjustTranslucentCommand=void 0,this._adjustAlphaCommand=void 0,this._viewport=new a["a"],this._rs=void 0,this._useScissorTest=!1,this._scissorRectangle=void 0,this._useHDR=!1}function b(t){t._accumulationTexture=t._accumulationTexture&&!t._accumulationTexture.isDestroyed()&&t._accumulationTexture.destroy(),t._revealageTexture=t._revealageTexture&&!t._revealageTexture.isDestroyed()&&t._revealageTexture.destroy()}function O(t){t._translucentFBO.destroy(),t._alphaFBO.destroy(),t._adjustTranslucentFBO.destroy(),t._adjustAlphaFBO.destroy()}function w(t){b(t),O(t)}function v(t,e,n,a){b(t),t._accumulationTexture=new p["a"]({context:e,width:n,height:a,pixelFormat:i["a"].RGBA,pixelDatatype:h["a"].FLOAT});const r=new Float32Array(n*a*4);t._revealageTexture=new p["a"]({context:e,pixelFormat:i["a"].RGBA,pixelDatatype:h["a"].FLOAT,source:{arrayBufferView:r,width:n,height:a},flipY:!1})}function F(t,e){O(t);const n=u["a"].FRAMEBUFFER_COMPLETE;let a=!0;const r=t._accumulationTexture.width,s=t._accumulationTexture.height;if(t._translucentMRTSupport&&(t._translucentFBO.setColorTexture(t._accumulationTexture,0),t._translucentFBO.setColorTexture(t._revealageTexture,1),t._translucentFBO.setDepthStencilTexture(t._depthStencilTexture),t._translucentFBO.update(e,r,s),t._adjustTranslucentFBO.setColorTexture(t._accumulationTexture,0),t._adjustTranslucentFBO.setColorTexture(t._revealageTexture,1),t._adjustTranslucentFBO.update(e,r,s),t._translucentFBO.status===n&&t._adjustTranslucentFBO.status===n||(O(t),t._translucentMRTSupport=!1)),!t._translucentMRTSupport){t._translucentFBO.setColorTexture(t._accumulationTexture),t._translucentFBO.setDepthStencilTexture(t._depthStencilTexture),t._translucentFBO.update(e,r,s),t._alphaFBO.setColorTexture(t._revealageTexture),t._alphaFBO.setDepthStencilTexture(t._depthStencilTexture),t._alphaFBO.update(e,r,s),t._adjustTranslucentFBO.setColorTexture(t._accumulationTexture),t._adjustTranslucentFBO.update(e,r,s),t._adjustAlphaFBO.setColorTexture(t._revealageTexture),t._adjustAlphaFBO.update(e,r,s);const o=t._translucentFBO.status===n,i=t._alphaFBO.status===n,u=t._adjustTranslucentFBO.status===n,c=t._adjustAlphaFBO.status===n;o&&i&&u&&c||(w(t),t._translucentMultipassSupport=!1,a=!1)}return a}S.prototype.update=function(t,e,n,r,o){if(!this.isSupported())return;this._opaqueFBO=n,this._opaqueTexture=n.getColorTexture(0),this._depthStencilTexture=n.getDepthStencilTexture();const i=this._opaqueTexture.width,u=this._opaqueTexture.height,c=this._accumulationTexture,l=!Object(s["a"])(c)||c.width!==i||c.height!==u||r!==this._useHDR,d=this._numSamples!==o;if((l||d)&&(this._numSamples=o,v(this,t,i,u)),(!Object(s["a"])(this._translucentFBO.framebuffer)||l||d)&&!F(this,t))return;this._useHDR=r;const h=this;let p,g;Object(s["a"])(this._compositeCommand)||(p=new _["a"]({sources:[C["a"]]}),this._translucentMRTSupport&&p.defines.push("MRT"),g={u_opaque:function(){return h._opaqueTexture},u_accumulation:function(){return h._accumulationTexture},u_revealage:function(){return h._revealageTexture}},this._compositeCommand=t.createViewportQuadCommand(p,{uniformMap:g,owner:this})),Object(s["a"])(this._adjustTranslucentCommand)||(this._translucentMRTSupport?(p=new _["a"]({defines:["MRT"],sources:[f["a"]]}),g={u_bgColor:function(){return h._translucentMRTClearCommand.color},u_depthTexture:function(){return h._depthStencilTexture}},this._adjustTranslucentCommand=t.createViewportQuadCommand(p,{uniformMap:g,owner:this})):this._translucentMultipassSupport&&(p=new _["a"]({sources:[f["a"]]}),g={u_bgColor:function(){return h._translucentMultipassClearCommand.color},u_depthTexture:function(){return h._depthStencilTexture}},this._adjustTranslucentCommand=t.createViewportQuadCommand(p,{uniformMap:g,owner:this}),g={u_bgColor:function(){return h._alphaClearCommand.color},u_depthTexture:function(){return h._depthStencilTexture}},this._adjustAlphaCommand=t.createViewportQuadCommand(p,{uniformMap:g,owner:this}))),this._viewport.width=i,this._viewport.height=u;const T=!a["a"].equals(this._viewport,e.viewport);let S=T!==this._useScissorTest;this._useScissorTest=T,a["a"].equals(this._scissorRectangle,e.viewport)||(this._scissorRectangle=a["a"].clone(e.viewport,this._scissorRectangle),S=!0),Object(s["a"])(this._rs)&&a["a"].equals(this._viewport,this._rs.viewport)&&!S||(this._rs=m["a"].fromCache({viewport:this._viewport,scissorTest:{enabled:this._useScissorTest,rectangle:this._scissorRectangle}})),Object(s["a"])(this._compositeCommand)&&(this._compositeCommand.renderState=this._rs),this._adjustTranslucentCommand&&(this._adjustTranslucentCommand.renderState=this._rs),Object(s["a"])(this._adjustAlphaCommand)&&(this._adjustAlphaCommand.renderState=this._rs)};const y={enabled:!0,color:new r["a"](0,0,0,0),equationRgb:g["a"].ADD,equationAlpha:g["a"].ADD,functionSourceRgb:T["a"].ONE,functionDestinationRgb:T["a"].ONE,functionSourceAlpha:T["a"].ZERO,functionDestinationAlpha:T["a"].ONE_MINUS_SOURCE_ALPHA},x={enabled:!0,color:new r["a"](0,0,0,0),equationRgb:g["a"].ADD,equationAlpha:g["a"].ADD,functionSourceRgb:T["a"].ONE,functionDestinationRgb:T["a"].ONE,functionSourceAlpha:T["a"].ONE,functionDestinationAlpha:T["a"].ONE},j={enabled:!0,color:new r["a"](0,0,0,0),equationRgb:g["a"].ADD,equationAlpha:g["a"].ADD,functionSourceRgb:T["a"].ZERO,functionDestinationRgb:T["a"].ONE_MINUS_SOURCE_ALPHA,functionSourceAlpha:T["a"].ZERO,functionDestinationAlpha:T["a"].ONE_MINUS_SOURCE_ALPHA};function R(t,e,n,a){let r=n[a.id];if(!Object(s["a"])(r)){const t=m["a"].getState(a);t.depthMask=!1,t.blending=e,r=m["a"].fromCache(t),n[a.id]=r}return r}function A(t,e,n){return R(e,y,t._translucentRenderStateCache,n)}function P(t,e,n){return R(e,x,t._translucentRenderStateCache,n)}function B(t,e,n){return R(e,j,t._alphaRenderStateCache,n)}const D="    vec3 Ci = czm_gl_FragColor.rgb * czm_gl_FragColor.a;\n    float ai = czm_gl_FragColor.a;\n    float wzi = czm_alphaWeight(ai);\n    gl_FragData[0] = vec4(Ci * wzi, ai);\n    gl_FragData[1] = vec4(ai * wzi);\n",M="    vec3 Ci = czm_gl_FragColor.rgb * czm_gl_FragColor.a;\n    float ai = czm_gl_FragColor.a;\n    float wzi = czm_alphaWeight(ai);\n    gl_FragColor = vec4(Ci, ai) * wzi;\n",q="    float ai = czm_gl_FragColor.a;\n    gl_FragColor = vec4(ai);\n";function E(t,e,n,a){let r=t.shaderCache.getDerivedShaderProgram(e,n);if(!Object(s["a"])(r)){const s=e._attributeLocations,o=e.fragmentShaderSource.clone();o.sources=o.sources.map((function(t){return t=_["a"].replaceMain(t,"czm_translucent_main"),t=t.replace(/gl_FragColor/g,"czm_gl_FragColor"),t=t.replace(/\bdiscard\b/g,"czm_discard = true"),t=t.replace(/czm_phong/g,"czm_translucentPhong"),t})),o.sources.splice(0,0,(-1!==a.indexOf("gl_FragData")?"#extension GL_EXT_draw_buffers : enable \n":"")+"vec4 czm_gl_FragColor;\nbool czm_discard = false;\n"),o.sources.push(`void main()\n{\n    czm_translucent_main();\n    if (czm_discard)\n    {\n        discard;\n    }\n${a}}\n`),r=t.shaderCache.createDerivedShaderProgram(e,n,{vertexShaderSource:e.vertexShaderSource,fragmentShaderSource:o,attributeLocations:s})}return r}function L(t,e){return E(t,e,"translucentMRT",D)}function z(t,e){return E(t,e,"translucentMultipass",M)}function I(t,e){return E(t,e,"alphaMultipass",q)}function H(t,e,n,a,r,o){let i,u,c;const l=e.context,d=e.frameState.useLogDepth,h=e._hdr,m=a.framebuffer,_=r.length,p=e.frameState.shadowState.lightShadowsEnabled;a.framebuffer=t._adjustTranslucentFBO.framebuffer,t._adjustTranslucentCommand.execute(l,a),a.framebuffer=t._adjustAlphaFBO.framebuffer,t._adjustAlphaCommand.execute(l,a);const f=t._opaqueFBO.framebuffer;for(a.framebuffer=t._translucentFBO.framebuffer,c=0;c<_;++c)i=r[c],i=d?i.derivedCommands.logDepth.command:i,i=h?i.derivedCommands.hdr.command:i,u=p&&i.receiveShadows?i.derivedCommands.oit.shadows.translucentCommand:i.derivedCommands.oit.translucentCommand,n(u,e,l,a,f);for(Object(s["a"])(o)&&(i=o.unclassifiedCommand,u=p&&i.receiveShadows?i.derivedCommands.oit.shadows.translucentCommand:i.derivedCommands.oit.translucentCommand,n(u,e,l,a,f)),a.framebuffer=t._alphaFBO.framebuffer,c=0;c<_;++c)i=r[c],i=d?i.derivedCommands.logDepth.command:i,i=h?i.derivedCommands.hdr.command:i,u=p&&i.receiveShadows?i.derivedCommands.oit.shadows.alphaCommand:i.derivedCommands.oit.alphaCommand,n(u,e,l,a,f);Object(s["a"])(o)&&(i=o.unclassifiedCommand,u=p&&i.receiveShadows?i.derivedCommands.oit.shadows.alphaCommand:i.derivedCommands.oit.alphaCommand,n(u,e,l,a,f)),a.framebuffer=m}function N(t,e,n,a,r,o){const i=e.context,u=e.frameState.useLogDepth,c=e._hdr,l=a.framebuffer,d=r.length,h=e.frameState.shadowState.lightShadowsEnabled;a.framebuffer=t._adjustTranslucentFBO.framebuffer,t._adjustTranslucentCommand.execute(i,a);const m=t._opaqueFBO.framebuffer;let _,p;a.framebuffer=t._translucentFBO.framebuffer;for(let s=0;s<d;++s)_=r[s],_=u?_.derivedCommands.logDepth.command:_,_=c?_.derivedCommands.hdr.command:_,p=h&&_.receiveShadows?_.derivedCommands.oit.shadows.translucentCommand:_.derivedCommands.oit.translucentCommand,n(p,e,i,a,m);Object(s["a"])(o)&&(_=o.unclassifiedCommand,p=h&&_.receiveShadows?_.derivedCommands.oit.shadows.translucentCommand:_.derivedCommands.oit.translucentCommand,n(p,e,i,a,m)),a.framebuffer=l}S.prototype.createDerivedCommands=function(t,e,n){if(Object(s["a"])(n)||(n={}),this._translucentMRTSupport){let a,r;Object(s["a"])(n.translucentCommand)&&(a=n.translucentCommand.shaderProgram,r=n.translucentCommand.renderState),n.translucentCommand=l["a"].shallowClone(t,n.translucentCommand),Object(s["a"])(a)&&n.shaderProgramId===t.shaderProgram.id?(n.translucentCommand.shaderProgram=a,n.translucentCommand.renderState=r):(n.translucentCommand.shaderProgram=L(e,t.shaderProgram),n.translucentCommand.renderState=A(this,e,t.renderState),n.shaderProgramId=t.shaderProgram.id)}else{let a,r,o,i;Object(s["a"])(n.translucentCommand)&&(a=n.translucentCommand.shaderProgram,r=n.translucentCommand.renderState,o=n.alphaCommand.shaderProgram,i=n.alphaCommand.renderState),n.translucentCommand=l["a"].shallowClone(t,n.translucentCommand),n.alphaCommand=l["a"].shallowClone(t,n.alphaCommand),Object(s["a"])(a)&&n.shaderProgramId===t.shaderProgram.id?(n.translucentCommand.shaderProgram=a,n.translucentCommand.renderState=r,n.alphaCommand.shaderProgram=o,n.alphaCommand.renderState=i):(n.translucentCommand.shaderProgram=z(e,t.shaderProgram),n.translucentCommand.renderState=P(this,e,t.renderState),n.alphaCommand.shaderProgram=I(e,t.shaderProgram),n.alphaCommand.renderState=B(this,e,t.renderState),n.shaderProgramId=t.shaderProgram.id)}return n},S.prototype.executeCommands=function(t,e,n,a,r){this._translucentMRTSupport?N(this,t,e,n,a,r):H(this,t,e,n,a,r)},S.prototype.execute=function(t,e){this._compositeCommand.execute(t,e)},S.prototype.clear=function(t,e,n){const a=e.framebuffer;e.framebuffer=this._opaqueFBO.framebuffer,r["a"].clone(n,this._opaqueClearCommand.color),this._opaqueClearCommand.execute(t,e),e.framebuffer=this._translucentFBO.framebuffer;const s=this._translucentMRTSupport?this._translucentMRTClearCommand:this._translucentMultipassClearCommand;s.execute(t,e),this._translucentMultipassSupport&&(e.framebuffer=this._alphaFBO.framebuffer,this._alphaClearCommand.execute(t,e)),e.framebuffer=a},S.prototype.isSupported=function(){return this._translucentMRTSupport||this._translucentMultipassSupport},S.prototype.isDestroyed=function(){return!1},S.prototype.destroy=function(){return w(this),Object(s["a"])(this._compositeCommand)&&(this._compositeCommand.shaderProgram=this._compositeCommand.shaderProgram&&this._compositeCommand.shaderProgram.destroy()),Object(s["a"])(this._adjustTranslucentCommand)&&(this._adjustTranslucentCommand.shaderProgram=this._adjustTranslucentCommand.shaderProgram&&this._adjustTranslucentCommand.shaderProgram.destroy()),Object(s["a"])(this._adjustAlphaCommand)&&(this._adjustAlphaCommand.shaderProgram=this._adjustAlphaCommand.shaderProgram&&this._adjustAlphaCommand.shaderProgram.destroy()),Object(o["a"])(this)},e["a"]=S}}]);