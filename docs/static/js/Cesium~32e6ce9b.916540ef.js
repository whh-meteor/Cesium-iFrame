(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Cesium~32e6ce9b"],{"5b21":function(e,t,n){"use strict";var i=n("535a"),a=n("2f63"),r=n("4b18"),o=n("a5a5"),s=n("1725");function c(e){e=Object(i["a"])(e,i["a"].EMPTY_OBJECT);const t=e.property,n=e.classProperty,o=e.textures,s=Object(a["a"])(t.channels)?t.channels:[0],c=t,l=r["a"].createModelTextureReader({textureInfo:c,channels:u(s),texture:o[c.index]});this._min=t.min,this._max=t.max;let h=t.offset,d=t.scale;const p=n.hasValueTransform||Object(a["a"])(h)||Object(a["a"])(d);h=Object(i["a"])(h,n.offset),d=Object(i["a"])(d,n.scale),h=n.unpackVectorAndMatrixTypes(h),d=n.unpackVectorAndMatrixTypes(d),this._offset=h,this._scale=d,this._hasValueTransform=p,this._textureReader=l,this._classProperty=n,this._extras=t.extras,this._extensions=t.extensions}Object.defineProperties(c.prototype,{textureReader:{get:function(){return this._textureReader}},hasValueTransform:{get:function(){return this._hasValueTransform}},offset:{get:function(){return this._offset}},scale:{get:function(){return this._scale}},classProperty:{get:function(){return this._classProperty}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),c.prototype.isGpuCompatible=function(){const e=this._classProperty,t=e.type,n=e.componentType;return e.isArray?!e.isVariableLengthArray&&e.arrayLength<=4&&t===o["a"].SCALAR&&n===s["a"].UINT8:!(!o["a"].isVectorType(t)&&t!==o["a"].SCALAR)&&n===s["a"].UINT8};const l=[void 0,"float","vec2","vec3","vec4"],h=[void 0,"int","ivec2","ivec3","ivec4"];function u(e){return e.map((function(e){return"rgba".charAt(e)})).join("")}c.prototype.getGlslType=function(){const e=this._classProperty;let t=o["a"].getComponentCount(e.type);return e.isArray&&(t=e.arrayLength),e.normalized?l[t]:h[t]},c.prototype.unpackInShader=function(e){const t=this._classProperty;if(t.normalized)return e;const n=this.getGlslType();return`${n}(255.0 * ${e})`};var d=c;function p(e){e=Object(i["a"])(e,i["a"].EMPTY_OBJECT);const t=e.propertyTexture,n=e.class,r=e.textures,o=t.extensions,s=t.extras,c={};if(Object(a["a"])(t.properties))for(const i in t.properties)t.properties.hasOwnProperty(i)&&(c[i]=new d({property:t.properties[i],classProperty:n.properties[i],textures:r}));this._name=e.name,this._id=e.id,this._class=n,this._properties=c,this._extras=s,this._extensions=o}Object.defineProperties(p.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},class:{get:function(){return this._class}},properties:{get:function(){return this._properties}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),p.prototype.getProperty=function(e){return this._properties[e]};t["a"]=p},"738d":function(e,t,n){"use strict";var i=n("71ce"),a=n("535a"),r=n("2f63"),o=n("7d62");function s(e){e=Object(a["a"])(e,a["a"].EMPTY_OBJECT),this._primitives=[],this._guid=Object(i["a"])(),this._zIndex=void 0,this.show=Object(a["a"])(e.show,!0),this.destroyPrimitives=Object(a["a"])(e.destroyPrimitives,!0)}function c(e,t){return e._primitives.indexOf(t)}Object.defineProperties(s.prototype,{length:{get:function(){return this._primitives.length}}}),s.prototype.add=function(e,t){const n=Object(r["a"])(t),i=e._external=e._external||{},a=i._composites=i._composites||{};return a[this._guid]={collection:this},n?this._primitives.splice(t,0,e):this._primitives.push(e),e},s.prototype.remove=function(e){if(this.contains(e)){const t=this._primitives.indexOf(e);if(-1!==t)return this._primitives.splice(t,1),delete e._external._composites[this._guid],this.destroyPrimitives&&e.destroy(),!0}return!1},s.prototype.removeAndDestroy=function(e){const t=this.remove(e);return t&&!this.destroyPrimitives&&e.destroy(),t},s.prototype.removeAll=function(){const e=this._primitives,t=e.length;for(let n=0;n<t;++n)delete e[n]._external._composites[this._guid],this.destroyPrimitives&&e[n].destroy();this._primitives=[]},s.prototype.contains=function(e){return!!(Object(r["a"])(e)&&e._external&&e._external._composites&&e._external._composites[this._guid])},s.prototype.raise=function(e){if(Object(r["a"])(e)){const t=c(this,e),n=this._primitives;if(t!==n.length-1){const e=n[t];n[t]=n[t+1],n[t+1]=e}}},s.prototype.raiseToTop=function(e){if(Object(r["a"])(e)){const t=c(this,e),n=this._primitives;t!==n.length-1&&(n.splice(t,1),n.push(e))}},s.prototype.lower=function(e){if(Object(r["a"])(e)){const t=c(this,e),n=this._primitives;if(0!==t){const e=n[t];n[t]=n[t-1],n[t-1]=e}}},s.prototype.lowerToBottom=function(e){if(Object(r["a"])(e)){const t=c(this,e),n=this._primitives;0!==t&&(n.splice(t,1),n.unshift(e))}},s.prototype.get=function(e){return this._primitives[e]},s.prototype.update=function(e){if(!this.show)return;const t=this._primitives;for(let n=0;n<t.length;++n)t[n].update(e)},s.prototype.prePassesUpdate=function(e){const t=this._primitives;for(let n=0;n<t.length;++n){const i=t[n];Object(r["a"])(i.prePassesUpdate)&&i.prePassesUpdate(e)}},s.prototype.updateForPass=function(e,t){const n=this._primitives;for(let i=0;i<n.length;++i){const a=n[i];Object(r["a"])(a.updateForPass)&&a.updateForPass(e,t)}},s.prototype.postPassesUpdate=function(e){const t=this._primitives;for(let n=0;n<t.length;++n){const i=t[n];Object(r["a"])(i.postPassesUpdate)&&i.postPassesUpdate(e)}},s.prototype.isDestroyed=function(){return!1},s.prototype.destroy=function(){return this.removeAll(),Object(o["a"])(this)},t["a"]=s},"894b":function(e,t,n){"use strict";var i=n("cef5"),a=n("670c"),r=n("be18"),o=n("a561"),s=n("bef8"),c=n("dc1c"),l=n("bd8d"),h=n("2bb9"),u=n("abab"),d=n("535a"),p=n("2f63"),m=n("7d62"),b=n("6cbd"),f=n("5e57"),_=n("d2c7"),g=n("81d7"),y=n("473c"),T=n("0276"),O=n("66bf"),v=n("52f0"),C=n("188e"),S=n("283e"),x=n("6a4b"),D=n("6a29"),j=n("8b68"),R=n("b997"),w=n("a894"),P=n("d289"),A=n("6dc0"),E=n("e90c"),L=n("5770"),I=n("7c5e"),F=n("2cc3"),k=n("29ab"),M=n("06f0"),z=n("c52f"),V=n("3d7f"),B=n("c1e2"),N=n("0123"),H=n("c2eb"),U=n("1184");function G(e,t,n){let i=!n;const a=e.length;let r;if(!i&&a>1){const t=e[0].modelMatrix;for(r=1;r<a;++r)if(!v["a"].equals(t,e[r].modelMatrix)){i=!0;break}}if(i)for(r=0;r<a;++r)Object(p["a"])(e[r].geometry)&&B["a"].transformToWorldCoordinates(e[r]);else v["a"].multiplyTransformation(t,e[0].modelMatrix,t)}function $(e,t){const n=e.attributes,i=n.position,a=i.values.length/i.componentsPerAttribute;n.batchId=new g["a"]({componentDatatype:u["a"].FLOAT,componentsPerAttribute:1,values:new Float32Array(a)});const r=n.batchId.values;for(let o=0;o<a;++o)r[o]=t}function Q(e){const t=e.length;for(let n=0;n<t;++n){const t=e[n];Object(p["a"])(t.geometry)?$(t.geometry,n):Object(p["a"])(t.westHemisphereGeometry)&&Object(p["a"])(t.eastHemisphereGeometry)&&($(t.westHemisphereGeometry,n),$(t.eastHemisphereGeometry,n))}}function W(e){const t=e.instances,n=e.projection,a=e.elementIndexUintSupported,r=e.scene3DOnly,o=e.vertexCacheOptimize,s=e.compressVertices,c=e.modelMatrix;let l,h,d,m=t.length;for(l=0;l<m;++l)if(Object(p["a"])(t[l].geometry)){d=t[l].geometry.primitiveType;break}if(G(t,c,r),!r)for(l=0;l<m;++l)Object(p["a"])(t[l].geometry)&&B["a"].splitLongitude(t[l]);if(Q(t),o)for(l=0;l<m;++l){const e=t[l];Object(p["a"])(e.geometry)?(B["a"].reorderForPostVertexCache(e.geometry),B["a"].reorderForPreVertexCache(e.geometry)):Object(p["a"])(e.westHemisphereGeometry)&&Object(p["a"])(e.eastHemisphereGeometry)&&(B["a"].reorderForPostVertexCache(e.westHemisphereGeometry),B["a"].reorderForPreVertexCache(e.westHemisphereGeometry),B["a"].reorderForPostVertexCache(e.eastHemisphereGeometry),B["a"].reorderForPreVertexCache(e.eastHemisphereGeometry))}let b=B["a"].combineInstances(t);for(m=b.length,l=0;l<m;++l){h=b[l];const e=h.attributes;if(r)for(const t in e)e.hasOwnProperty(t)&&e[t].componentDatatype===u["a"].DOUBLE&&B["a"].encodeAttribute(h,t,t+"3DHigh",t+"3DLow");else for(const t in e)if(e.hasOwnProperty(t)&&e[t].componentDatatype===u["a"].DOUBLE){const e=t+"3D",a=t+"2D";B["a"].projectTo2D(h,t,e,a,n),Object(p["a"])(h.boundingSphere)&&"position"===t&&(h.boundingSphereCV=i["a"].fromVertices(h.attributes.position2D.values)),B["a"].encodeAttribute(h,e,e+"High",e+"Low"),B["a"].encodeAttribute(h,a,a+"High",a+"Low")}s&&B["a"].compressVertices(h)}if(!a){let e=[];for(m=b.length,l=0;l<m;++l)h=b[l],e=e.concat(B["a"].fitToUnsignedShortIndices(h));b=e}return b}function Y(e,t,n,i){let a,r,o;const s=i.length-1;if(s>=0){const e=i[s];a=e.offset+e.count,o=e.index,r=n[o].indices.length}else a=0,o=0,r=n[o].indices.length;const c=e.length;for(let l=0;l<c;++l){const s=e[l],c=s[t];if(!Object(p["a"])(c))continue;const h=c.indices.length;a+h>r&&(a=0,r=n[++o].indices.length),i.push({index:o,offset:a,count:h}),a+=h}}function Z(e,t){const n=[];return Y(e,"geometry",t,n),Y(e,"westHemisphereGeometry",t,n),Y(e,"eastHemisphereGeometry",t,n),n}const q={};function J(e,t){const n=e.attributes;for(const i in n)if(n.hasOwnProperty(i)){const e=n[i];Object(p["a"])(e)&&Object(p["a"])(e.values)&&t.push(e.values.buffer)}Object(p["a"])(e.indices)&&t.push(e.indices.buffer)}function X(e,t){const n=e.length;for(let i=0;i<n;++i)J(e[i],t)}function K(e){let t=1;const n=e.length;for(let a=0;a<n;a++){const n=e[a];if(++t,!Object(p["a"])(n))continue;const r=n.attributes;t+=7+2*i["a"].packedLength+(Object(p["a"])(n.indices)?n.indices.length:0);for(const e in r)if(r.hasOwnProperty(e)&&Object(p["a"])(r[e])){const n=r[e];t+=5+n.values.length}}return t}function ee(e,t){const n=e.length,i=new Float64Array(1+19*n);let a=0;i[a++]=n;for(let r=0;r<n;r++){const t=e[r];if(v["a"].pack(t.modelMatrix,i,a),a+=v["a"].packedLength,Object(p["a"])(t.attributes)&&Object(p["a"])(t.attributes.offset)){const e=t.attributes.offset.value;i[a]=e[0],i[a+1]=e[1],i[a+2]=e[2]}a+=3}return t.push(i.buffer),i}function te(e){const t=e,n=new Array(t[0]);let i=0,a=1;while(a<t.length){const e=v["a"].unpack(t,a);let r;a+=v["a"].packedLength,Object(p["a"])(t[a])&&(r={offset:new H["a"](t[a],t[a+1],t[a+2])}),a+=3,n[i++]={modelMatrix:e,attributes:r}}return n}function ne(e){const t=e.length,n=1+(i["a"].packedLength+1)*t,a=new Float32Array(n);let r=0;a[r++]=t;for(let o=0;o<t;++o){const t=e[o];Object(p["a"])(t)?(a[r++]=1,i["a"].pack(e[o],a,r)):a[r++]=0,r+=i["a"].packedLength}return a}function ie(e){const t=new Array(e[0]);let n=0,a=1;while(a<e.length)1===e[a++]&&(t[n]=i["a"].unpack(e,a)),++n,a+=i["a"].packedLength;return t}q.combineGeometry=function(e){let t,n;const a=e.instances,r=a.length;let o,s,c=!1;r>0&&(t=W(e),t.length>0&&(n=B["a"].createAttributeLocations(t[0]),e.createPickOffsets&&(o=Z(a,t))),Object(p["a"])(a[0].attributes)&&Object(p["a"])(a[0].attributes.offset)&&(s=new Array(r),c=!0));const l=new Array(r),h=new Array(r);for(let u=0;u<r;++u){const e=a[u],t=e.geometry;Object(p["a"])(t)&&(l[u]=t.boundingSphere,h[u]=t.boundingSphereCV,c&&(s[u]=e.geometry.offsetAttribute));const n=e.eastHemisphereGeometry,r=e.westHemisphereGeometry;Object(p["a"])(n)&&Object(p["a"])(r)&&(Object(p["a"])(n.boundingSphere)&&Object(p["a"])(r.boundingSphere)&&(l[u]=i["a"].union(n.boundingSphere,r.boundingSphere)),Object(p["a"])(n.boundingSphereCV)&&Object(p["a"])(r.boundingSphereCV)&&(h[u]=i["a"].union(n.boundingSphereCV,r.boundingSphereCV)))}return{geometries:t,modelMatrix:e.modelMatrix,attributeLocations:n,pickOffsets:o,offsetInstanceExtend:s,boundingSpheres:l,boundingSpheresCV:h}},q.packCreateGeometryResults=function(e,t){const n=new Float64Array(K(e)),a=[],r={},o=e.length;let s=0;n[s++]=o;for(let c=0;c<o;c++){const t=e[c],o=Object(p["a"])(t);if(n[s++]=o?1:0,!o)continue;n[s++]=t.primitiveType,n[s++]=t.geometryType,n[s++]=Object(d["a"])(t.offsetAttribute,-1);const l=Object(p["a"])(t.boundingSphere)?1:0;n[s++]=l,l&&i["a"].pack(t.boundingSphere,n,s),s+=i["a"].packedLength;const h=Object(p["a"])(t.boundingSphereCV)?1:0;n[s++]=h,h&&i["a"].pack(t.boundingSphereCV,n,s),s+=i["a"].packedLength;const u=t.attributes,m=[];for(const e in u)u.hasOwnProperty(e)&&Object(p["a"])(u[e])&&(m.push(e),Object(p["a"])(r[e])||(r[e]=a.length,a.push(e)));n[s++]=m.length;for(let e=0;e<m.length;e++){const t=m[e],i=u[t];n[s++]=r[t],n[s++]=i.componentDatatype,n[s++]=i.componentsPerAttribute,n[s++]=i.normalize?1:0,n[s++]=i.values.length,n.set(i.values,s),s+=i.values.length}const b=Object(p["a"])(t.indices)?t.indices.length:0;n[s++]=b,b>0&&(n.set(t.indices,s),s+=b)}return t.push(n.buffer),{stringTable:a,packedData:n}},q.unpackCreateGeometryResults=function(e){const t=e.stringTable,n=e.packedData;let a;const r=new Array(n[0]);let o=0,s=1;while(s<n.length){const e=1===n[s++];if(!e){r[o++]=void 0;continue}const c=n[s++],l=n[s++];let h,d,p=n[s++];-1===p&&(p=void 0);const m=1===n[s++];m&&(h=i["a"].unpack(n,s)),s+=i["a"].packedLength;const b=1===n[s++];let f,T,O;b&&(d=i["a"].unpack(n,s)),s+=i["a"].packedLength;const v=new y["a"],C=n[s++];for(a=0;a<C;a++){const e=t[n[s++]],i=n[s++];O=n[s++];const a=0!==n[s++];f=n[s++],T=u["a"].createTypedArray(i,f);for(let t=0;t<f;t++)T[t]=n[s++];v[e]=new g["a"]({componentDatatype:i,componentsPerAttribute:O,normalize:a,values:T})}let S;if(f=n[s++],f>0){const e=T.length/O;for(S=N["a"].createTypedArray(e,f),a=0;a<f;a++)S[a]=n[s++]}r[o++]=new _["a"]({primitiveType:c,geometryType:l,boundingSphere:h,boundingSphereCV:d,indices:S,attributes:v,offsetAttribute:p})}return r},q.packCombineGeometryParameters=function(e,t){const n=e.createGeometryResults,i=n.length;for(let a=0;a<i;a++)t.push(n[a].packedData.buffer);return{createGeometryResults:e.createGeometryResults,packedInstances:ee(e.instances,t),ellipsoid:e.ellipsoid,isGeographic:e.projection instanceof V["a"],elementIndexUintSupported:e.elementIndexUintSupported,scene3DOnly:e.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e.createPickOffsets}},q.unpackCombineGeometryParameters=function(e){const t=te(e.packedInstances),n=e.createGeometryResults,i=n.length;let a=0;for(let s=0;s<i;s++){const e=q.unpackCreateGeometryResults(n[s]),i=e.length;for(let n=0;n<i;n++){const i=e[n],r=t[a];r.geometry=i,++a}}const r=z["a"].clone(e.ellipsoid),o=e.isGeographic?new V["a"](r):new U["a"](r);return{instances:t,ellipsoid:r,projection:o,elementIndexUintSupported:e.elementIndexUintSupported,scene3DOnly:e.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:v["a"].clone(e.modelMatrix),createPickOffsets:e.createPickOffsets}},q.packCombineGeometryResults=function(e,t){Object(p["a"])(e.geometries)&&X(e.geometries,t);const n=ne(e.boundingSpheres),i=ne(e.boundingSpheresCV);return t.push(n.buffer,i.buffer),{geometries:e.geometries,attributeLocations:e.attributeLocations,modelMatrix:e.modelMatrix,pickOffsets:e.pickOffsets,offsetInstanceExtend:e.offsetInstanceExtend,boundingSpheres:n,boundingSpheresCV:i}},q.unpackCombineGeometryResults=function(e){return{geometries:e.geometries,attributeLocations:e.attributeLocations,modelMatrix:e.modelMatrix,pickOffsets:e.pickOffsets,offsetInstanceExtend:e.offsetInstanceExtend,boundingSpheres:ie(e.boundingSpheres),boundingSpheresCV:ie(e.boundingSpheresCV)}};var ae=q;const re={READY:0,CREATING:1,CREATED:2,COMBINING:3,COMBINED:4,COMPLETE:5,FAILED:6};var oe=Object.freeze(re),se=n("a307"),ce=n("c86b");function le(e){e=Object(d["a"])(e,d["a"].EMPTY_OBJECT),this.geometryInstances=e.geometryInstances,this.appearance=e.appearance,this._appearance=void 0,this._material=void 0,this.depthFailAppearance=e.depthFailAppearance,this._depthFailAppearance=void 0,this._depthFailMaterial=void 0,this.modelMatrix=v["a"].clone(Object(d["a"])(e.modelMatrix,v["a"].IDENTITY)),this._modelMatrix=new v["a"],this.show=Object(d["a"])(e.show,!0),this._vertexCacheOptimize=Object(d["a"])(e.vertexCacheOptimize,!1),this._interleave=Object(d["a"])(e.interleave,!1),this._releaseGeometryInstances=Object(d["a"])(e.releaseGeometryInstances,!0),this._allowPicking=Object(d["a"])(e.allowPicking,!0),this._asynchronous=Object(d["a"])(e.asynchronous,!0),this._compressVertices=Object(d["a"])(e.compressVertices,!0),this.cull=Object(d["a"])(e.cull,!0),this.debugShowBoundingVolume=Object(d["a"])(e.debugShowBoundingVolume,!1),this.rtcCenter=e.rtcCenter,this.shadows=Object(d["a"])(e.shadows,ce["a"].DISABLED),this._translucent=void 0,this._state=oe.READY,this._geometries=[],this._error=void 0,this._numberOfInstances=0,this._boundingSpheres=[],this._boundingSphereWC=[],this._boundingSphereCV=[],this._boundingSphere2D=[],this._boundingSphereMorph=[],this._perInstanceAttributeCache=[],this._instanceIds=[],this._lastPerInstanceAttributeIndex=0,this._va=[],this._attributeLocations=void 0,this._primitiveType=void 0,this._frontFaceRS=void 0,this._backFaceRS=void 0,this._sp=void 0,this._depthFailAppearance=void 0,this._spDepthFail=void 0,this._frontFaceDepthFailRS=void 0,this._backFaceDepthFailRS=void 0,this._pickIds=[],this._colorCommands=[],this._pickCommands=[],this._createBoundingVolumeFunction=e._createBoundingVolumeFunction,this._createRenderStatesFunction=e._createRenderStatesFunction,this._createShaderProgramFunction=e._createShaderProgramFunction,this._createCommandsFunction=e._createCommandsFunction,this._updateAndQueueCommandsFunction=e._updateAndQueueCommandsFunction,this._createPickOffsets=e._createPickOffsets,this._pickOffsets=void 0,this._createGeometryResults=void 0,this._ready=!1;const t=this;this._readyPromise=new Promise((e,n)=>{t._completeLoad=(i,a,r)=>{this._error=r,this._state=a,i.afterRender.push((function(){t._ready=t._state===oe.COMPLETE||t._state===oe.FAILED,Object(p["a"])(r)?n(r):e(t)}))}}),this._batchTable=void 0,this._batchTableAttributeIndices=void 0,this._offsetInstanceExtend=void 0,this._batchTableOffsetAttribute2DIndex=void 0,this._batchTableOffsetsUpdated=!1,this._instanceBoundingSpheres=void 0,this._instanceBoundingSpheresCV=void 0,this._tempBoundingSpheres=void 0,this._recomputeBoundingSpheres=!1,this._batchTableBoundingSpheresUpdated=!1,this._batchTableBoundingSphereAttributeIndices=void 0}function he(e){const t=e.length,n=[],i=e[0].attributes;let a;for(a in i)if(i.hasOwnProperty(a)&&Object(p["a"])(i[a])){const r=i[a];let o=!0;for(let n=1;n<t;++n){const t=e[n].attributes[a];if(!Object(p["a"])(t)||r.componentDatatype!==t.componentDatatype||r.componentsPerAttribute!==t.componentsPerAttribute||r.normalize!==t.normalize){o=!1;break}}o&&n.push(a)}return n}Object.defineProperties(le.prototype,{vertexCacheOptimize:{get:function(){return this._vertexCacheOptimize}},interleave:{get:function(){return this._interleave}},releaseGeometryInstances:{get:function(){return this._releaseGeometryInstances}},allowPicking:{get:function(){return this._allowPicking}},asynchronous:{get:function(){return this._asynchronous}},compressVertices:{get:function(){return this._compressVertices}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}}});const ue=new a["a"],de=new r["a"],pe=new o["a"];function me(e){const t=e.length;return 1===t?e[0]:2===t?a["a"].unpack(e,0,ue):3===t?r["a"].unpack(e,0,de):4===t?o["a"].unpack(e,0,pe):void 0}function be(e,t){const n=e.geometryInstances,i=Array.isArray(n)?n:[n],a=i.length;if(0===a)return;const r=he(i),o=r.length,s=[],c={},h={};let m;const b=i[0];let f,_,g,y=b.attributes;for(f=0;f<o;++f)_=r[f],g=y[_],c[_]=f,s.push({functionName:"czm_batchTable_"+_,componentDatatype:g.componentDatatype,componentsPerAttribute:g.componentsPerAttribute,normalize:g.normalize});-1!==r.indexOf("distanceDisplayCondition")&&(s.push({functionName:"czm_batchTable_boundingSphereCenter3DHigh",componentDatatype:u["a"].FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter3DLow",componentDatatype:u["a"].FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter2DHigh",componentDatatype:u["a"].FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter2DLow",componentDatatype:u["a"].FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereRadius",componentDatatype:u["a"].FLOAT,componentsPerAttribute:1}),h.center3DHigh=s.length-5,h.center3DLow=s.length-4,h.center2DHigh=s.length-3,h.center2DLow=s.length-2,h.radius=s.length-1),-1!==r.indexOf("offset")&&(s.push({functionName:"czm_batchTable_offset2D",componentDatatype:u["a"].FLOAT,componentsPerAttribute:3}),m=s.length-1),s.push({functionName:"czm_batchTable_pickColor",componentDatatype:u["a"].UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0});const T=s.length,O=new F["a"](t,s,a);for(f=0;f<a;++f){const n=i[f];y=n.attributes;for(let e=0;e<o;++e){_=r[e],g=y[_];const t=me(g.value),n=c[_];O.setBatchedAttribute(f,n,t)}const a={primitive:Object(d["a"])(n.pickPrimitive,e)};Object(p["a"])(n.id)&&(a.id=n.id);const s=t.createPickId(a);e._pickIds.push(s);const h=s.color,u=pe;u.x=l["a"].floatToByte(h.red),u.y=l["a"].floatToByte(h.green),u.z=l["a"].floatToByte(h.blue),u.w=l["a"].floatToByte(h.alpha),O.setBatchedAttribute(f,T-1,u)}e._batchTable=O,e._batchTableAttributeIndices=c,e._batchTableBoundingSphereAttributeIndices=h,e._batchTableOffsetAttribute2DIndex=m}function fe(e){let t;return t=Array.isArray(e.values)?e.values.slice(0):new e.values.constructor(e.values),new g["a"]({componentDatatype:e.componentDatatype,componentsPerAttribute:e.componentsPerAttribute,normalize:e.normalize,values:t})}function _e(e){const t=e.attributes,n=new y["a"];for(const i in t)t.hasOwnProperty(i)&&Object(p["a"])(t[i])&&(n[i]=fe(t[i]));let a;if(Object(p["a"])(e.indices)){const t=e.indices;a=Array.isArray(t)?t.slice(0):new t.constructor(t)}return new _["a"]({attributes:n,indices:a,primitiveType:e.primitiveType,boundingSphere:i["a"].clone(e.boundingSphere)})}function ge(e,t){return{geometry:t,attributes:e.attributes,modelMatrix:v["a"].clone(e.modelMatrix),pickPrimitive:e.pickPrimitive,id:e.id}}const ye=/attribute\s+vec(?:3|4)\s+(.*)3DHigh;/g;function Te(e){const t=L["a"].replaceMain(e,"czm_non_pick_main"),n="varying vec4 v_pickColor; \nvoid main() \n{ \n    czm_non_pick_main(); \n    v_pickColor = czm_batchTable_pickColor(batchId); \n}";return`${t}\n${n}`}function Oe(e){return"varying vec4 v_pickColor;\n"+e}function ve(e,t){if(!e.compressVertices)return t;const n=-1!==t.search(/attribute\s+vec3\s+normal;/g),i=-1!==t.search(/attribute\s+vec2\s+st;/g);if(!n&&!i)return t;const a=-1!==t.search(/attribute\s+vec3\s+tangent;/g),r=-1!==t.search(/attribute\s+vec3\s+bitangent;/g);let o=i&&n?2:1;o+=a||r?1:0;const s=o>1?"vec"+o:"float",c="compressedAttributes",l=`attribute ${s} ${c};`;let h="",u="";if(i){h+="vec2 st;\n";const e=o>1?c+".x":c;u+=`    st = czm_decompressTextureCoordinates(${e});\n`}n&&a&&r?(h+="vec3 normal;\nvec3 tangent;\nvec3 bitangent;\n",u+=`    czm_octDecode(${c}.${i?"yz":"xy"}, normal, tangent, bitangent);\n`):(n&&(h+="vec3 normal;\n",u+=`    normal = czm_octDecode(${c}${o>1?"."+(i?"y":"x"):""});\n`),a&&(h+="vec3 tangent;\n",u+=`    tangent = czm_octDecode(${c}.${i&&n?"z":"y"});\n`),r&&(h+="vec3 bitangent;\n",u+=`    bitangent = czm_octDecode(${c}.${i&&n?"z":"y"});\n`));let d=t;d=d.replace(/attribute\s+vec3\s+normal;/g,""),d=d.replace(/attribute\s+vec2\s+st;/g,""),d=d.replace(/attribute\s+vec3\s+tangent;/g,""),d=d.replace(/attribute\s+vec3\s+bitangent;/g,""),d=L["a"].replaceMain(d,"czm_non_compressed_main");const p=`void main() \n{ \n${u}    czm_non_compressed_main(); \n}`;return[l,h,d,p].join("\n")}function Ce(e){let t=L["a"].replaceMain(e,"czm_non_depth_clamp_main");return t+="void main() {\n    czm_non_depth_clamp_main();\n    gl_Position = czm_depthClamp(gl_Position);}\n",t}function Se(e){let t=L["a"].replaceMain(e,"czm_non_depth_clamp_main");return t+="void main() {\n    czm_non_depth_clamp_main();\n#if defined(GL_EXT_frag_depth)\n    #if defined(LOG_DEPTH)\n        czm_writeLogDepth();\n    #else\n        czm_writeDepthClamp();\n    #endif\n#endif\n}\n",t="#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n#endif\n"+t,t}function xe(e,t){e.vertexAttributes}function De(e,t){return function(){return e[t]}}le._modifyShaderPosition=function(e,t,n){let i,a="",r="",o="";while(null!==(i=ye.exec(t))){const s=i[1],c=`vec4 czm_compute${s[0].toUpperCase()}${s.substr(1)}()`;"vec4 czm_computePosition()"!==c&&(a+=c+";\n"),Object(p["a"])(e.rtcCenter)?(t=t.replace(/attribute\s+vec(?:3|4)\s+position3DHigh;/g,""),t=t.replace(/attribute\s+vec(?:3|4)\s+position3DLow;/g,""),a+="uniform mat4 u_modifiedModelView;\n",r+="attribute vec4 position;\n",o+=c+"\n{\n    return u_modifiedModelView * position;\n}\n\n",t=t.replace(/czm_modelViewRelativeToEye\s+\*\s+/g,""),t=t.replace(/czm_modelViewProjectionRelativeToEye/g,"czm_projection")):n?o+=c+"\n{\n"+`    return czm_translateRelativeToEye(${s}3DHigh, ${s}3DLow);\n}\n\n`:(r+=`attribute vec3 ${s}2DHigh;\nattribute vec3 ${s}2DLow;\n`,o+=c+"\n{\n    vec4 p;\n    if (czm_morphTime == 1.0)\n    {\n"+`        p = czm_translateRelativeToEye(${s}3DHigh, ${s}3DLow);\n    }\n    else if (czm_morphTime == 0.0)\n    {\n`+`        p = czm_translateRelativeToEye(${s}2DHigh.zxy, ${s}2DLow.zxy);\n    }\n    else\n    {\n        p = czm_columbusViewMorph(\n`+`                czm_translateRelativeToEye(${s}2DHigh.zxy, ${s}2DLow.zxy),\n`+`                czm_translateRelativeToEye(${s}3DHigh, ${s}3DLow),\n                czm_morphTime);\n    }\n    return p;\n}\n\n`)}return[a,r,t,o].join("\n")},le._appendShowToShader=function(e,t){if(!Object(p["a"])(e._batchTableAttributeIndices.show))return t;const n=L["a"].replaceMain(t,"czm_non_show_main"),i="void main() \n{ \n    czm_non_show_main(); \n    gl_Position *= czm_batchTable_show(batchId); \n}";return`${n}\n${i}`},le._updateColorAttribute=function(e,t,n){if(!Object(p["a"])(e._batchTableAttributeIndices.color)&&!Object(p["a"])(e._batchTableAttributeIndices.depthFailColor))return t;if(-1===t.search(/attribute\s+vec4\s+color;/g))return t;let i=t;return i=i.replace(/attribute\s+vec4\s+color;/g,""),i=n?i.replace(/(\b)color(\b)/g,"$1czm_batchTable_depthFailColor(batchId)$2"):i.replace(/(\b)color(\b)/g,"$1czm_batchTable_color(batchId)$2"),i},le._updatePickColorAttribute=function(e){let t=e.replace(/attribute\s+vec4\s+pickColor;/g,"");return t=t.replace(/(\b)pickColor(\b)/g,"$1czm_batchTable_pickColor(batchId)$2"),t},le._appendOffsetToShader=function(e,t){if(!Object(p["a"])(e._batchTableAttributeIndices.offset))return t;let n="attribute float batchId;\n";n+="attribute float applyOffset;";let i=t.replace(/attribute\s+float\s+batchId;/g,n),a="vec4 $1 = czm_computePosition();\n";return a+="    if (czm_sceneMode == czm_sceneMode3D)\n",a+="    {\n",a+="        $1 = $1 + vec4(czm_batchTable_offset(batchId) * applyOffset, 0.0);",a+="    }\n",a+="    else\n",a+="    {\n",a+="        $1 = $1 + vec4(czm_batchTable_offset2D(batchId) * applyOffset, 0.0);",a+="    }\n",i=i.replace(/vec4\s+([A-Za-z0-9_]+)\s+=\s+czm_computePosition\(\);/g,a),i},le._appendDistanceDisplayConditionToShader=function(e,t,n){if(!Object(p["a"])(e._batchTableAttributeIndices.distanceDisplayCondition))return t;const i=L["a"].replaceMain(t,"czm_non_distanceDisplayCondition_main");let a="void main() \n{ \n    czm_non_distanceDisplayCondition_main(); \n    vec2 distanceDisplayCondition = czm_batchTable_distanceDisplayCondition(batchId);\n    vec3 boundingSphereCenter3DHigh = czm_batchTable_boundingSphereCenter3DHigh(batchId);\n    vec3 boundingSphereCenter3DLow = czm_batchTable_boundingSphereCenter3DLow(batchId);\n    float boundingSphereRadius = czm_batchTable_boundingSphereRadius(batchId);\n";return a+=n?"    vec4 centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);\n":"    vec3 boundingSphereCenter2DHigh = czm_batchTable_boundingSphereCenter2DHigh(batchId);\n    vec3 boundingSphereCenter2DLow = czm_batchTable_boundingSphereCenter2DLow(batchId);\n    vec4 centerRTE;\n    if (czm_morphTime == 1.0)\n    {\n        centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);\n    }\n    else if (czm_morphTime == 0.0)\n    {\n        centerRTE = czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy);\n    }\n    else\n    {\n        centerRTE = czm_columbusViewMorph(\n                czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy),\n                czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow),\n                czm_morphTime);\n    }\n",a+="    float radiusSq = boundingSphereRadius * boundingSphereRadius; \n    float distanceSq; \n    if (czm_sceneMode == czm_sceneMode2D) \n    { \n        distanceSq = czm_eyeHeight2D.y - radiusSq; \n    } \n    else \n    { \n        distanceSq = dot(centerRTE.xyz, centerRTE.xyz) - radiusSq; \n    } \n    distanceSq = max(distanceSq, 0.0); \n    float nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x; \n    float farSq = distanceDisplayCondition.y * distanceDisplayCondition.y; \n    float show = (distanceSq >= nearSq && distanceSq <= farSq) ? 1.0 : 0.0; \n    gl_Position *= show; \n}",`${i}\n${a}`};const je=Math.max(f["a"].hardwareConcurrency-1,1);let Re;const we=new D["a"]("combineGeometry");function Pe(e,t){let n,i,a,r;const o=e._instanceIds;if(e._state===oe.READY){n=Array.isArray(e.geometryInstances)?e.geometryInstances:[e.geometryInstances];const s=e._numberOfInstances=n.length,c=[];let l,h=[];for(a=0;a<s;++a)i=n[a].geometry,o.push(n[a].id),h.push({moduleName:i._workerName,geometry:i});if(!Object(p["a"])(Re))for(Re=new Array(je),a=0;a<je;a++)Re[a]=new D["a"]("createGeometry");for(h=Object(x["a"])(h,je),a=0;a<h.length;a++){let e=0;const t=h[a],n=t.length;for(r=0;r<n;++r)l=t[r],i=l.geometry,Object(p["a"])(i.constructor.pack)&&(l.offset=e,e+=Object(d["a"])(i.constructor.packedLength,i.packedLength));let o;if(e>0){const a=new Float64Array(e);for(o=[a.buffer],r=0;r<n;++r)l=t[r],i=l.geometry,Object(p["a"])(i.constructor.pack)&&(i.constructor.pack(i,a,l.offset),l.geometry=a)}c.push(Re[a].scheduleTask({subTasks:h[a]},o))}e._state=oe.CREATING,Promise.all(c).then((function(t){e._createGeometryResults=t,e._state=oe.CREATED})).catch((function(n){it(e,t,oe.FAILED,n)}))}else if(e._state===oe.CREATED){const i=[];n=Array.isArray(e.geometryInstances)?e.geometryInstances:[e.geometryInstances];const a=t.scene3DOnly,r=t.mapProjection,o=we.scheduleTask(ae.packCombineGeometryParameters({createGeometryResults:e._createGeometryResults,instances:n,ellipsoid:r.ellipsoid,projection:r,elementIndexUintSupported:t.context.elementIndexUint,scene3DOnly:a,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e._createPickOffsets},i),i);e._createGeometryResults=void 0,e._state=oe.COMBINING,Promise.resolve(o).then((function(n){const i=ae.unpackCombineGeometryResults(n);e._geometries=i.geometries,e._attributeLocations=i.attributeLocations,e.modelMatrix=v["a"].clone(i.modelMatrix,e.modelMatrix),e._pickOffsets=i.pickOffsets,e._offsetInstanceExtend=i.offsetInstanceExtend,e._instanceBoundingSpheres=i.boundingSpheres,e._instanceBoundingSpheresCV=i.boundingSpheresCV,Object(p["a"])(e._geometries)&&e._geometries.length>0?(e._recomputeBoundingSpheres=!0,e._state=oe.COMBINED):it(e,t,oe.FAILED,void 0)})).catch((function(n){it(e,t,oe.FAILED,n)}))}}function Ae(e,t){const n=Array.isArray(e.geometryInstances)?e.geometryInstances:[e.geometryInstances],i=e._numberOfInstances=n.length,a=new Array(i),r=e._instanceIds;let o,s,c=0;for(s=0;s<i;s++){o=n[s];const e=o.geometry;let t;t=Object(p["a"])(e.attributes)&&Object(p["a"])(e.primitiveType)?_e(e):e.constructor.createGeometry(e),a[c++]=ge(o,t),r.push(o.id)}a.length=c;const l=t.scene3DOnly,h=t.mapProjection,u=ae.combineGeometry({instances:a,ellipsoid:h.ellipsoid,projection:h,elementIndexUintSupported:t.context.elementIndexUint,scene3DOnly:l,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e._createPickOffsets});e._geometries=u.geometries,e._attributeLocations=u.attributeLocations,e.modelMatrix=v["a"].clone(u.modelMatrix,e.modelMatrix),e._pickOffsets=u.pickOffsets,e._offsetInstanceExtend=u.offsetInstanceExtend,e._instanceBoundingSpheres=u.boundingSpheres,e._instanceBoundingSpheresCV=u.boundingSpheresCV,Object(p["a"])(e._geometries)&&e._geometries.length>0?(e._recomputeBoundingSpheres=!0,e._state=oe.COMBINED):it(e,t,oe.FAILED,void 0)}function Ee(e,t){const n=e._batchTableAttributeIndices.offset;if(!e._recomputeBoundingSpheres||!Object(p["a"])(n))return void(e._recomputeBoundingSpheres=!1);let a;const o=e._offsetInstanceExtend,s=e._instanceBoundingSpheres,c=s.length;let l=e._tempBoundingSpheres;if(!Object(p["a"])(l)){for(l=new Array(c),a=0;a<c;a++)l[a]=new i["a"];e._tempBoundingSpheres=l}for(a=0;a<c;++a){let t=l[a];const i=e._batchTable.getBatchedAttribute(a,n,new r["a"]);t=s[a].clone(t),Je(t,i,o[a])}const h=[],u=[],d=[];for(a=0;a<c;++a){const e=l[a],t=e.center.x-e.radius;t>0||i["a"].intersectPlane(e,C["a"].ORIGIN_ZX_PLANE)!==O["a"].INTERSECTING?h.push(e):(u.push(e),d.push(e))}let m=h[0],b=d[0],f=u[0];for(a=1;a<h.length;a++)m=i["a"].union(m,h[a]);for(a=1;a<d.length;a++)b=i["a"].union(b,d[a]);for(a=1;a<u.length;a++)f=i["a"].union(f,u[a]);const _=[];for(Object(p["a"])(m)&&_.push(m),Object(p["a"])(b)&&_.push(b),Object(p["a"])(f)&&_.push(f),a=0;a<_.length;a++){const n=_[a].clone(e._boundingSpheres[a]);e._boundingSpheres[a]=n,e._boundingSphereCV[a]=i["a"].projectTo2D(n,t.mapProjection,e._boundingSphereCV[a])}le._updateBoundingVolumes(e,t,e.modelMatrix,!0),e._recomputeBoundingSpheres=!1}const Le=new b["a"],Ie=new s["a"],Fe=new r["a"],ke=new i["a"];function Me(e,t){const n=Object(p["a"])(e._batchTableAttributeIndices.distanceDisplayCondition);if(!n||e._batchTableBoundingSpheresUpdated)return;const a=e._batchTableBoundingSphereAttributeIndices,r=a.center3DHigh,o=a.center3DLow,s=a.center2DHigh,c=a.center2DLow,l=a.radius,h=t.mapProjection,u=h.ellipsoid,d=e._batchTable,m=e._instanceBoundingSpheres,f=m.length;for(let _=0;_<f;++_){let n=m[_];if(!Object(p["a"])(n))continue;const a=e.modelMatrix;Object(p["a"])(a)&&(n=i["a"].transform(n,a,ke));const f=n.center,g=n.radius;let y=b["a"].fromCartesian(f,Le);if(d.setBatchedAttribute(_,r,y.high),d.setBatchedAttribute(_,o,y.low),!t.scene3DOnly){const e=u.cartesianToCartographic(f,Ie),t=h.project(e,Fe);y=b["a"].fromCartesian(t,Le),d.setBatchedAttribute(_,s,y.high),d.setBatchedAttribute(_,c,y.low)}d.setBatchedAttribute(_,l,g)}e._batchTableBoundingSpheresUpdated=!0}const ze=new r["a"],Ve=new r["a"];function Be(e,t){const n=Object(p["a"])(e._batchTableAttributeIndices.offset);if(!n||e._batchTableOffsetsUpdated||t.scene3DOnly)return;const a=e._batchTableOffsetAttribute2DIndex,o=t.mapProjection,s=o.ellipsoid,c=e._batchTable,l=e._instanceBoundingSpheres,h=l.length;for(let u=0;u<h;++u){let t=l[u];if(!Object(p["a"])(t))continue;const n=c.getBatchedAttribute(u,e._batchTableAttributeIndices.offset);if(r["a"].equals(n,r["a"].ZERO)){c.setBatchedAttribute(u,a,r["a"].ZERO);continue}const h=e.modelMatrix;Object(p["a"])(h)&&(t=i["a"].transform(t,h,ke));let d=t.center;d=s.scaleToGeodeticSurface(d,Ve);let m=s.cartesianToCartographic(d,Ie);const b=o.project(m,Fe),f=r["a"].add(n,d,ze);m=s.cartesianToCartographic(f,m);const _=o.project(m,ze),g=r["a"].subtract(_,b,ze),y=g.x;g.x=g.z,g.z=g.y,g.y=y,c.setBatchedAttribute(u,a,g)}e._batchTableOffsetsUpdated=!0}function Ne(e,t){const n=e._attributeLocations,a=e._geometries,r=t.scene3DOnly,o=t.context,s=[],c=a.length;for(let l=0;l<c;++l){const c=a[l];if(s.push(I["a"].fromGeometry({context:o,geometry:c,attributeLocations:n,bufferUsage:j["a"].STATIC_DRAW,interleave:e._interleave})),Object(p["a"])(e._createBoundingVolumeFunction))e._createBoundingVolumeFunction(t,c);else if(e._boundingSpheres.push(i["a"].clone(c.boundingSphere)),e._boundingSphereWC.push(new i["a"]),!r){const t=c.boundingSphereCV.center,n=t.x,a=t.y,r=t.z;t.x=r,t.y=n,t.z=a,e._boundingSphereCV.push(i["a"].clone(c.boundingSphereCV)),e._boundingSphere2D.push(new i["a"]),e._boundingSphereMorph.push(new i["a"])}}e._va=s,e._primitiveType=a[0].primitiveType,e.releaseGeometryInstances&&(e.geometryInstances=void 0),e._geometries=void 0,it(e,t,oe.COMPLETE,void 0)}function He(e,t,n,i){let a,r=n.getRenderState();i?(a=Object(c["a"])(r,!1),a.cull={enabled:!0,face:k["a"].BACK},e._frontFaceRS=A["a"].fromCache(a),a.cull.face=k["a"].FRONT,e._backFaceRS=A["a"].fromCache(a)):(e._frontFaceRS=A["a"].fromCache(r),e._backFaceRS=e._frontFaceRS),a=Object(c["a"])(r,!1),Object(p["a"])(e._depthFailAppearance)&&(a.depthTest.enabled=!1),Object(p["a"])(e._depthFailAppearance)&&(r=e._depthFailAppearance.getRenderState(),a=Object(c["a"])(r,!1),a.depthTest.func=M["a"].GREATER,i?(a.cull={enabled:!0,face:k["a"].BACK},e._frontFaceDepthFailRS=A["a"].fromCache(a),a.cull.face=k["a"].FRONT,e._backFaceDepthFailRS=A["a"].fromCache(a)):(e._frontFaceDepthFailRS=A["a"].fromCache(a),e._backFaceDepthFailRS=e._frontFaceRS))}function Ue(e,t,n){const i=t.context,a=e._attributeLocations;let r=e._batchTable.getVertexShaderCallback()(n.vertexShaderSource);r=le._appendOffsetToShader(e,r),r=le._appendShowToShader(e,r),r=le._appendDistanceDisplayConditionToShader(e,r,t.scene3DOnly),r=Te(r),r=le._updateColorAttribute(e,r,!1),r=ve(e,r),r=le._modifyShaderPosition(e,r,t.scene3DOnly);let o=n.getFragmentShaderSource();o=Oe(o),e._sp=E["a"].replaceCache({context:i,shaderProgram:e._sp,vertexShaderSource:r,fragmentShaderSource:o,attributeLocations:a}),xe(e._sp,a),Object(p["a"])(e._depthFailAppearance)&&(r=e._batchTable.getVertexShaderCallback()(e._depthFailAppearance.vertexShaderSource),r=le._appendShowToShader(e,r),r=le._appendDistanceDisplayConditionToShader(e,r,t.scene3DOnly),r=Te(r),r=le._updateColorAttribute(e,r,!0),r=ve(e,r),r=le._modifyShaderPosition(e,r,t.scene3DOnly),r=Ce(r),o=e._depthFailAppearance.getFragmentShaderSource(),o=Oe(o),o=Se(o),e._spDepthFail=E["a"].replaceCache({context:i,shaderProgram:e._spDepthFail,vertexShaderSource:r,fragmentShaderSource:o,attributeLocations:a}),xe(e._spDepthFail,a))}const Ge=new v["a"],$e=new r["a"];function Qe(e,t,n,i){const a=Object(p["a"])(n)?n._uniforms:void 0,r={},o=t.uniforms;if(Object(p["a"])(o))for(const c in o)o.hasOwnProperty(c)&&(r[c]=De(o,c));let s=Object(h["a"])(r,a);return s=e._batchTable.getUniformMapCallback()(s),Object(p["a"])(e.rtcCenter)&&(s.u_modifiedModelView=function(){const t=i.context.uniformState.view;return v["a"].multiply(t,e._modelMatrix,Ge),v["a"].multiplyByPoint(Ge,e.rtcCenter,$e),v["a"].setTranslation(Ge,$e,Ge),Ge}),s}function We(e,t,n,i,a,r,o,s){const c=Qe(e,t,n,s);let l;Object(p["a"])(e._depthFailAppearance)&&(l=Qe(e,e._depthFailAppearance,e._depthFailAppearance.material,s));const h=i?P["a"].TRANSLUCENT:P["a"].OPAQUE;let u=a?2:1;u*=Object(p["a"])(e._depthFailAppearance)?2:1,r.length=e._va.length*u;const d=r.length;let m=0;for(let b=0;b<d;++b){let t;a&&(t=r[b],Object(p["a"])(t)||(t=r[b]=new w["a"]({owner:e,primitiveType:e._primitiveType})),t.vertexArray=e._va[m],t.renderState=e._backFaceRS,t.shaderProgram=e._sp,t.uniformMap=c,t.pass=h,++b),t=r[b],Object(p["a"])(t)||(t=r[b]=new w["a"]({owner:e,primitiveType:e._primitiveType})),t.vertexArray=e._va[m],t.renderState=e._frontFaceRS,t.shaderProgram=e._sp,t.uniformMap=c,t.pass=h,Object(p["a"])(e._depthFailAppearance)&&(a&&(++b,t=r[b],Object(p["a"])(t)||(t=r[b]=new w["a"]({owner:e,primitiveType:e._primitiveType})),t.vertexArray=e._va[m],t.renderState=e._backFaceDepthFailRS,t.shaderProgram=e._spDepthFail,t.uniformMap=l,t.pass=h),++b,t=r[b],Object(p["a"])(t)||(t=r[b]=new w["a"]({owner:e,primitiveType:e._primitiveType})),t.vertexArray=e._va[m],t.renderState=e._frontFaceDepthFailRS,t.shaderProgram=e._spDepthFail,t.uniformMap=l,t.pass=h),++m}}function Ye(e,t,n,i,a,r,o,s){let c;le._updateBoundingVolumes(e,t,a),t.mode===se["a"].SCENE3D?c=e._boundingSphereWC:t.mode===se["a"].COLUMBUS_VIEW?c=e._boundingSphereCV:t.mode===se["a"].SCENE2D&&Object(p["a"])(e._boundingSphere2D)?c=e._boundingSphere2D:Object(p["a"])(e._boundingSphereMorph)&&(c=e._boundingSphereMorph);const l=t.commandList,h=t.passes;if(h.render||h.pick){const t=e.allowPicking,i=ce["a"].castShadows(e.shadows),h=ce["a"].receiveShadows(e.shadows),u=n.length;let d=s?2:1;d*=Object(p["a"])(e._depthFailAppearance)?2:1;for(let e=0;e<u;++e){const s=Math.floor(e/d),u=n[e];u.modelMatrix=a,u.boundingVolume=c[s],u.cull=r,u.debugShowBoundingVolume=o,u.castShadows=i,u.receiveShadows=h,u.pickId=t?"v_pickColor":void 0,l.push(u)}}}le._updateBoundingVolumes=function(e,t,n,a){let r,o,s;if(a||!v["a"].equals(n,e._modelMatrix))for(v["a"].clone(n,e._modelMatrix),o=e._boundingSpheres.length,r=0;r<o;++r)s=e._boundingSpheres[r],Object(p["a"])(s)&&(e._boundingSphereWC[r]=i["a"].transform(s,n,e._boundingSphereWC[r]),t.scene3DOnly||(e._boundingSphere2D[r]=i["a"].clone(e._boundingSphereCV[r],e._boundingSphere2D[r]),e._boundingSphere2D[r].center.x=0,e._boundingSphereMorph[r]=i["a"].union(e._boundingSphereWC[r],e._boundingSphereCV[r])));const c=e.appearance.pixelSize;if(Object(p["a"])(c))for(o=e._boundingSpheres.length,r=0;r<o;++r){s=e._boundingSpheres[r];const n=e._boundingSphereWC[r],i=t.camera.getPixelSize(s,t.context.drawingBufferWidth,t.context.drawingBufferHeight),a=i*c;n.radius=s.radius+a}},le.prototype.update=function(e){if(!Object(p["a"])(this.geometryInstances)&&0===this._va.length||Object(p["a"])(this.geometryInstances)&&Array.isArray(this.geometryInstances)&&0===this.geometryInstances.length||!Object(p["a"])(this.appearance)||e.mode!==se["a"].SCENE3D&&e.scene3DOnly||!e.passes.render&&!e.passes.pick)return;if(Object(p["a"])(this._error))throw this._error;if(this._state===oe.FAILED)return;const t=e.context;if(Object(p["a"])(this._batchTable)||be(this,t),this._batchTable.attributes.length>0){if(0===R["a"].maximumVertexTextureImageUnits)throw new S["a"]("Vertex texture fetch support is required to render primitives with per-instance attributes. The maximum number of vertex texture image units must be greater than zero.");this._batchTable.update(e)}if(this._state!==oe.COMPLETE&&this._state!==oe.COMBINED&&(this.asynchronous?Pe(this,e):Ae(this,e)),this._state===oe.COMBINED&&(Me(this,e),Be(this,e),Ne(this,e)),!this.show||this._state!==oe.COMPLETE)return;this._batchTableOffsetsUpdated||Be(this,e),this._recomputeBoundingSpheres&&Ee(this,e);const n=this.appearance,i=n.material;let a=!1,r=!1;this._appearance!==n?(this._appearance=n,this._material=i,a=!0,r=!0):this._material!==i&&(this._material=i,r=!0);const o=this.depthFailAppearance,s=Object(p["a"])(o)?o.material:void 0;this._depthFailAppearance!==o?(this._depthFailAppearance=o,this._depthFailMaterial=s,a=!0,r=!0):this._depthFailMaterial!==s&&(this._depthFailMaterial=s,r=!0);const c=this._appearance.isTranslucent();this._translucent!==c&&(this._translucent=c,a=!0),Object(p["a"])(this._material)&&this._material.update(t);const l=n.closed&&c;if(a){const e=Object(d["a"])(this._createRenderStatesFunction,He);e(this,t,n,l)}if(r){const t=Object(d["a"])(this._createShaderProgramFunction,Ue);t(this,e,n)}if(a||r){const t=Object(d["a"])(this._createCommandsFunction,We);t(this,n,i,c,l,this._colorCommands,this._pickCommands,e)}const h=Object(d["a"])(this._updateAndQueueCommandsFunction,Ye);h(this,e,this._colorCommands,this._pickCommands,this.modelMatrix,this.cull,this.debugShowBoundingVolume,l)};const Ze=new i["a"],qe=new i["a"];function Je(e,t,n){if(n===T["a"].TOP){const n=i["a"].clone(e,Ze),a=i["a"].clone(e,qe);a.center=r["a"].add(a.center,t,a.center),e=i["a"].union(n,a,e)}else n===T["a"].ALL&&(e.center=r["a"].add(e.center,t,e.center));return e}function Xe(e,t,n){return function(){const i=e.getBatchedAttribute(t,n),a=e.attributes[n],r=a.componentsPerAttribute,o=u["a"].createTypedArray(a.componentDatatype,r);return Object(p["a"])(i.constructor.pack)?i.constructor.pack(i,o,0):o[0]=i,o}}function Ke(e,t,n,i,a){return function(r){const o=me(r);e.setBatchedAttribute(t,n,o),"offset"===a&&(i._recomputeBoundingSpheres=!0,i._batchTableOffsetsUpdated=!1)}}const et=new r["a"];function tt(e,t,n){t.boundingSphere={get:function(){let a=e._instanceBoundingSpheres[n];if(Object(p["a"])(a)){a=a.clone();const o=e.modelMatrix,s=t.offset;Object(p["a"])(s)&&Je(a,r["a"].fromArray(s.get(),0,et),e._offsetInstanceExtend[n]),Object(p["a"])(o)&&(a=i["a"].transform(a,o))}return a}},t.boundingSphereCV={get:function(){return e._instanceBoundingSpheresCV[n]}}}function nt(e,t,n){t.pickId={get:function(){return e._pickIds[n]}}}function it(e,t,n,i){e._completeLoad(t,n,i)}le.prototype.getGeometryInstanceAttributes=function(e){let t=-1;const n=this._lastPerInstanceAttributeIndex,i=this._instanceIds,a=i.length;for(let l=0;l<a;++l){const r=(n+l)%a;if(e===i[r]){t=r;break}}if(-1===t)return;let r=this._perInstanceAttributeCache[t];if(Object(p["a"])(r))return r;const o=this._batchTable,s=this._batchTableAttributeIndices;r={};const c={};for(const l in s)if(s.hasOwnProperty(l)){const e=s[l];c[l]={get:Xe(o,t,e),set:Ke(o,t,e,this,l)}}return tt(this,c,t),nt(this,c,t),Object.defineProperties(r,c),this._lastPerInstanceAttributeIndex=t,this._perInstanceAttributeCache[t]=r,r},le.prototype.isDestroyed=function(){return!1},le.prototype.destroy=function(){let e,t;this._sp=this._sp&&this._sp.destroy(),this._spDepthFail=this._spDepthFail&&this._spDepthFail.destroy();const n=this._va;for(e=n.length,t=0;t<e;++t)n[t].destroy();this._va=void 0;const i=this._pickIds;for(e=i.length,t=0;t<e;++t)i[t].destroy();return this._pickIds=void 0,this._batchTable=this._batchTable&&this._batchTable.destroy(),this._instanceIds=void 0,this._perInstanceAttributeCache=void 0,this._attributeLocations=void 0,Object(m["a"])(this)};t["a"]=le},"9c90":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("535a"),a=n("2f63");function r(e){e=Object(i["a"])(e,i["a"].EMPTY_OBJECT);const t=e.property,n=e.classProperty;this._attribute=t.attribute,this._classProperty=n,this._min=t.min,this._max=t.max;let r=t.offset,o=t.scale;const s=n.hasValueTransform||Object(a["a"])(r)||Object(a["a"])(o);r=Object(i["a"])(r,n.offset),o=Object(i["a"])(o,n.scale),r=n.unpackVectorAndMatrixTypes(r),o=n.unpackVectorAndMatrixTypes(o),this._offset=r,this._scale=o,this._hasValueTransform=s,this._extras=t.extras,this._extensions=t.extensions}function o(e){e=Object(i["a"])(e,i["a"].EMPTY_OBJECT);const t=e.propertyAttribute,n=e.class,o={};if(Object(a["a"])(t.properties))for(const i in t.properties)t.properties.hasOwnProperty(i)&&(o[i]=new r({property:t.properties[i],classProperty:n.properties[i]}));this._name=e.name,this._id=e.id,this._class=n,this._properties=o,this._extras=t.extras,this._extensions=t.extensions}Object.defineProperties(r.prototype,{attribute:{get:function(){return this._attribute}},hasValueTransform:{get:function(){return this._hasValueTransform}},offset:{get:function(){return this._offset}},scale:{get:function(){return this._scale}},classProperty:{get:function(){return this._classProperty}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),Object.defineProperties(o.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},class:{get:function(){return this._class}},properties:{get:function(){return this._properties}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),o.prototype.getProperty=function(e){return this._properties[e]}},a7eb:function(e,t,n){"use strict";var i=n("535a"),a=(n("4f04"),n("2f63"));function r(e){e=Object(i["a"])(e,i["a"].EMPTY_OBJECT),this._name=e.name,this._id=e.id,this._count=e.count,this._extras=e.extras,this._extensions=e.extensions,this._metadataTable=e.metadataTable,this._jsonMetadataTable=e.jsonMetadataTable,this._batchTableHierarchy=e.batchTableHierarchy}Object.defineProperties(r.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},count:{get:function(){return this._count}},class:{get:function(){if(Object(a["a"])(this._metadataTable))return this._metadataTable.class}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}},byteLength:{get:function(){let e=0;return Object(a["a"])(this._metadataTable)&&(e+=this._metadataTable.byteLength),Object(a["a"])(this._batchTableHierarchy)&&(e+=this._batchTableHierarchy.byteLength),e}}}),r.prototype.hasProperty=function(e,t){return!(!Object(a["a"])(this._metadataTable)||!this._metadataTable.hasProperty(t))||(!(!Object(a["a"])(this._jsonMetadataTable)||!this._jsonMetadataTable.hasProperty(t))||!(!Object(a["a"])(this._batchTableHierarchy)||!this._batchTableHierarchy.hasProperty(e,t)))},r.prototype.hasPropertyBySemantic=function(e,t){return!!Object(a["a"])(this._metadataTable)&&this._metadataTable.hasPropertyBySemantic(t)},r.prototype.propertyExists=function(e){return!(!Object(a["a"])(this._metadataTable)||!this._metadataTable.hasProperty(e))||(!(!Object(a["a"])(this._jsonMetadataTable)||!this._jsonMetadataTable.hasProperty(e))||!(!Object(a["a"])(this._batchTableHierarchy)||!this._batchTableHierarchy.propertyExists(e)))},r.prototype.propertyExistsBySemantic=function(e){return!!Object(a["a"])(this._metadataTable)&&this._metadataTable.hasPropertyBySemantic(e)};const o=[];r.prototype.getPropertyIds=function(e,t){return t=Object(a["a"])(t)?t:[],t.length=0,Object(a["a"])(this._metadataTable)&&t.push.apply(t,this._metadataTable.getPropertyIds(o)),Object(a["a"])(this._jsonMetadataTable)&&t.push.apply(t,this._jsonMetadataTable.getPropertyIds(o)),Object(a["a"])(this._batchTableHierarchy)&&t.push.apply(t,this._batchTableHierarchy.getPropertyIds(e,o)),t},r.prototype.getProperty=function(e,t){let n;return Object(a["a"])(this._metadataTable)&&(n=this._metadataTable.getProperty(e,t),Object(a["a"])(n))||Object(a["a"])(this._jsonMetadataTable)&&(n=this._jsonMetadataTable.getProperty(e,t),Object(a["a"])(n))||Object(a["a"])(this._batchTableHierarchy)&&(n=this._batchTableHierarchy.getProperty(e,t),Object(a["a"])(n))?n:void 0},r.prototype.setProperty=function(e,t,n){return!(!Object(a["a"])(this._metadataTable)||!this._metadataTable.setProperty(e,t,n))||(!(!Object(a["a"])(this._jsonMetadataTable)||!this._jsonMetadataTable.setProperty(e,t,n))||Object(a["a"])(this._batchTableHierarchy)&&this._batchTableHierarchy.setProperty(e,t,n))},r.prototype.getPropertyBySemantic=function(e,t){if(Object(a["a"])(this._metadataTable))return this._metadataTable.getPropertyBySemantic(e,t)},r.prototype.setPropertyBySemantic=function(e,t,n){return!!Object(a["a"])(this._metadataTable)&&this._metadataTable.setPropertyBySemantic(e,t,n)},r.prototype.getPropertyTypedArray=function(e){if(Object(a["a"])(this._metadataTable))return this._metadataTable.getPropertyTypedArray(e)},r.prototype.getPropertyTypedArrayBySemantic=function(e){if(Object(a["a"])(this._metadataTable))return this._metadataTable.getPropertyTypedArrayBySemantic(e)},r.prototype.isClass=function(e,t){const n=this._batchTableHierarchy;return!!Object(a["a"])(n)&&n.isClass(e,t)},r.prototype.isExactClass=function(e,t){return this.getExactClassName(e)===t},r.prototype.getExactClassName=function(e){const t=this._batchTableHierarchy;if(Object(a["a"])(t))return t.getClassName(e)},t["a"]=r},c17f:function(e,t,n){"use strict";var i=n("be18"),a=n("bef8"),r=n("535a"),o=n("2f63"),s=n("21d7"),c=n("ddf7"),l=n("93da"),h=n("52f0"),u=n("713f"),d=n("c34a"),p=n("2ac3"),m=n("eace"),b=n("2368"),f=n("82d9");function _(e){this._ellipsoid=new f["a"](e.ellipsoid,i["a"].ZERO)}Object.defineProperties(_.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});var g=_,y=n("f1b3"),T=n("ee78");function O(e){this._tilingScheme=e.tilingScheme,this._x=e.x,this._y=e.y,this._level=e.level,this._parent=e.parent,this._rectangle=this._tilingScheme.tileXYToRectangle(this._x,this._y,this._level),this._southwestChild=void 0,this._southeastChild=void 0,this._northwestChild=void 0,this._northeastChild=void 0,this.replacementPrevious=void 0,this.replacementNext=void 0,this._distance=0,this._loadPriority=0,this._customData=[],this._frameUpdated=void 0,this._lastSelectionResult=T["a"].NONE,this._lastSelectionResultFrame=void 0,this._loadedCallbacks={},this.state=y["a"].START,this.renderable=!1,this.upsampledFromParent=!1,this.data=void 0}function v(e){Object(o["a"])(e)&&e.freeResources()}O.createLevelZeroTiles=function(e){const t=e.getNumberOfXTilesAtLevel(0),n=e.getNumberOfYTilesAtLevel(0),i=new Array(t*n);let a=0;for(let r=0;r<n;++r)for(let n=0;n<t;++n)i[a++]=new O({tilingScheme:e,x:n,y:r,level:0});return i},O.prototype._updateCustomData=function(e,t,n){let i,a,r,s=this.customData;if(Object(o["a"])(t)&&Object(o["a"])(n)){for(s=s.filter((function(e){return-1===n.indexOf(e)})),this._customData=s,r=this._rectangle,i=0;i<t.length;++i)a=t[i],m["a"].contains(r,a.positionCartographic)&&s.push(a);this._frameUpdated=e}else{const e=this._parent;if(Object(o["a"])(e)&&this._frameUpdated!==e._frameUpdated){s.length=0,r=this._rectangle;const t=e.customData;for(i=0;i<t.length;++i)a=t[i],m["a"].contains(r,a.positionCartographic)&&s.push(a);this._frameUpdated=e._frameUpdated}}},Object.defineProperties(O.prototype,{tilingScheme:{get:function(){return this._tilingScheme}},x:{get:function(){return this._x}},y:{get:function(){return this._y}},level:{get:function(){return this._level}},parent:{get:function(){return this._parent}},rectangle:{get:function(){return this._rectangle}},children:{get:function(){return[this.northwestChild,this.northeastChild,this.southwestChild,this.southeastChild]}},southwestChild:{get:function(){return Object(o["a"])(this._southwestChild)||(this._southwestChild=new O({tilingScheme:this.tilingScheme,x:2*this.x,y:2*this.y+1,level:this.level+1,parent:this})),this._southwestChild}},southeastChild:{get:function(){return Object(o["a"])(this._southeastChild)||(this._southeastChild=new O({tilingScheme:this.tilingScheme,x:2*this.x+1,y:2*this.y+1,level:this.level+1,parent:this})),this._southeastChild}},northwestChild:{get:function(){return Object(o["a"])(this._northwestChild)||(this._northwestChild=new O({tilingScheme:this.tilingScheme,x:2*this.x,y:2*this.y,level:this.level+1,parent:this})),this._northwestChild}},northeastChild:{get:function(){return Object(o["a"])(this._northeastChild)||(this._northeastChild=new O({tilingScheme:this.tilingScheme,x:2*this.x+1,y:2*this.y,level:this.level+1,parent:this})),this._northeastChild}},customData:{get:function(){return this._customData}},needsLoading:{get:function(){return this.state<y["a"].DONE}},eligibleForUnloading:{get:function(){let e=!0;return Object(o["a"])(this.data)&&(e=this.data.eligibleForUnloading,Object(o["a"])(e)||(e=!0)),e}}}),O.prototype.findLevelZeroTile=function(e,t,n){const i=this.tilingScheme.getNumberOfXTilesAtLevel(0);if(t<0?t+=i:t>=i&&(t-=i),!(n<0||n>=this.tilingScheme.getNumberOfYTilesAtLevel(0)))return e.filter((function(e){return e.x===t&&e.y===n}))[0]},O.prototype.findTileToWest=function(e){const t=this.parent;if(void 0===t)return this.findLevelZeroTile(e,this.x-1,this.y);if(t.southeastChild===this)return t.southwestChild;if(t.northeastChild===this)return t.northwestChild;const n=t.findTileToWest(e);return void 0!==n?t.southwestChild===this?n.southeastChild:n.northeastChild:void 0},O.prototype.findTileToEast=function(e){const t=this.parent;if(void 0===t)return this.findLevelZeroTile(e,this.x+1,this.y);if(t.southwestChild===this)return t.southeastChild;if(t.northwestChild===this)return t.northeastChild;const n=t.findTileToEast(e);return void 0!==n?t.southeastChild===this?n.southwestChild:n.northwestChild:void 0},O.prototype.findTileToSouth=function(e){const t=this.parent;if(void 0===t)return this.findLevelZeroTile(e,this.x,this.y+1);if(t.northwestChild===this)return t.southwestChild;if(t.northeastChild===this)return t.southeastChild;const n=t.findTileToSouth(e);return void 0!==n?t.southwestChild===this?n.northwestChild:n.northeastChild:void 0},O.prototype.findTileToNorth=function(e){const t=this.parent;if(void 0===t)return this.findLevelZeroTile(e,this.x,this.y-1);if(t.southwestChild===this)return t.northwestChild;if(t.southeastChild===this)return t.northeastChild;const n=t.findTileToNorth(e);return void 0!==n?t.northwestChild===this?n.southwestChild:n.southeastChild:void 0},O.prototype.freeResources=function(){this.state=y["a"].START,this.renderable=!1,this.upsampledFromParent=!1,Object(o["a"])(this.data)&&Object(o["a"])(this.data.freeResources)&&this.data.freeResources(),v(this._southwestChild),this._southwestChild=void 0,v(this._southeastChild),this._southeastChild=void 0,v(this._northwestChild),this._northwestChild=void 0,v(this._northeastChild),this._northeastChild=void 0};var C=O,S=n("a307"),x=n("3a92");function D(e){this._tileProvider=e.tileProvider,this._tileProvider.quadtree=this,this._debug={enableDebugOutput:!1,maxDepth:0,maxDepthVisited:0,tilesVisited:0,tilesCulled:0,tilesRendered:0,tilesWaitingForChildren:0,lastMaxDepth:-1,lastMaxDepthVisited:-1,lastTilesVisited:-1,lastTilesCulled:-1,lastTilesRendered:-1,lastTilesWaitingForChildren:-1,suspendLodUpdate:!1};const t=this._tileProvider.tilingScheme,n=t.ellipsoid;this._tilesToRender=[],this._tileLoadQueueHigh=[],this._tileLoadQueueMedium=[],this._tileLoadQueueLow=[],this._tileReplacementQueue=new x["a"],this._levelZeroTiles=void 0,this._loadQueueTimeSlice=5,this._tilesInvalidated=!1,this._addHeightCallbacks=[],this._removeHeightCallbacks=[],this._tileToUpdateHeights=[],this._lastTileIndex=0,this._updateHeightsTimeSlice=2,this._cameraPositionCartographic=void 0,this._cameraReferenceFrameOriginCartographic=void 0,this.maximumScreenSpaceError=Object(r["a"])(e.maximumScreenSpaceError,2),this.tileCacheSize=Object(r["a"])(e.tileCacheSize,100),this.loadingDescendantLimit=20,this.preloadAncestors=!0,this.preloadSiblings=!1,this._occluders=new g({ellipsoid:n}),this._tileLoadProgressEvent=new s["a"],this._lastTileLoadQueueLength=0,this._lastSelectionFrameNumber=void 0}function j(e){const t=e._tileReplacementQueue;t.head=void 0,t.tail=void 0,t.count=0,R(e);const n=e._levelZeroTiles;if(Object(o["a"])(n))for(let i=0;i<n.length;++i){const t=n[i],a=t.customData,r=a.length;for(let n=0;n<r;++n){const t=a[n];t.level=0,e._addHeightCallbacks.push(t)}n[i].freeResources()}e._levelZeroTiles=void 0,e._tileProvider.cancelReprojections()}function R(e){const t=e._debug;t.maxDepth=0,t.maxDepthVisited=0,t.tilesVisited=0,t.tilesCulled=0,t.tilesRendered=0,t.tilesWaitingForChildren=0,e._tileLoadQueueHigh.length=0,e._tileLoadQueueMedium.length=0,e._tileLoadQueueLow.length=0}function w(e,t){const n=e._tileLoadQueueHigh.length+e._tileLoadQueueMedium.length+e._tileLoadQueueLow.length;(n!==e._lastTileLoadQueueLength||e._tilesInvalidated)&&(t.afterRender.push(s["a"].prototype.raiseEvent.bind(e._tileLoadProgressEvent,n)),e._lastTileLoadQueueLength=n);const i=e._debug;i.enableDebugOutput&&!i.suspendLodUpdate&&(i.maxDepth=e._tilesToRender.reduce((function(e,t){return Math.max(e,t.level)}),-1),i.tilesRendered=e._tilesToRender.length,i.tilesVisited===i.lastTilesVisited&&i.tilesRendered===i.lastTilesRendered&&i.tilesCulled===i.lastTilesCulled&&i.maxDepth===i.lastMaxDepth&&i.tilesWaitingForChildren===i.lastTilesWaitingForChildren&&i.maxDepthVisited===i.lastMaxDepthVisited||(console.log(`Visited ${i.tilesVisited}, Rendered: ${i.tilesRendered}, Culled: ${i.tilesCulled}, Max Depth Rendered: ${i.maxDepth}, Max Depth Visited: ${i.maxDepthVisited}, Waiting for children: ${i.tilesWaitingForChildren}`),i.lastTilesVisited=i.tilesVisited,i.lastTilesRendered=i.tilesRendered,i.lastTilesCulled=i.tilesCulled,i.lastMaxDepth=i.maxDepth,i.lastTilesWaitingForChildren=i.tilesWaitingForChildren,i.lastMaxDepthVisited=i.maxDepthVisited))}let P;Object.defineProperties(D.prototype,{tileProvider:{get:function(){return this._tileProvider}},tileLoadProgressEvent:{get:function(){return this._tileLoadProgressEvent}},occluders:{get:function(){return this._occluders}}}),D.prototype.invalidateAllTiles=function(){this._tilesInvalidated=!0},D.prototype.forEachLoadedTile=function(e){let t=this._tileReplacementQueue.head;while(Object(o["a"])(t))t.state!==y["a"].START&&e(t),t=t.replacementNext},D.prototype.forEachRenderedTile=function(e){const t=this._tilesToRender;for(let n=0,i=t.length;n<i;++n)e(t[n])},D.prototype.updateHeight=function(e,t){const n=this,i={positionOnEllipsoidSurface:void 0,positionCartographic:e,level:-1,callback:t,removeFunc:function(){const e=n._addHeightCallbacks,t=e.length;for(let n=0;n<t;++n)if(e[n]===i){e.splice(n,1);break}n._removeHeightCallbacks.push(i),i.callback&&(i.callback=void 0)}};return n._addHeightCallbacks.push(i),i.removeFunc},D.prototype.update=function(e){Object(o["a"])(this._tileProvider.update)&&this._tileProvider.update(e)},D.prototype.beginFrame=function(e){const t=e.passes;t.render&&(this._tilesInvalidated&&(j(this),this._tilesInvalidated=!1),this._tileProvider.initialize(e),R(this),this._debug.suspendLodUpdate||this._tileReplacementQueue.markStartOfRenderFrame())},D.prototype.render=function(e){const t=e.passes,n=this._tileProvider;t.render&&(n.beginUpdate(e),F(this,e),te(this,e),n.endUpdate(e)),t.pick&&this._tilesToRender.length>0&&n.updateForPick(e)},D.prototype.endFrame=function(e){const t=e.passes;t.render&&e.mode!==S["a"].MORPHING&&(W(this,e),ee(this,e),w(this,e))},D.prototype.isDestroyed=function(){return!1},D.prototype.destroy=function(){this._tileProvider=this._tileProvider&&this._tileProvider.destroy()};const A=new a["a"];function E(e,t){let n=m["a"].center(e.rectangle,A);const i=n.longitude-P.longitude,a=n.latitude-P.latitude;n=m["a"].center(t.rectangle,A);const r=n.longitude-P.longitude,o=n.latitude-P.latitude;return i*i+a*a-(r*r+o*o)}const L=new i["a"];let I=[];function F(e,t){const n=e._debug;if(n.suspendLodUpdate)return;const i=e._tilesToRender;let a;i.length=0;const r=e._tileProvider;if(!Object(o["a"])(e._levelZeroTiles)){if(!r.ready)return;{const t=r.tilingScheme;e._levelZeroTiles=C.createLevelZeroTiles(t);const n=e._levelZeroTiles.length;if(I.length<n)for(I=new Array(n),a=0;a<n;++a)void 0===I[a]&&(I[a]=new M)}}let s;e._occluders.ellipsoid.cameraPosition=t.camera.positionWC;const c=e._levelZeroTiles,l=c.length>1?e._occluders:void 0;P=t.camera.positionCartographic,c.sort(E);const u=e._addHeightCallbacks,d=e._removeHeightCallbacks,p=t.frameNumber;let m;if(u.length>0||d.length>0){for(a=0,m=c.length;a<m;++a)s=c[a],s._updateCustomData(p,u,d);u.length=0,d.length=0}const b=t.camera;e._cameraPositionCartographic=b.positionCartographic;const f=h["a"].getTranslation(b.transform,L);for(e._cameraReferenceFrameOriginCartographic=e.tileProvider.tilingScheme.ellipsoid.cartesianToCartographic(f,e._cameraReferenceFrameOriginCartographic),a=0,m=c.length;a<m;++a)s=c[a],e._tileReplacementQueue.markTileRendered(s),s.renderable?U(e,s,r,t,l,!1,I[a]):(k(e,e._tileLoadQueueHigh,s,t),++n.tilesWaitingForChildren);e._lastSelectionFrameNumber=p}function k(e,t,n,i){n.needsLoading&&(void 0!==e.tileProvider.computeTileLoadPriority&&(n._loadPriority=e.tileProvider.computeTileLoadPriority(n,i)),t.push(n))}function M(){this.allAreRenderable=!0,this.anyWereRenderedLastFrame=!1,this.notYetRenderableCount=0}function z(){this.southwest=new M,this.southeast=new M,this.northwest=new M,this.northeast=new M}z.prototype.combine=function(e){const t=this.southwest,n=this.southeast,i=this.northwest,a=this.northeast;e.allAreRenderable=t.allAreRenderable&&n.allAreRenderable&&i.allAreRenderable&&a.allAreRenderable,e.anyWereRenderedLastFrame=t.anyWereRenderedLastFrame||n.anyWereRenderedLastFrame||i.anyWereRenderedLastFrame||a.anyWereRenderedLastFrame,e.notYetRenderableCount=t.notYetRenderableCount+n.notYetRenderableCount+i.notYetRenderableCount+a.notYetRenderableCount};const V=new Array(31);for(let ne=0;ne<V.length;++ne)V[ne]=new z;function B(e,t,n,i,a){const r=e._debug;++r.tilesVisited,e._tileReplacementQueue.markTileRendered(n),n._updateCustomData(t.frameNumber),n.level>r.maxDepthVisited&&(r.maxDepthVisited=n.level);const s=G(e,t,n)<e.maximumScreenSpaceError,c=n.southwestChild,l=n.southeastChild,h=n.northwestChild,u=n.northeastChild,d=e._lastSelectionFrameNumber,p=n._lastSelectionResultFrame===d?n._lastSelectionResult:T["a"].NONE,m=e.tileProvider;if(s||i){const r=T["a"].originalResult(p)===T["a"].RENDERED,c=T["a"].originalResult(p)===T["a"].CULLED||p===T["a"].NONE,l=n.state===y["a"].DONE;let h=r||c||l;if(h||Object(o["a"])(m.canRenderWithoutLosingDetail)&&(h=m.canRenderWithoutLosingDetail(n)),h)return s&&k(e,e._tileLoadQueueMedium,n,t),Q(e,n),a.allAreRenderable=n.renderable,a.anyWereRenderedLastFrame=p===T["a"].RENDERED,a.notYetRenderableCount=n.renderable?0:1,n._lastSelectionResultFrame=t.frameNumber,n._lastSelectionResult=T["a"].RENDERED,void(a.anyWereRenderedLastFrame||e._tileToUpdateHeights.push(n));i=!0,s&&k(e,e._tileLoadQueueHigh,n,t)}if(m.canRefine(n)){const o=c.upsampledFromParent&&l.upsampledFromParent&&h.upsampledFromParent&&u.upsampledFromParent;if(o)return Q(e,n),k(e,e._tileLoadQueueMedium,n,t),e._tileReplacementQueue.markTileRendered(c),e._tileReplacementQueue.markTileRendered(l),e._tileReplacementQueue.markTileRendered(h),e._tileReplacementQueue.markTileRendered(u),a.allAreRenderable=n.renderable,a.anyWereRenderedLastFrame=p===T["a"].RENDERED,a.notYetRenderableCount=n.renderable?0:1,n._lastSelectionResultFrame=t.frameNumber,n._lastSelectionResult=T["a"].RENDERED,void(a.anyWereRenderedLastFrame||e._tileToUpdateHeights.push(n));n._lastSelectionResultFrame=t.frameNumber,n._lastSelectionResult=T["a"].REFINED;const s=e._tilesToRender.length,d=e._tileLoadQueueLow.length,m=e._tileLoadQueueMedium.length,b=e._tileLoadQueueHigh.length,f=e._tileToUpdateHeights.length;if(N(e,c,l,h,u,t,i,a),s!==e._tilesToRender.length){const i=a.allAreRenderable,o=a.anyWereRenderedLastFrame,c=a.notYetRenderableCount;let l=!1;if(!i&&!o){const i=e._tilesToRender;for(let e=s;e<i.length;++e){let t=i[e];while(void 0!==t&&t._lastSelectionResult!==T["a"].KICKED&&t!==n)t._lastSelectionResult=T["a"].kick(t._lastSelectionResult),t=t.parent}e._tilesToRender.length=s,e._tileToUpdateHeights.length=f,Q(e,n),n._lastSelectionResult=T["a"].RENDERED;const o=p===T["a"].RENDERED;!o&&c>e.loadingDescendantLimit&&(e._tileLoadQueueLow.length=d,e._tileLoadQueueMedium.length=m,e._tileLoadQueueHigh.length=b,k(e,e._tileLoadQueueMedium,n,t),a.notYetRenderableCount=n.renderable?0:1,l=!0),a.allAreRenderable=n.renderable,a.anyWereRenderedLastFrame=o,o||e._tileToUpdateHeights.push(n),++r.tilesWaitingForChildren}e.preloadAncestors&&!l&&k(e,e._tileLoadQueueLow,n,t)}}else n._lastSelectionResultFrame=t.frameNumber,n._lastSelectionResult=T["a"].RENDERED,Q(e,n),k(e,e._tileLoadQueueHigh,n,t),a.allAreRenderable=n.renderable,a.anyWereRenderedLastFrame=p===T["a"].RENDERED,a.notYetRenderableCount=n.renderable?0:1}function N(e,t,n,i,a,r,o,s){const c=r.camera.positionCartographic,l=e._tileProvider,h=e._occluders,u=V[t.level],d=u.southwest,p=u.southeast,m=u.northwest,b=u.northeast;c.longitude<t.rectangle.east?c.latitude<t.rectangle.north?(U(e,t,l,r,h,o,d),U(e,n,l,r,h,o,p),U(e,i,l,r,h,o,m),U(e,a,l,r,h,o,b)):(U(e,i,l,r,h,o,m),U(e,t,l,r,h,o,d),U(e,a,l,r,h,o,b),U(e,n,l,r,h,o,p)):c.latitude<t.rectangle.north?(U(e,n,l,r,h,o,p),U(e,t,l,r,h,o,d),U(e,a,l,r,h,o,b),U(e,i,l,r,h,o,m)):(U(e,a,l,r,h,o,b),U(e,i,l,r,h,o,m),U(e,n,l,r,h,o,p),U(e,t,l,r,h,o,d)),u.combine(s)}function H(e,t){const n=t.rectangle;return Object(o["a"])(e._cameraPositionCartographic)&&m["a"].contains(n,e._cameraPositionCartographic)||Object(o["a"])(e._cameraReferenceFrameOriginCartographic)&&m["a"].contains(n,e._cameraReferenceFrameOriginCartographic)}function U(e,t,n,i,a,r,s){if(n.computeTileVisibility(t,i,a)!==b["a"].NONE)return B(e,i,t,r,s);if(++e._debug.tilesCulled,e._tileReplacementQueue.markTileRendered(t),s.allAreRenderable=!0,s.anyWereRenderedLastFrame=!1,s.notYetRenderableCount=0,H(e,t)){Object(o["a"])(t.data)&&Object(o["a"])(t.data.vertexArray)||k(e,e._tileLoadQueueMedium,t,i);const n=e._lastSelectionFrameNumber,a=t._lastSelectionResultFrame===n?t._lastSelectionResult:T["a"].NONE;a!==T["a"].CULLED_BUT_NEEDED&&a!==T["a"].RENDERED&&e._tileToUpdateHeights.push(t),t._lastSelectionResult=T["a"].CULLED_BUT_NEEDED}else e.preloadSiblings||0===t.level?(k(e,e._tileLoadQueueLow,t,i),t._lastSelectionResult=T["a"].CULLED):t._lastSelectionResult=T["a"].CULLED;t._lastSelectionResultFrame=i.frameNumber}function G(e,t,n){if(t.mode===S["a"].SCENE2D||t.camera.frustum instanceof u["a"]||t.camera.frustum instanceof d["a"])return $(e,t,n);const i=e._tileProvider.getLevelMaximumGeometricError(n.level),a=n._distance,r=t.context.drawingBufferHeight,o=t.camera.frustum.sseDenominator;let s=i*r/(a*o);return t.fog.enabled&&(s-=l["a"].fog(a,t.fog.density)*t.fog.sse),s/=t.pixelRatio,s}function $(e,t,n){const i=t.camera;let a=i.frustum;Object(o["a"])(a._offCenterFrustum)&&(a=a._offCenterFrustum);const r=t.context,s=r.drawingBufferWidth,c=r.drawingBufferHeight,h=e._tileProvider.getLevelMaximumGeometricError(n.level),u=Math.max(a.top-a.bottom,a.right-a.left)/Math.max(s,c);let d=h/u;return t.fog.enabled&&t.mode!==S["a"].SCENE2D&&(d-=l["a"].fog(n._distance,t.fog.density)*t.fog.sse),d/=t.pixelRatio,d}function Q(e,t){e._tilesToRender.push(t)}function W(e,t){const n=e._tileLoadQueueHigh,i=e._tileLoadQueueMedium,a=e._tileLoadQueueLow;if(0===n.length&&0===i.length&&0===a.length)return;e._tileReplacementQueue.trimTiles(e.tileCacheSize);const r=Object(c["a"])()+e._loadQueueTimeSlice,o=e._tileProvider;let s=Z(e,t,o,r,n,!1);s=Z(e,t,o,r,i,s),Z(e,t,o,r,a,s)}function Y(e,t){return e._loadPriority-t._loadPriority}function Z(e,t,n,i,a,r){void 0!==n.computeTileLoadPriority&&a.sort(Y);for(let o=0,s=a.length;o<s&&(Object(c["a"])()<i||!r);++o){const i=a[o];e._tileReplacementQueue.markTileRendered(i),n.loadTile(t,i),r=!0}return r}const q=new p["a"],J=new a["a"],X=new i["a"],K=[];function ee(e,t){if(!e.tileProvider.ready)return;const n=K;n.length=0;const r=e._tileToUpdateHeights,s=Object(c["a"])(),l=e._updateHeightsTimeSlice,h=s+l,u=t.mode,d=t.mapProjection,p=e.tileProvider.tilingScheme.ellipsoid;let m;while(r.length>0){const t=r[0];if(!Object(o["a"])(t.data)||!Object(o["a"])(t.data.mesh)){const i=t._lastSelectionResultFrame===e._lastSelectionFrameNumber?t._lastSelectionResult:T["a"].NONE;i!==T["a"].RENDERED&&i!==T["a"].CULLED_BUT_NEEDED||n.push(t),r.shift(),e._lastTileIndex=0;continue}const s=t.customData,l=s.length;let b=!1;for(m=e._lastTileIndex;m<l;++m){const e=s[m],n=t.data.terrainData,r=Object(o["a"])(n)&&n.wasCreatedByUpsampling();if(t.level>e.level&&!r){if(Object(o["a"])(e.positionOnEllipsoidSurface)||(e.positionOnEllipsoidSurface=i["a"].fromRadians(e.positionCartographic.longitude,e.positionCartographic.latitude,0,p)),u===S["a"].SCENE3D){const n=p.geodeticSurfaceNormal(e.positionOnEllipsoidSurface,q.direction),a=p.getSurfaceNormalIntersectionWithZAxis(e.positionOnEllipsoidSurface,11500,q.origin);if(!Object(o["a"])(a)){let a=0;Object(o["a"])(t.data.tileBoundingRegion)&&(a=t.data.tileBoundingRegion.minimumHeight);const r=Math.min(a,-11500),s=i["a"].multiplyByScalar(n,Math.abs(r)+1,X);i["a"].subtract(e.positionOnEllipsoidSurface,s,q.origin)}}else a["a"].clone(e.positionCartographic,J),J.height=-11500,d.project(J,X),i["a"].fromElements(X.z,X.x,X.y,X),i["a"].clone(X,q.origin),i["a"].clone(i["a"].UNIT_X,q.direction);const n=t.data.pick(q,u,d,!1,X);Object(o["a"])(n)&&(Object(o["a"])(e.callback)&&e.callback(n),e.level=t.level)}if(Object(c["a"])()>=h){b=!0;break}}if(b){e._lastTileIndex=m;break}e._lastTileIndex=0,r.shift()}for(m=0;m<n.length;m++)r.push(n[m])}function te(e,t){const n=e._tileProvider,i=e._tilesToRender;for(let a=0,r=i.length;a<r;++a){const e=i[a];n.showTileThisFrame(e,t)}}t["a"]=D},cd8b:function(e,t,n){"use strict";var i=n("abab"),a=n("2f63"),r=n("0123"),o=n("f20a"),s=n("8b68"),c=n("1da3"),l=n("8bde"),h=n("9e17");function u(e){this.attribute=e,this.loadBuffer=!1,this.loadTypedArray=!1}function d(e){this.indices=e,this.loadBuffer=!1,this.loadTypedArray=!1}function p(e){this.primitive=e,this.attributePlans=[],this.indicesPlan=void 0,this.needsOutlines=!1,this.outlineIndices=void 0}function m(e){const t=e.primitive,n=t.indices,i=t.attributes[0].count,a=new h["a"]({triangleIndices:n.typedArray,outlineIndices:e.outlineIndices,originalVertexCount:i});n.typedArray=a.updatedTriangleIndices,n.indexDatatype=r["a"].fromTypedArray(n.typedArray);const o=b(a.outlineCoordinates),s=new u(o);s.loadBuffer=!0,s.loadTypedArray=!1,e.attributePlans.push(s),t.outlineCoordinates=s.attribute;const c=e.attributePlans,l=e.attributePlans.length;for(let r=0;r<l;r++){const e=c[r].attribute;e.typedArray=a.updateAttribute(e.typedArray)}}function b(e){const t=new l["a"].Attribute;return t.name="_OUTLINE_COORDINATES",t.typedArray=e,t.componentDatatype=i["a"].FLOAT,t.type=c["a"].VEC3,t.normalized=!1,t.count=e.length/3,t}function f(e,t){_(e.attributePlans,t),Object(a["a"])(e.indicesPlan)&&g(e.indicesPlan,t)}function _(e,t){const n=e.length;for(let i=0;i<n;i++){const n=e[i],a=n.attribute,r=a.typedArray;if(n.loadBuffer){const e=o["a"].createVertexBuffer({typedArray:r,context:t,usage:s["a"].STATIC_DRAW});e.vertexArrayDestroyable=!1,a.buffer=e}n.loadTypedArray||(a.typedArray=void 0)}}function g(e,t){const n=e.indices;if(e.loadBuffer){const e=o["a"].createIndexBuffer({typedArray:n.typedArray,context:t,usage:s["a"].STATIC_DRAW,indexDatatype:n.indexDatatype});n.buffer=e,e.vertexArrayDestroyable=!1}e.loadTypedArray||(n.typedArray=void 0)}p.prototype.postProcess=function(e){this.needsOutlines&&(m(this),f(this,e))},p.AttributeLoadPlan=u,p.IndicesLoadPlan=d,t["a"]=p},f1b3:function(e,t,n){"use strict";const i={START:0,LOADING:1,DONE:2,FAILED:3};t["a"]=Object.freeze(i)}}]);